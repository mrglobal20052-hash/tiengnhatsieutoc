<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AzaKanji Tango - Ngày 6: Đời sống & Giải trí</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Nunito', 'Inter', sans-serif; background-color: #f3f4f6; height: 100dvh; overflow: hidden; }
        .ja-text { font-family: 'Noto Sans JP', sans-serif; }
        .scroller { -webkit-overflow-scrolling: touch; overflow-y: auto; }
        .scroller::-webkit-scrollbar { width: 5px; height: 5px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
        
        .vocab-item { transition: all 0.2s; }
        .vocab-item.active { background-color: #eef2ff; border-left: 4px solid #4f46e5; color: #4338ca; padding-left: 0.75rem; }
        
        .shadow-card { transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s; }
        .shadow-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.3); }
        
        .tab-btn.active { background-color: white; color: #312e81; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
        .tab-btn { color: #a5b4fc; }
        
        /* Animation Classes */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .wrong-anim { animation: shake 0.3s ease-in-out; }
        
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .correct-anim { animation: pop 0.3s ease-in-out; }

        /* Stroke Order Styles */
        .stroke-grid-box { border: 1px solid #e5e7eb; background-color: white; position: relative; }
        .stroke-grid-box::after { content: ''; position: absolute; top: 0; left: 50%; width: 1px; height: 100%; background: repeating-linear-gradient(to bottom, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); pointer-events: none; }
        .stroke-grid-box::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px; background: repeating-linear-gradient(to right, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); pointer-events: none; }
        
        /* Hide stroke paths initially */
        #strokeAnimContainer svg path { opacity: 0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="flex flex-col text-slate-800">

    <!-- HEADER -->
    <header class="bg-indigo-700 text-white shadow-lg flex-none z-40 relative">
        <div class="container mx-auto px-4 py-2 md:py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-3">
                <div class="flex items-center gap-3 cursor-pointer select-none w-full md:w-auto justify-between" onclick="location.reload()">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-torii-gate text-3xl text-white"></i>
                        <div>
                            <h1 class="text-lg md:text-xl font-bold uppercase tracking-wider">AzaKanji Tango</h1>
                            <p class="text-[10px] md:text-xs text-indigo-200">Ngày 6: Đời sống & Giải trí</p>
                        </div>
                    </div>
                    <div class="md:hidden text-xs font-semibold bg-indigo-800 px-3 py-1 rounded-full border border-indigo-500/50"><span id="headerProgress">1/87</span></div>
                </div>
                <div class="flex items-center gap-3 w-full md:w-auto">
                    <div class="flex bg-indigo-900/50 rounded-lg p-1 w-full md:w-auto overflow-x-auto no-scrollbar">
                        <button onclick="switchTab('learn')" id="tab-learn" class="tab-btn active flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-book-open"></i> Học Từ</button>
                        <button onclick="switchTab('quiz')" id="tab-quiz" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-keyboard"></i> Kiểm Tra</button>
                        <div class="w-px bg-indigo-600 mx-1"></div>
                        <button onclick="openGrammarList()" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-scroll"></i> Cẩm Nang</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden relative w-full">
        <!-- DESKTOP SIDEBAR -->
        <aside class="hidden md:flex w-72 bg-white border-r border-gray-200 flex-col z-10">
            <div class="p-4 border-b border-gray-100 bg-gray-50">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
                    <input type="text" id="searchInput" placeholder="Tìm kiếm từ..." class="w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 transition-all shadow-sm outline-none">
                </div>
            </div>
            <div id="vocabList" class="flex-1 scroller p-2 space-y-1"></div>
        </aside>

        <!-- MAIN CONTENT (LEARN MODE) -->
        <main id="learn-section" class="flex-1 overflow-y-auto scroller bg-slate-50 p-4 pb-28 w-full scroll-smooth">
            <div class="max-w-3xl mx-auto flex flex-col items-center animate-fade-in">
                <!-- Flashcard -->
                <div class="w-full bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-indigo-50 to-pink-50 rounded-bl-full -mr-8 -mt-8 z-0 opacity-60 transition-transform group-hover:scale-110 duration-700"></div>
                    <div class="relative z-10 text-center">
                        <div class="inline-flex items-center gap-2 bg-gray-50 px-3 py-1 rounded-full mb-4 border border-gray-100">
                            <span id="wordType" class="text-[10px] font-bold uppercase text-indigo-500">WORD</span>
                            <div class="w-px h-3 bg-gray-300"></div>
                            <span class="text-[10px] text-gray-400 font-mono" id="wordIndex">#1</span>
                        </div>
                        <div class="relative inline-block mb-2">
                            <h2 id="cardKanji" class="text-5xl md:text-6xl font-bold text-gray-800 ja-text tracking-tight cursor-pointer hover:text-indigo-700 transition-colors" onclick="speakCurrent()">見せます</h2>
                            <button id="strokeBtn" onclick="openStrokeModal()" class="absolute -right-10 top-2 w-8 h-8 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center shadow-sm hover:bg-pink-200 hover:scale-110 transition-all hidden" title="Tập viết">
                                <i class="fas fa-pen-nib text-sm"></i>
                            </button>
                        </div>
                        <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="speakCurrent()">
                            <span id="cardFurigana" class="text-xl text-indigo-600 font-medium ja-text">みせます</span>
                            <span id="cardMeaning" class="text-lg text-gray-500 font-medium">Cho xem</span>
                        </div>
                    </div>
                </div>

                <!-- Shadowing Sentences -->
                <div class="w-full">
                    <div class="flex items-center gap-2 mb-4 px-1">
                        <div class="bg-pink-100 text-pink-600 p-1.5 rounded-lg text-sm"><i class="fas fa-comments"></i></div>
                        <h3 class="font-bold text-gray-700 text-lg">Hội thoại đời sống</h3>
                    </div>
                    <div id="sentenceList" class="space-y-4"></div>
                    
                    <!-- Empty State -->
                    <div id="emptyState" class="hidden flex-col items-center justify-center p-8 text-center bg-white rounded-2xl border border-dashed border-gray-300 text-gray-400">
                        <i class="fas fa-comment-dots text-4xl mb-2 text-gray-300"></i>
                        <p class="text-sm">Chưa có hội thoại mẫu cho từ này.</p>
                        <p class="text-xs text-gray-300 mt-1">(Dữ liệu đang cập nhật)</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- QUIZ MODE -->
        <div id="quiz-section" class="hidden flex-1 w-full overflow-y-auto scroller bg-slate-100 p-4 absolute inset-0 z-20">
            <div class="max-w-2xl mx-auto mt-4 md:mt-10 animate-fade-in">
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white flex justify-between items-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
                        <div class="relative z-10">
                            <h2 class="text-2xl font-bold flex items-center gap-2"><i class="fas fa-graduation-cap"></i> Thử Thách</h2>
                            <p class="text-indigo-100 text-sm">Nhìn Kanji - Đoán Hiragana</p>
                        </div>
                        <div class="text-right relative z-10 bg-white/10 p-2 rounded-lg backdrop-blur-sm">
                            <div class="text-[10px] text-indigo-100 uppercase font-bold tracking-wider">Điểm số</div>
                            <div class="text-3xl font-bold font-mono" id="score-display">0</div>
                        </div>
                    </div>
                    
                    <div class="p-6 md:p-10 text-center">
                        <div class="mb-8 relative">
                            <div class="text-xs text-gray-400 mb-2 uppercase font-bold tracking-widest">Từ này đọc là gì?</div>
                            <div id="quiz-kanji" class="text-6xl ja-text font-bold text-gray-800 mb-4 transition-all inline-block"></div>
                            <div id="quiz-meaning" class="text-lg text-indigo-600 font-bold mb-2"></div>
                        </div>
                        
                        <div class="relative max-w-md mx-auto mb-8">
                            <input type="text" id="quiz-input" class="w-full text-center text-2xl p-4 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all ja-text placeholder:text-gray-300" placeholder="nhập hiragana..." autocomplete="off">
                        </div>
                        
                        <div id="feedback-area" class="hidden rounded-xl p-5 bg-gray-50 border border-gray-200 text-left mb-6 animate-fade-in shadow-inner">
                            <div id="feedback-title" class="font-bold text-lg mb-2 flex items-center"></div>
                            <div class="text-gray-700 mb-3 flex items-center flex-wrap gap-2">
                                Đáp án đúng: <span id="correct-answer" class="font-bold text-xl text-indigo-600 px-3 py-1 bg-white border border-indigo-100 rounded-lg ja-text shadow-sm"></span>
                                <button onclick="playQuizAudio()" class="text-gray-400 hover:text-indigo-600 transition-colors w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-200 border border-transparent hover:border-gray-300"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </div>
                        
                        <div>
                            <button id="btn-check" onclick="checkAnswer()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto">
                                <i class="fas fa-check"></i> Kiểm Tra
                            </button>
                            <button id="btn-next" onclick="nextQuestion()" class="hidden w-full md:w-auto bg-gray-800 hover:bg-gray-900 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto">
                                Câu Tiếp Theo <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MOBILE BOTTOM BAR -->
        <div class="fixed bottom-0 left-0 right-0 glass px-4 py-3 pb-6 z-30 flex items-center justify-between gap-4 md:hidden shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] border-t border-gray-200">
            <button onclick="prevWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50 active:scale-95 transition">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button onclick="toggleDrawer()" class="flex-1 h-12 rounded-xl bg-indigo-600 text-white font-bold flex items-center justify-center shadow-lg gap-2 active:scale-95 transition active:bg-indigo-700">
                <i class="fas fa-list-ul"></i> Danh Sách
            </button>
            <button onclick="nextWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50 active:scale-95 transition">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- MODAL: GRAMMAR LIST -->
    <div id="grammarListModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/70 backdrop-blur-sm transition-opacity opacity-0" id="grammarListBackdrop" onclick="closeModal('grammarListModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-4xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[85vh]" id="grammarListPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-2xl">
                <div class="flex items-center gap-3">
                    <div class="bg-indigo-600 text-white p-2 rounded-lg shadow-sm"><i class="fas fa-book"></i></div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">Cẩm Nang Ngữ Pháp</h3>
                        <p class="text-xs text-gray-500">Thư viện ngữ pháp Day 6 (N5 - N4)</p>
                    </div>
                </div>
                <button onclick="closeModal('grammarListModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times text-xl"></i></button>
            </div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="grammarGrid"></div>
            </div>
            <div class="p-4 border-t border-gray-100 bg-white rounded-b-2xl flex justify-end">
                <button onclick="closeModal('grammarListModal')" class="px-6 py-2 bg-gray-800 text-white font-bold rounded-full text-sm transition active:scale-95 shadow-lg hover:bg-gray-700">Đã Hiểu</button>
            </div>
        </div>
    </div>

    <!-- MODAL: GRAMMAR DETAIL -->
    <div id="detailGrammarModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0" id="detailGrammarBackdrop" onclick="closeModal('detailGrammarModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-md relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col" id="detailGrammarPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-2xl">
                <div class="flex items-center gap-2">
                    <div class="bg-indigo-100 p-1.5 rounded-lg text-indigo-600"><i class="fas fa-info-circle"></i></div>
                    <h3 class="text-lg font-bold text-gray-800">Giải thích Ngữ pháp</h3>
                </div>
                <button onclick="closeModal('detailGrammarModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6">
                <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-3 text-center mb-4 shadow-sm">
                    <code class="text-lg font-bold text-indigo-700 font-mono" id="dgFormula"></code>
                </div>
                <div id="dgExplanation" class="text-gray-600 text-sm mb-4 space-y-3 leading-relaxed"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: KANJI STROKE -->
    <div id="strokeModal" class="fixed inset-0 z-[80] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity opacity-0" id="strokeBackdrop" onclick="closeModal('strokeModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-5xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[90vh]" id="strokePanel">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-pink-50 rounded-t-2xl">
                <h3 class="text-lg font-bold text-pink-700 flex items-center gap-2"><i class="fas fa-pen-nib"></i> Tập Viết & Chi Tiết Kanji</h3>
                <button onclick="closeModal('strokeModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50 flex-1">
                <div id="strokeTabs" class="flex justify-center gap-2 mb-6 flex-wrap"></div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col gap-6 text-center">
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 relative">
                            <p class="text-xs text-gray-400 mb-2 font-bold uppercase tracking-wider">Mô phỏng nét viết</p>
                            <div id="strokeAnimContainer" class="w-48 h-48 mx-auto bg-white border border-gray-300 relative stroke-grid-box flex items-center justify-center rounded-lg cursor-pointer" onclick="replayStrokeAnimation()"></div>
                            <button onclick="replayStrokeAnimation()" class="absolute top-4 right-4 bg-pink-50 text-pink-600 w-8 h-8 rounded-full flex items-center justify-center hover:bg-pink-100 transition shadow-sm z-10"><i class="fas fa-redo text-sm"></i></button>
                            <p class="text-[10px] text-gray-400 mt-2">Nhấn vào ô để chạy lại</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 text-left">
                            <p class="text-xs text-gray-400 mb-3 font-bold uppercase tracking-wider text-center">Thứ tự từng nét</p>
                            <div id="strokeGridContainer" class="flex flex-wrap gap-2 justify-center"></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col h-full text-left">
                        <div id="kanjiDetailContent">
                            <div class="flex items-center justify-between mb-6 border-b border-gray-100 pb-4">
                                <div><h2 id="detailKanji" class="text-6xl font-bold text-gray-800 ja-text mb-1 leading-none"></h2><div class="text-xs font-bold bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded inline-block mt-2" id="detailHanViet"></div></div>
                                <div class="text-right"><div class="text-2xl font-bold text-gray-600 capitalize" id="detailMeaning"></div></div>
                            </div>
                            <!-- Radicals -->
                            <div class="mb-4 bg-indigo-50 p-3 rounded-lg border border-indigo-100">
                                <span class="text-xs font-bold text-indigo-500 uppercase block mb-1"><i class="fas fa-layer-group mr-1"></i> Bộ thủ (Thành phần)</span>
                                <span class="text-sm font-medium text-indigo-900" id="detailRadicals">...</span>
                            </div>
                            <!-- On/Kun -->
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100 flex justify-between items-center group cursor-pointer" onclick="document.getElementById('btnPlayOn').click()"><div class="flex flex-col"><span class="text-xs font-bold text-gray-400 uppercase">On</span><span class="text-lg font-bold text-indigo-600 ja-text" id="detailOn"></span></div><button id="btnPlayOn" class="text-indigo-300 group-hover:text-indigo-600"><i class="fas fa-volume-up"></i></button></div>
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100 flex justify-between items-center group cursor-pointer" onclick="document.getElementById('btnPlayKun').click()"><div class="flex flex-col"><span class="text-xs font-bold text-gray-400 uppercase">Kun</span><span class="text-lg font-bold text-pink-600 ja-text" id="detailKun"></span></div><button id="btnPlayKun" class="text-pink-300 group-hover:text-pink-600"><i class="fas fa-volume-up"></i></button></div>
                            </div>
                            <!-- Tips -->
                            <div class="space-y-4 mb-6">
                                <div class="bg-green-50 p-4 rounded-lg border border-green-100">
                                    <h4 class="text-sm font-bold text-green-800 mb-2 flex items-center gap-2"><i class="fas fa-image"></i> Ghi nhớ hình ảnh</h4>
                                    <p class="text-sm text-green-700 leading-relaxed" id="detailTipImg"></p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg border border-orange-100">
                                    <h4 class="text-sm font-bold text-orange-800 mb-2 flex items-center gap-2"><i class="fas fa-music"></i> Mẹo nhớ âm thanh</h4>
                                    <div class="space-y-2">
                                        <p class="text-sm text-orange-700 flex items-start gap-2"><span class="font-bold text-[10px] bg-orange-200 px-1.5 py-0.5 rounded text-orange-800 min-w-[30px] text-center mt-0.5">ON</span> <span id="detailTipSoundOn"></span></p>
                                        <p class="text-sm text-orange-700 flex items-start gap-2"><span class="font-bold text-[10px] bg-pink-200 px-1.5 py-0.5 rounded text-pink-800 min-w-[30px] text-center mt-0.5">KUN</span> <span id="detailTipSoundKun"></span></p>
                                    </div>
                                </div>
                            </div>
                            <!-- Related Words -->
                            <div>
                                <h4 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-3">Từ vựng liên quan</h4>
                                <div class="space-y-2" id="detailWords"></div>
                            </div>
                        </div>
                        <div id="kanjiDetailEmpty" class="hidden h-full flex flex-col items-center justify-center text-center p-4 text-gray-400"><i class="fas fa-book-open text-4xl mb-3 opacity-30"></i><p class="text-sm">Chưa có dữ liệu chi tiết cho chữ Hán này.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. GRAMMAR REPO (N5 - N4) ---
        const grammarRepo = {
            "te_kudasai": { title: "Hãy làm gì", formula: "Vてください", desc: "N5: Yêu cầu, nhờ vả lịch sự.", ex: "パスポートを見せてください。" },
            "te_mo_ii": { title: "Làm...được không", formula: "Vてもいい", desc: "N5/N4: Xin phép làm gì đó.", ex: "写真を撮ってもいいですか。" },
            "ni_iku": { title: "Đi để làm gì", formula: "V(bỏ masu)/N + に行く", desc: "N5: Mục đích của chuyển động.", ex: "映画を見に行きます。" },
            "te_morau": { title: "Được làm cho", formula: "Vてもらう", desc: "N4: Được ai đó làm gì cho mình (biết ơn).", ex: "友達に手伝ってもらった。" },
            "te_ageru": { title: "Làm cho ai", formula: "Vてあげる", desc: "N4: Làm gì đó cho người khác.", ex: "荷物を持ってあげました。" },
            "te_kureru": { title: "Làm cho tôi", formula: "Vてくれる", desc: "N4: Ai đó làm gì cho mình.", ex: "父が時計を買ってくれた。" },
            "kinshi": { title: "Cấm đoán", formula: "Vる + な / N + 禁止", desc: "N4: Cấm không được làm gì.", ex: "ここでタバコを吸うな。" },
            "te_iru": { title: "Đang/Trạng thái", formula: "Vている", desc: "N5/N4: Hành động đang diễn ra hoặc kết quả trạng thái.", ex: "雨が降っています。" },
            "wa_desu": { title: "Cấu trúc định danh", formula: "N1 は N2 です", desc: "N5: Khẳng định N1 là N2.", ex: "これはペンです。" },
            "ta_form": { title: "Thể quá khứ ngắn", formula: "Vた", desc: "N5: Dùng trong văn nói thân mật kể chuyện quá khứ.", ex: "ご飯食べた？" },
            "volitional": { title: "Thể ý định", formula: "Vよう", desc: "N4: Dùng trong văn nói thân mật để rủ rê hoặc tỏ ý định.", ex: "行こう！" },
            "mashou": { title: "Cùng làm nhé", formula: "Vましょう", desc: "N5: Rủ rê, đề nghị.", ex: "帰りましょう。" },
            "ndesu": { title: "Giải thích/Nhấn mạnh", formula: "V/Adj + んです", desc: "N4: Giải thích lý do, tình huống.", ex: "お腹が痛いんです。" },
            "sou_da_hearsay": { title: "Nghe nói là", formula: "Vru/Adj + そうです", desc: "N4: Truyền đạt lại thông tin nghe được.", ex: "雨が降るそうです。" },
            "sou_da_visual": { title: "Trông có vẻ", formula: "Adj(bỏ i/na) + そうです", desc: "N4: Phỏng đoán dựa trên thị giác.", ex: "おいしそうです。" },
            "tara": { title: "Nếu/Sau khi", formula: "Vたら", desc: "N4: Điều kiện giả định hoặc hành động nối tiếp.", ex: "雨が降ったら、行きません。" },
            "nakucha": { title: "Phải... (Văn nói)", formula: "Vなくちゃ", desc: "N3: Dạng rút gọn của Vなければなりません.", ex: "もう行かなくちゃ。" },
            "koto_ga_aru": { title: "Đã từng", formula: "Vた + ことが（ある）", desc: "N4: Kinh nghiệm trong quá khứ.", ex: "日本へ行ったことがあります。" },
            "o_particle": { title: "Trợ từ O", formula: "N + を + V", desc: "N5: Chỉ đối tượng tác động của hành động.", ex: "ご飯を食べます。" },
            "nai_de": { title: "Xin đừng...", formula: "Vないで + ください", desc: "N5: Yêu cầu ai đó không làm gì.", ex: "ここで写真を撮らないでください。" },
            "potential": { title: "Thể khả năng", formula: "Vれる / Vられる", desc: "N4: Có thể làm gì.", ex: "日本語が話せます。" },
            "ga_aru": { title: "Có (sở hữu/tồn tại)", formula: "N + が ある", desc: "N5: Có đồ vật, sự việc.", ex: "時間があります。" },
            "ga_imasu": { title: "Có (người/động vật)", formula: "N + が います", desc: "N5: Sự tồn tại của vật sống.", ex: "猫がいます。" },
            "de_method": { title: "Bằng cách nào", formula: "N(phương tiện) + で", desc: "N5: Phương tiện, cách thức.", ex: "バスで行きます。" },
            "toshite": { title: "Với tư cách là", formula: "N + として", desc: "N3: Biểu thị lập trường, tư cách.", ex: "医者として働いています。" },
            "shi_shi": { title: "Vừa...vừa... (Liệt kê)", formula: "～し、～し", desc: "N4: Liệt kê lý do, tính chất.", ex: "安くて、おいしいです。" },
            "yori_hodo": { title: "So sánh hơn/kém", formula: "N1 は N2 より Adj / N1 は N2 ほど Adj(nai)", desc: "N4/N3: So sánh mức độ.", ex: "今日は昨日より暑いです。" },
            "te_simau": { title: "Lỡ/Hoàn thành", formula: "Vてしまう", desc: "N4: Hối tiếc vì lỡ làm hoặc làm xong hết.", ex: "食べてしまった。" },
            "te_form_cause": { title: "Vì...nên...", formula: "Vて / Adj(i)くて", desc: "N4: Chỉ nguyên nhân, lý do.", ex: "風邪を引いて、休みました。" }
        };

        // --- 2. VOCABULARY DATA (Day 6: Life & Entertainment) ---
        const vocabData = [
            { "STT": 1, "Kanji": "見せます", "Nghĩa": "Cho xem", "Furigana": "みせます", "type": "verb", "conv": { "polite": "パスポートを見せてください。", "pVi": "Hãy cho tôi xem hộ chiếu.", "casual": "これ見せて。", "cVi": "Cho xem cái này đi.", "gIds": ["te_kudasai"] } },
            { "STT": 2, "Kanji": "吸います", "Nghĩa": "Hút (thuốc)", "Furigana": "すいます", "type": "verb", "conv": { "polite": "ここでタバコを吸ってもいいですか。", "pVi": "Tôi hút thuốc ở đây được không?", "casual": "タバコ吸っていい？", "cVi": "Hút thuốc được không?", "gIds": ["te_mo_ii"] } },
            { "STT": 3, "Kanji": "駐車します", "Nghĩa": "Đỗ xe", "Furigana": "ちゅうしゃします", "type": "verb", "conv": { "polite": "ここに車を駐車しないでください。", "pVi": "Xin đừng đỗ xe ở đây.", "casual": "ここ駐車しちゃダメだよ。", "cVi": "Không được đỗ xe ở đây đâu.", "gIds": ["nai_de"] } },
            { "STT": 4, "Kanji": "声", "Nghĩa": "Tiếng, giọng nói", "Furigana": "こえ", "type": "noun", "conv": { "polite": "大きい声で話してください。", "pVi": "Hãy nói to lên.", "casual": "声が小さいよ。", "cVi": "Giọng bé thế.", "gIds": ["te_kudasai"] } },
            { "STT": 5, "Kanji": "", "Nghĩa": "Không được", "Furigana": "だめ", "type": "adj_na", "conv": { "polite": "それはだめです。", "pVi": "Cái đó không được.", "casual": "だめだよ！", "cVi": "Không được đâu!", "gIds": ["wa_desu"] } },
            { "STT": 6, "Kanji": "虹", "Nghĩa": "Cầu vồng", "Furigana": "にじ", "type": "noun", "conv": { "polite": "虹が出ています。", "pVi": "Có cầu vồng kìa.", "casual": "あ、虹だ！", "cVi": "A, cầu vồng!", "gIds": ["te_iru"] } },
            { "STT": 7, "Kanji": "雷", "Nghĩa": "Sấm", "Furigana": "かみなり", "type": "noun", "conv": { "polite": "雷が鳴っています。", "pVi": "Sấm đang kêu.", "casual": "雷怖い。", "cVi": "Sấm sợ quá.", "gIds": ["te_iru"] } },
            { "STT": 8, "Kanji": "太陽", "Nghĩa": "Mặt trời", "Furigana": "たいよう", "type": "noun", "conv": { "polite": "太陽が昇りました。", "pVi": "Mặt trời đã mọc.", "casual": "太陽がまぶしい。", "cVi": "Mặt trời chói quá.", "gIds": ["ta_form"] } },
            { "STT": 9, "Kanji": "晴れる", "Nghĩa": "Nắng", "Furigana": "はれる", "type": "verb", "conv": { "polite": "明日は晴れるでしょう。", "pVi": "Mai chắc trời sẽ nắng.", "casual": "明日晴れるかな。", "cVi": "Mai có nắng không nhỉ.", "gIds": [] } },
            { "STT": 10, "Kanji": "生活", "Nghĩa": "Cuộc sống", "Furigana": "せいかつ", "type": "noun", "conv": { "polite": "日本の生活に慣れましたか。", "pVi": "Bạn đã quen với cuộc sống ở Nhật chưa?", "casual": "こっちの生活どう？", "cVi": "Cuộc sống ở đây thế nào?", "gIds": ["ta_form"] } },
            { "STT": 11, "Kanji": "寮", "Nghĩa": "Kí túc xá", "Furigana": "りょう", "type": "place", "conv": { "polite": "寮に住んでいます。", "pVi": "Tôi đang sống ở ký túc xá.", "casual": "寮生活は楽しいよ。", "cVi": "Sống ký túc vui lắm.", "gIds": ["te_iru"] } },
            { "STT": 12, "Kanji": "所", "Nghĩa": "Nơi", "Furigana": "ところ", "type": "place", "conv": { "polite": "静かな所へ行きたいです。", "pVi": "Tôi muốn đến nơi yên tĩnh.", "casual": "いい所知ってるよ。", "cVi": "Tớ biết chỗ này hay lắm.", "gIds": ["tai"] } },
            { "STT": 13, "Kanji": "風邪", "Nghĩa": "Cảm cúm", "Furigana": "かぜ", "type": "noun", "conv": { "polite": "風邪を引いてしまいました。", "pVi": "Tôi bị cảm mất rồi.", "casual": "風邪引いちゃった。", "cVi": "Bị cảm mất tiêu rồi.", "gIds": ["te_simau"] } },
            { "STT": 14, "Kanji": "元気(な)", "Nghĩa": "Khỏe mạnh", "Furigana": "げんき", "type": "adj_na", "conv": { "polite": "お元気ですか。", "pVi": "Bạn có khỏe không?", "casual": "元気？", "cVi": "Khỏe không?", "gIds": ["wa_desu"] } },
            { "STT": 15, "Kanji": "可愛い", "Nghĩa": "Đáng yêu", "Furigana": "かわいい", "type": "adj_i", "conv": { "polite": "可愛い犬ですね。", "pVi": "Con chó đáng yêu nhỉ.", "casual": "めっちゃ可愛い！", "cVi": "Đáng yêu xỉu!", "gIds": ["wa_desu"] } },
            { "STT": 16, "Kanji": "汚い", "Nghĩa": "Bẩn", "Furigana": "きたない", "type": "adj_i", "conv": { "polite": "手が汚いです。", "pVi": "Tay bị bẩn.", "casual": "部屋が汚いな。", "cVi": "Phòng bẩn thế.", "gIds": ["wa_desu"] } },
            { "STT": 17, "Kanji": "臭い", "Nghĩa": "Hôi", "Furigana": "くさい", "type": "adj_i", "conv": { "polite": "何か臭いですね。", "pVi": "Có mùi gì hôi nhỉ.", "casual": "なんか臭くない？", "cVi": "Có mùi gì hôi hôi không?", "gIds": ["wa_desu"] } },
            { "STT": 18, "Kanji": "", "Nghĩa": "Khiếu hài hước", "Furigana": "ユーモア", "type": "noun", "conv": { "polite": "彼はユーモアがあります。", "pVi": "Anh ấy có khiếu hài hước.", "casual": "ユーモアのセンスあるね。", "cVi": "Có khiếu hài hước đấy.", "gIds": ["ga_aru"] } },
            { "STT": 19, "Kanji": "親切(な)", "Nghĩa": "Tốt bụng", "Furigana": "しんせつ", "type": "adj_na", "conv": { "polite": "親切にしていただきました。", "pVi": "Tôi đã được đối xử tốt bụng.", "casual": "あの人、親切だね。", "cVi": "Người kia tốt bụng nhỉ.", "gIds": ["wa_desu"] } },
            { "STT": 20, "Kanji": "引きます", "Nghĩa": "Bị (cảm)", "Furigana": "ひきます", "type": "verb", "conv": { "polite": "風邪を引きました。", "pVi": "Tôi bị cảm rồi.", "casual": "風邪引いた。", "cVi": "Bị cảm rồi.", "gIds": ["ta_form"] } },
            { "STT": 21, "Kanji": "", "Nghĩa": "Quà tặng", "Furigana": "プレゼント", "type": "noun", "conv": { "polite": "プレゼントをあげました。", "pVi": "Tôi đã tặng quà.", "casual": "プレゼントもらった？", "cVi": "Được nhận quà chưa?", "gIds": ["ta_form"] } },
            { "STT": 22, "Kanji": "お土産", "Nghĩa": "Quà lưu niệm", "Furigana": "おみやげ", "type": "noun", "conv": { "polite": "お土産を買いました。", "pVi": "Tôi đã mua quà lưu niệm.", "casual": "これ、お土産。", "cVi": "Quà lưu niệm này.", "gIds": ["ta_form"] } },
            { "STT": 23, "Kanji": "お年玉", "Nghĩa": "Tiền mừng tuổi", "Furigana": "おとしだま", "type": "noun", "conv": { "polite": "子供にお年玉をあげます。", "pVi": "Tôi lì xì cho trẻ con.", "casual": "お年玉もらった。", "cVi": "Được lì xì rồi.", "gIds": ["te_ageru"] } },
            { "STT": 24, "Kanji": "給料", "Nghĩa": "Lương", "Furigana": "きゅうりょう", "type": "noun", "conv": { "polite": "給料はいくらですか。", "pVi": "Lương bao nhiêu vậy ạ?", "casual": "給料入った！", "cVi": "Có lương rồi!", "gIds": ["wa_desu"] } },
            { "STT": 25, "Kanji": "", "Nghĩa": "Tiền thưởng", "Furigana": "ボーナス", "type": "noun", "conv": { "polite": "ボーナスが出ました。", "pVi": "Đã có tiền thưởng.", "casual": "ボーナスで何買う？", "cVi": "Có thưởng mua gì đây?", "gIds": ["ta_form"] } },
            { "STT": 26, "Kanji": "", "Nghĩa": "Đồ chơi", "Furigana": "おもちゃ", "type": "noun", "conv": { "polite": "子供におもちゃを買ってあげました。", "pVi": "Tôi mua đồ chơi cho con.", "casual": "おもちゃ買ってあげた。", "cVi": "Mua đồ chơi cho rồi.", "gIds": ["te_ageru"] } },
            { "STT": 27, "Kanji": "お正月", "Nghĩa": "Tết", "Furigana": "おしょうがつ", "type": "time", "conv": { "polite": "お正月は国へ帰りますか。", "pVi": "Tết bạn có về nước không?", "casual": "お正月、どうする？", "cVi": "Tết tính sao?", "gIds": [] } },
            { "STT": 28, "Kanji": "", "Nghĩa": "Giáng sinh", "Furigana": "クリスマス", "type": "time", "conv": { "polite": "クリスマスにパーティーをします。", "pVi": "Tôi tổ chức tiệc vào Giáng sinh.", "casual": "クリスマス、空いてる？", "cVi": "Giáng sinh rảnh không?", "gIds": [] } },
            { "STT": 29, "Kanji": "", "Nghĩa": "Valentine", "Furigana": "バレンタインデー", "type": "time", "conv": { "polite": "バレンタインデーにチョコレートをあげます。", "pVi": "Tôi tặng sô cô la vào ngày Valentine.", "casual": "バレンタイン、チョコもらった？", "cVi": "Valentine có được tặng sô cô la không?", "gIds": ["te_ageru"] } },
            { "STT": 30, "Kanji": "", "Nghĩa": "Quyển vở", "Furigana": "ノート", "type": "noun", "conv": { "polite": "ノートを貸してください。", "pVi": "Cho tôi mượn vở.", "casual": "ノート見せて。", "cVi": "Cho xem vở tí.", "gIds": ["te_kudasai"] } },
            { "STT": 31, "Kanji": "彼女", "Nghĩa": "Bạn gái", "Furigana": "かのじょ", "type": "noun", "conv": { "polite": "彼女がいますか。", "pVi": "Bạn có bạn gái chưa?", "casual": "彼女できた？", "cVi": "Có bạn gái chưa?", "gIds": ["ga_imasu"] } },
            { "STT": 32, "Kanji": "恋人", "Nghĩa": "Người yêu", "Furigana": "こいびと", "type": "noun", "conv": { "polite": "恋人とデートします。", "pVi": "Tôi hẹn hò với người yêu.", "casual": "恋人募集中。", "cVi": "Đang tuyển người yêu.", "gIds": [] } },
            { "STT": 33, "Kanji": "彼氏", "Nghĩa": "Bạn trai", "Furigana": "かれし", "type": "noun", "conv": { "polite": "彼氏はどんな人ですか。", "pVi": "Bạn trai bạn là người thế nào?", "casual": "彼氏、かっこいい？", "cVi": "Bạn trai ngầu không?", "gIds": ["wa_desu"] } },
            { "STT": 34, "Kanji": "友人", "Nghĩa": "Bạn thân", "Furigana": "ゆうじん", "type": "noun", "conv": { "polite": "友人と食事します。", "pVi": "Tôi đi ăn với bạn thân.", "casual": "友人と遊ぶ。", "cVi": "Đi chơi với bạn thân.", "gIds": [] } },
            { "STT": 35, "Kanji": "お弁当", "Nghĩa": "Cơm hộp", "Furigana": "おべんとう", "type": "food", "conv": { "polite": "お弁当を作ってきました。", "pVi": "Tôi đã làm cơm hộp mang đến.", "casual": "今日はお弁当だ。", "cVi": "Nay ăn cơm hộp.", "gIds": ["te_kuru"] } },
            { "STT": 36, "Kanji": "", "Nghĩa": "Cà phê", "Furigana": "コーヒー", "type": "food", "conv": { "polite": "コーヒーを飲みませんか。", "pVi": "Uống cà phê không?", "casual": "コーヒー飲む？", "cVi": "Uống cà phê không?", "gIds": ["mashou"] } },
            { "STT": 37, "Kanji": "お茶", "Nghĩa": "Trà", "Furigana": "おちゃ", "type": "food", "conv": { "polite": "お茶を入れましょうか。", "pVi": "Để tôi pha trà nhé?", "casual": "お茶、飲む？", "cVi": "Uống trà không?", "gIds": ["mashou"] } },
            { "STT": 38, "Kanji": "美術館", "Nghĩa": "Bảo tàng mỹ thuật", "Furigana": "びじゅつかん", "type": "place", "conv": { "polite": "美術館へ行きました。", "pVi": "Tôi đã đi bảo tàng.", "casual": "美術館行ったよ。", "cVi": "Đi bảo tàng rồi.", "gIds": ["ta_form"] } },
            { "STT": 39, "Kanji": "連れていきます", "Nghĩa": "Dẫn đi", "Furigana": "つれていきます", "type": "verb", "conv": { "polite": "子供を病院へ連れていきます。", "pVi": "Tôi dẫn con đi bệnh viện.", "casual": "子供、病院連れていく。", "cVi": "Dẫn con đi viện.", "gIds": ["ni_iku"] } },
            { "STT": 40, "Kanji": "連れてきます", "Nghĩa": "Dẫn đến", "Furigana": "つれてきます", "type": "verb", "conv": { "polite": "友達を連れてきました。", "pVi": "Tôi đã dẫn bạn đến.", "casual": "友達連れてきたよ。", "cVi": "Dẫn bạn đến rồi này.", "gIds": ["ta_form"] } },
            { "STT": 41, "Kanji": "紹介します", "Nghĩa": "Giới thiệu", "Furigana": "しょうかいします", "type": "verb", "conv": { "polite": "彼を紹介してください。", "pVi": "Hãy giới thiệu anh ấy cho tôi.", "casual": "いい人紹介して。", "cVi": "Giới thiệu người tốt cho tớ đi.", "gIds": ["te_kudasai"] } },
            { "STT": 42, "Kanji": "案内します", "Nghĩa": "Hướng dẫn", "Furigana": "あんないします", "type": "verb", "conv": { "polite": "道を案内しましょうか。", "pVi": "Để tôi chỉ đường cho nhé?", "casual": "道、案内してあげる。", "cVi": "Để tớ chỉ đường cho.", "gIds": ["mashou", "te_ageru"] } },
            { "STT": 43, "Kanji": "説明します", "Nghĩa": "Giải thích", "Furigana": "せつめいします", "type": "verb", "conv": { "polite": "もう一度説明してください。", "pVi": "Hãy giải thích lại lần nữa.", "casual": "ちゃんと説明して。", "cVi": "Giải thích rõ ràng đi.", "gIds": ["te_kudasai"] } },
            { "STT": 44, "Kanji": "手伝ってもらいます", "Nghĩa": "Được giúp đỡ", "Furigana": "てつだってもらいます", "type": "verb", "conv": { "polite": "友達に手伝ってもらいました。", "pVi": "Tôi được bạn giúp đỡ.", "casual": "友達に手伝ってもらった。", "cVi": "Được bạn giúp cho.", "gIds": ["te_morau"] } },
            { "STT": 45, "Kanji": "作ってくれます", "Nghĩa": "Làm cho", "Furigana": "つくってくれます", "type": "verb", "conv": { "polite": "母が料理を作ってくれました。", "pVi": "Mẹ đã nấu ăn cho tôi.", "casual": "母さんが作ってくれた。", "cVi": "Mẹ nấu cho đấy.", "gIds": ["te_kureru"] } },
            { "STT": 46, "Kanji": "教えてあげます", "Nghĩa": "Dạy cho", "Furigana": "おしえてあげます", "type": "verb", "conv": { "polite": "日本語を教えてあげましょうか。", "pVi": "Tôi dạy tiếng Nhật cho bạn nhé?", "casual": "日本語、教えてあげる。", "cVi": "Tớ dạy tiếng Nhật cho.", "gIds": ["te_ageru"] } },
            { "STT": 47, "Kanji": "返事します", "Nghĩa": "Trả lời", "Furigana": "へんじします", "type": "verb", "conv": { "polite": "すぐに返事します。", "pVi": "Tôi sẽ trả lời ngay.", "casual": "早く返事して。", "cVi": "Trả lời nhanh đi.", "gIds": ["te_kudasai"] } },
            { "STT": 48, "Kanji": "漢字", "Nghĩa": "Chữ Hán", "Furigana": "かんじ", "type": "noun", "conv": { "polite": "漢字が読めますか。", "pVi": "Bạn đọc được Kanji không?", "casual": "漢字読める？", "cVi": "Đọc được Kanji không?", "gIds": ["potential"] } },
            { "STT": 49, "Kanji": "言葉", "Nghĩa": "Từ ngữ", "Furigana": "ことば", "type": "noun", "conv": { "polite": "この言葉の意味は何ですか。", "pVi": "Nghĩa của từ này là gì?", "casual": "この言葉、どういう意味？", "cVi": "Từ này nghĩa là gì?", "gIds": ["wa_desu"] } },
            { "STT": 50, "Kanji": "忘年会", "Nghĩa": "Tiệc tất niên", "Furigana": "ぼうねんかい", "type": "noun", "conv": { "polite": "忘年会に参加します。", "pVi": "Tôi tham gia tiệc tất niên.", "casual": "忘年会行く？", "cVi": "Đi ăn tất niên không?", "gIds": [] } },
            { "STT": 51, "Kanji": "新年会", "Nghĩa": "Tiệc tân niên", "Furigana": "しんねんかい", "type": "noun", "conv": { "polite": "新年会をしましょう。", "pVi": "Cùng tổ chức tiệc tân niên nào.", "casual": "新年会やろう。", "cVi": "Làm tiệc tân niên đi.", "gIds": ["mashou", "volitional"] } },
            { "STT": 52, "Kanji": "遊園地", "Nghĩa": "Công viên giải trí", "Furigana": "ゆうえんち", "type": "place", "conv": { "polite": "遊園地へ行きたいです。", "pVi": "Tôi muốn đi công viên giải trí.", "casual": "遊園地行きたい。", "cVi": "Muốn đi công viên giải trí.", "gIds": ["tai"] } },
            { "STT": 53, "Kanji": "スキー場", "Nghĩa": "Khu trượt tuyết", "Furigana": "スキーじょう", "type": "place", "conv": { "polite": "スキー場は寒いです。", "pVi": "Khu trượt tuyết lạnh.", "casual": "スキー場寒いね。", "cVi": "Khu trượt tuyết lạnh nhỉ.", "gIds": ["wa_desu"] } },
            { "STT": 54, "Kanji": "すき焼き", "Nghĩa": "Lẩu Sukiyaki", "Furigana": "すきやき", "type": "food", "conv": { "polite": "すき焼きを食べましょう。", "pVi": "Cùng ăn lẩu Sukiyaki nào.", "casual": "すき焼き食べよう。", "cVi": "Ăn Sukiyaki đi.", "gIds": ["mashou", "volitional"] } },
            { "STT": 55, "Kanji": "練習します", "Nghĩa": "Luyện tập", "Furigana": "れんしゅうします", "type": "verb", "conv": { "polite": "毎日練習しています。", "pVi": "Tôi luyện tập mỗi ngày.", "casual": "毎日練習してる。", "cVi": "Ngày nào cũng tập.", "gIds": ["te_iru"] } },
            { "STT": 56, "Kanji": "復習します", "Nghĩa": "Ôn tập", "Furigana": "ふくしゅうします", "type": "verb", "conv": { "polite": "家に帰って復習します。", "pVi": "Về nhà tôi sẽ ôn tập.", "casual": "帰って復習する。", "cVi": "Về nhà ôn bài.", "gIds": [] } },
            { "STT": 57, "Kanji": "予習します", "Nghĩa": "Chuẩn bị bài", "Furigana": "よしゅうします", "type": "verb", "conv": { "polite": "予習しておいてください。", "pVi": "Hãy chuẩn bị bài trước nhé.", "casual": "予習しといて。", "cVi": "Chuẩn bị bài trước đi.", "gIds": ["te_kudasai"] } },
            { "STT": 58, "Kanji": "覚えます", "Nghĩa": "Nhớ", "Furigana": "おぼえます", "type": "verb", "conv": { "polite": "単語を覚えました。", "pVi": "Tôi đã nhớ từ vựng.", "casual": "単語覚えた？", "cVi": "Nhớ từ vựng chưa?", "gIds": ["ta_form"] } },
            { "STT": 59, "Kanji": "頑張ります", "Nghĩa": "Cố gắng", "Furigana": "がんばります", "type": "verb", "conv": { "polite": "試験のために頑張ります。", "pVi": "Tôi sẽ cố gắng vì kỳ thi.", "casual": "頑張って！", "cVi": "Cố lên!", "gIds": ["te_kudasai"] } },
            { "STT": 60, "Kanji": "乾杯します", "Nghĩa": "Cạn ly", "Furigana": "かんぱいします", "type": "verb", "conv": { "polite": "乾杯しましょう。", "pVi": "Cùng cạn ly nào.", "casual": "乾杯しよう！", "cVi": "Zô nào!", "gIds": ["mashou", "volitional"] } },
            { "STT": 61, "Kanji": "", "Nghĩa": "Vâng (thân mật)", "Furigana": "うん", "type": "noun", "conv": { "polite": "はい、そうです。", "pVi": "Vâng, đúng vậy.", "casual": "うん、そう。", "cVi": "Ừ, đúng rồi.", "gIds": [] } },
            { "STT": 62, "Kanji": "", "Nghĩa": "Không (thân mật)", "Furigana": "ううん", "type": "noun", "conv": { "polite": "いいえ、違います。", "pVi": "Không, sai rồi.", "casual": "ううん、違う。", "cVi": "Hông, sai rồi.", "gIds": [] } },
            { "STT": 63, "Kanji": "一緒に", "Nghĩa": "Cùng nhau", "Furigana": "いっしょに", "type": "noun", "conv": { "polite": "一緒に行きませんか。", "pVi": "Cùng đi không?", "casual": "一緒に行かない？", "cVi": "Đi cùng hông?", "gIds": ["mashou"] } },
            { "STT": 64, "Kanji": "", "Nghĩa": "Taxi", "Furigana": "タクシー", "type": "vehicle", "conv": { "polite": "タクシーを呼びましょうか。", "pVi": "Tôi gọi taxi nhé?", "casual": "タクシー呼ぼうか？", "cVi": "Gọi taxi nhá?", "gIds": ["mashou"] } },
            { "STT": 65, "Kanji": "", "Nghĩa": "Vali", "Furigana": "スーツケース", "type": "noun", "conv": { "polite": "スーツケースが重いです。", "pVi": "Vali nặng quá.", "casual": "スーツケース重い。", "cVi": "Vali nặng thế.", "gIds": ["wa_desu"] } },
            { "STT": 66, "Kanji": "空港", "Nghĩa": "Sân bay", "Furigana": "くうこう", "type": "place", "conv": { "polite": "空港へ行きます。", "pVi": "Tôi đi ra sân bay.", "casual": "空港行く。", "cVi": "Ra sân bay đây.", "gIds": ["ni_iku"] } },
            { "STT": 67, "Kanji": "痛い", "Nghĩa": "Đau", "Furigana": "いたい", "type": "adj_i", "conv": { "polite": "頭が痛いです。", "pVi": "Tôi bị đau đầu.", "casual": "頭痛い。", "cVi": "Đau đầu quá.", "gIds": ["wa_desu"] } },
            { "STT": 68, "Kanji": "寝坊します", "Nghĩa": "Ngủ nướng", "Furigana": "ねぼうします", "type": "verb", "conv": { "polite": "今朝、寝坊しました。", "pVi": "Sáng nay tôi ngủ quên.", "casual": "寝坊しちゃった。", "cVi": "Ngủ quên mất tiêu.", "gIds": ["ta_form", "te_simau"] } },
            { "STT": 69, "Kanji": "遅れます", "Nghĩa": "Muộn", "Furigana": "おくれます", "type": "verb", "conv": { "polite": "時間に遅れないでください。", "pVi": "Xin đừng trễ giờ.", "casual": "遅れないでね。", "cVi": "Đừng đến muộn đấy.", "gIds": ["nai_de"] } },
            { "STT": 70, "Kanji": "手伝います", "Nghĩa": "Giúp đỡ", "Furigana": "てつだいます", "type": "verb", "conv": { "polite": "手伝いましょうか。", "pVi": "Tôi giúp bạn nhé?", "casual": "手伝おうか？", "cVi": "Giúp một tay không?", "gIds": ["mashou", "volitional"] } },
            { "STT": 71, "Kanji": "呼びます", "Nghĩa": "Gọi", "Furigana": "よびます", "type": "verb", "conv": { "polite": "タクシーを呼びました。", "pVi": "Tôi đã gọi taxi.", "casual": "タクシー呼んだ。", "cVi": "Gọi xe rồi.", "gIds": ["ta_form"] } },
            { "STT": 72, "Kanji": "持ちます", "Nghĩa": "Cầm/Mang", "Furigana": "もちます", "type": "verb", "conv": { "polite": "荷物を持ちましょうか。", "pVi": "Tôi mang hành lý giúp nhé?", "casual": "荷物持とうか？", "cVi": "Xách hộ cho nhé?", "gIds": ["mashou", "volitional"] } },
            { "STT": 73, "Kanji": "迎えます", "Nghĩa": "Đón", "Furigana": "むかえます", "type": "verb", "conv": { "polite": "空港へ迎えに行きます。", "pVi": "Tôi ra sân bay đón.", "casual": "空港へ迎えに行く。", "cVi": "Ra sân bay đón đây.", "gIds": ["ni_iku"] } },
            { "STT": 74, "Kanji": "迎えに行きます", "Nghĩa": "Đi đón", "Furigana": "むかえにいきます", "type": "verb", "conv": { "polite": "駅まで迎えに行きます。", "pVi": "Tôi đi ra ga đón.", "casual": "駅まで迎えに行く。", "cVi": "Ra ga đón nhé.", "gIds": ["ni_iku"] } },
            { "STT": 75, "Kanji": "迎えに来ます", "Nghĩa": "Đến đón", "Furigana": "むかえにきます", "type": "verb", "conv": { "polite": "母が迎えに来てくれました。", "pVi": "Mẹ đã đến đón tôi.", "casual": "母さんが迎えに来てくれた。", "cVi": "Mẹ đến đón rồi.", "gIds": ["te_kureru"] } },
            { "STT": 76, "Kanji": "禁煙", "Nghĩa": "Cấm hút thuốc", "Furigana": "きんえん", "type": "noun", "conv": { "polite": "ここは禁煙です。", "pVi": "Ở đây cấm hút thuốc.", "casual": "ここ、禁煙だよ。", "cVi": "Chỗ này cấm hút thuốc.", "gIds": ["wa_desu"] } },
            { "STT": 77, "Kanji": "駐車禁止", "Nghĩa": "Cấm đỗ xe", "Furigana": "ちゅうしゃきんし", "type": "noun", "conv": { "polite": "ここは駐車禁止です。", "pVi": "Ở đây cấm đỗ xe.", "casual": "ここ、駐禁だよ。", "cVi": "Cấm đỗ đấy.", "gIds": ["wa_desu"] } },
            { "STT": 78, "Kanji": "上司", "Nghĩa": "Cấp trên", "Furigana": "じょうし", "type": "noun", "conv": { "polite": "上司に相談します。", "pVi": "Tôi sẽ thảo luận với cấp trên.", "casual": "上司に相談する。", "cVi": "Hỏi ý kiến sếp đã.", "gIds": [] } },
            { "STT": 79, "Kanji": "", "Nghĩa": "Email", "Furigana": "メール", "type": "noun", "conv": { "polite": "メールを送ってください。", "pVi": "Hãy gửi email cho tôi.", "casual": "メール送って。", "cVi": "Gửi mail nhé.", "gIds": ["te_kudasai"] } },
            { "STT": 80, "Kanji": "", "Nghĩa": "Vé", "Furigana": "チケット", "type": "noun", "conv": { "polite": "チケットを予約しました。", "pVi": "Tôi đã đặt vé.", "casual": "チケット予約した。", "cVi": "Đặt vé rồi.", "gIds": ["ta_form"] } },
            { "STT": 81, "Kanji": "", "Nghĩa": "Thẻ Suica", "Furigana": "Suicaカード", "type": "noun", "conv": { "polite": "Suicaを持っていますか。", "pVi": "Bạn có thẻ Suica không?", "casual": "Suica持ってる？", "cVi": "Có Suica không?", "gIds": ["te_iru"] } },
            { "STT": 82, "Kanji": "切符", "Nghĩa": "Vé tàu/xe", "Furigana": "きっぷ", "type": "noun", "conv": { "polite": "切符を買わなければなりません。", "pVi": "Phải mua vé.", "casual": "切符買わなきゃ。", "cVi": "Phải mua vé thôi.", "gIds": ["nakucha"] } },
            { "STT": 83, "Kanji": "切手", "Nghĩa": "Tem", "Furigana": "きって", "type": "noun", "conv": { "polite": "切手を貼ってください。", "pVi": "Hãy dán tem vào.", "casual": "切手貼って。", "cVi": "Dán tem đi.", "gIds": ["te_kudasai"] } },
            { "STT": 84, "Kanji": "封筒", "Nghĩa": "Phong bì", "Furigana": "ふうとう", "type": "noun", "conv": { "polite": "手紙を封筒に入れます。", "pVi": "Tôi bỏ thư vào phong bì.", "casual": "手紙、封筒に入れる。", "cVi": "Bỏ thư vào phong bì.", "gIds": [] } },
            { "STT": 85, "Kanji": "ベトナム料理", "Nghĩa": "Món ăn VN", "Furigana": "ベトナムりょうり", "type": "food", "conv": { "polite": "ベトナム料理はおいしいそうです。", "pVi": "Nghe nói món Việt Nam ngon lắm.", "casual": "ベトナム料理、おいしいって。", "cVi": "Nghe bảo đồ Việt ngon lắm.", "gIds": ["sou_da_hearsay", "datte"] } },
            { "STT": 86, "Kanji": "花火", "Nghĩa": "Pháo hoa", "Furigana": "はなび", "type": "noun", "conv": { "polite": "花火大会に行きましょう。", "pVi": "Cùng đi xem pháo hoa nào.", "casual": "花火大会行こう。", "cVi": "Đi xem pháo hoa đi.", "gIds": ["mashou", "volitional"] } },
            { "STT": 87, "Kanji": "お祭り", "Nghĩa": "Lễ hội", "Furigana": "おまつり", "type": "noun", "conv": { "polite": "お祭りはにぎやかでした。", "pVi": "Lễ hội rất náo nhiệt.", "casual": "お祭り、にぎやかだった。", "cVi": "Lễ hội đông vui lắm.", "gIds": ["ta_form"] } }
        ];

        // --- 3. KANJI DETAILS (Tips & Mnemonics) ---
        const kanjiDetails = {
            "見": { hanviet: "KIẾN", mean: "Nhìn/Cho xem", on: "ケン", kun: "み.る, み.せる", radicals: "Mục (目)", tipImg: "Mắt trên chân đi kiến tập.", tipSoundOn: "**Ken**gaku kiến tập.", tipSoundKun: "**Mi**seru cho xem.", words: [{w:"見せます (みせます)", m:"Cho xem"}, {w:"見物 (けんぶつ)", m:"Tham quan"}] },
            "吸": { hanviet: "HẤP", mean: "Hút/Hít", on: "キュウ", kun: "す.う", radicals: "Khẩu (口) + Cập (及)", tipImg: "Miệng (口) hít thở đến mức (及) ngất.", tipSoundOn: "**Kyuu**in hấp dẫn.", tipSoundKun: "**Su**u hút.", words: [{w:"吸います (すいます)", m:"Hút"}, {w:"呼吸 (こきゅう)", m:"Hô hấp"}] },
            "駐": { hanviet: "TRÚ", mean: "Đỗ xe", on: "チュウ", kun: "", radicals: "Mã (馬) + Chủ (主)", tipImg: "Con ngựa (馬) đứng chủ (主) yếu một chỗ.", tipSoundOn: "**Chuu**sha đỗ xe.", tipSoundKun: "", words: [{w:"駐車 (ちゅうしゃ)", m:"Đỗ xe"}, {w:"駐輪場 (ちゅうりんじょう)", m:"Bãi xe đạp"}] },
            "車": { hanviet: "XA", mean: "Xe", on: "シャ", kun: "くるま", radicals: "Xa (車)", tipImg: "Hình chiếc xe kéo.", tipSoundOn: "**Sha** xa.", tipSoundKun: "**Kuruma** cu rù mà.", words: [{w:"駐車 (ちゅうしゃ)", m:"Đỗ xe"}, {w:"電車 (でんしゃ)", m:"Tàu điện"}] },
            "声": { hanviet: "THANH", mean: "Tiếng/Giọng", on: "セイ", kun: "こえ", radicals: "Sĩ (士)", tipImg: "Kẻ sĩ (士) dùng gậy đánh vào tai (耳).", tipSoundOn: "**Sei** thanh.", tipSoundKun: "**Koe** giọng.", words: [{w:"声 (こえ)", m:"Giọng nói"}, {w:"音声 (おんせい)", m:"Âm thanh"}] },
            "虹": { hanviet: "HỒNG", mean: "Cầu vồng", on: "コウ", kun: "にじ", radicals: "Trùng (虫) + Công (工)", tipImg: "Con sâu (虫) làm công (工) việc tạo cầu vồng.", tipSoundOn: "**Kou** hồng.", tipSoundKun: "**Niji** cầu vồng.", words: [{w:"虹 (にじ)", m:"Cầu vồng"}] },
            "雷": { hanviet: "LÔI", mean: "Sấm", on: "ライ", kun: "かみなり", radicals: "Vũ (雨) + Điền (田)", tipImg: "Mưa (雨) rơi xuống ruộng (田) tạo sấm.", tipSoundOn: "**Rai** lôi.", tipSoundKun: "**Kaminari** sấm sét.", words: [{w:"雷 (かみなり)", m:"Sấm"}, {w:"落雷 (らくらい)", m:"Sét đánh"}] },
            "太": { hanviet: "THÁI", mean: "Béo/Lớn", on: "タイ", kun: "ふと.い", radicals: "Đại (大) + Chấm (丶)", tipImg: "Người to lớn (大) có thêm một điểm (丶).", tipSoundOn: "**Tai**you mặt trời.", tipSoundKun: "**Futo**i béo.", words: [{w:"太陽 (たいよう)", m:"Mặt trời"}, {w:"太い (ふとい)", m:"Béo/Dày"}] },
            "陽": { hanviet: "DƯƠNG", mean: "Mặt trời", on: "ヨウ", kun: "", radicals: "Phụ (阝) + Dương (昜)", tipImg: "Gò đất (阝) đón ánh dương (昜).", tipSoundOn: "**You** dương.", tipSoundKun: "", words: [{w:"太陽 (たいよう)", m:"Mặt trời"}, {w:"陽気 (ようき)", m:"Vui vẻ/Tiết trời"}] },
            "晴": { hanviet: "TÌNH", mean: "Nắng/Tạnh", on: "セイ", kun: "は.れる", radicals: "Nhật (日) + Thanh (青)", tipImg: "Ngày (日) trời xanh (青) là nắng.", tipSoundOn: "**Sei** tình.", tipSoundKun: "**Ha**reru nắng.", words: [{w:"晴れます (はれます)", m:"Nắng"}, {w:"快晴 (かいせい)", m:"Trời quang đãng"}] },
            "生": { hanviet: "SINH", mean: "Sống", on: "セイ, ショウ", kun: "い.きる", radicals: "Sinh (生)", tipImg: "Cây cỏ mọc trên đất.", tipSoundOn: "**Sei**katsu sinh hoạt.", tipSoundKun: "**I**kiru sống.", words: [{w:"生活 (せいかつ)", m:"Cuộc sống"}, {w:"先生 (せんせい)", m:"Giáo viên"}] },
            "活": { hanviet: "HOẠT", mean: "Sinh hoạt", on: "カツ", kun: "", radicals: "Thủy (氵) + Thiệt (舌)", tipImg: "Nước (氵) chảy qua lưỡi (舌) là hoạt động.", tipSoundOn: "**Katsu** hoạt.", tipSoundKun: "", words: [{w:"生活 (せいかつ)", m:"Cuộc sống"}, {w:"活動 (かつどう)", m:"Hoạt động"}] },
            "寮": { hanviet: "LIÊU", mean: "Ký túc xá", on: "リョウ", kun: "", radicals: "Miên (宀)", tipImg: "Mái nhà (宀) lớn (大) có ánh sáng (日) nhỏ (小).", tipSoundOn: "**Ryou** ký túc.", tipSoundKun: "", words: [{w:"寮 (りょう)", m:"Ký túc xá"}] },
            "所": { hanviet: "SỞ", mean: "Nơi chốn", on: "ショ", kun: "ところで", radicals: "Hộ (戸) + Cân (斤)", tipImg: "Cửa (戸) có rìu (斤) canh giữ.", tipSoundOn: "**Sho** sở.", tipSoundKun: "**Tokoro** nơi.", words: [{w:"所 (ところ)", m:"Nơi chốn"}, {w:"台所 (だいどころ)", m:"Nhà bếp"}] },
            "風": { hanviet: "PHONG", mean: "Gió/Cảm", on: "フウ", kun: "かぜ", radicals: "Phong (風)", tipImg: "Con sâu (虫) trong gió.", tipSoundOn: "**Fuu** phong.", tipSoundKun: "**Kaze** gió/cảm.", words: [{w:"風邪 (かぜ)", m:"Cảm cúm"}, {w:"台風 (たいふう)", m:"Bão"}] },
            "邪": { hanviet: "TÀ", mean: "Tà ác/Cảm", on: "ジャ", kun: "", radicals: "Nha (牙) + Phụ (阝)", tipImg: "Răng (牙) cắn vào tai (阝) là tà ác.", tipSoundOn: "**Ja** tà.", tipSoundKun: "", words: [{w:"風邪 (かぜ)", m:"Cảm cúm"}, {w:"邪魔 (じゃま)", m:"Phiền hà"}] },
            "元": { hanviet: "NGUYÊN", mean: "Gốc/Khỏe", on: "ゲン", kun: "もと", radicals: "Nhị (二) + Nhân (儿)", tipImg: "Hai (二) người con (儿) là nguồn gốc.", tipSoundOn: "**Gen**ki khỏe.", tipSoundKun: "**Moto** nguồn gốc.", words: [{w:"元気 (げんき)", m:"Khỏe mạnh"}, {w:"元日 (がんじつ)", m:"Mùng 1 Tết"}] },
            "気": { hanviet: "KHÍ", mean: "Khí chất", on: "キ", kun: "", radicals: "Khí (气) + Mễ (米)", tipImg: "Hơi nước (气) bốc lên từ gạo (米).", tipSoundOn: "**Ki** khí.", tipSoundKun: "", words: [{w:"元気 (げんき)", m:"Khỏe mạnh"}, {w:"天気 (てんき)", m:"Thời tiết"}] },
            "可": { hanviet: "KHẢ", mean: "Có thể", on: "カ", kun: "", radicals: "Khẩu (口) + Đinh (丁)", tipImg: "Miệng (口) nói đinh (丁) ninh là có thể.", tipSoundOn: "**Ka**waii đáng yêu.", tipSoundKun: "", words: [{w:"可愛い (かわいい)", m:"Đáng yêu"}, {w:"可能 (かのう)", m:"Khả năng"}] },
            "愛": { hanviet: "ÁI", mean: "Yêu", on: "アイ", kun: "", radicals: "Tâm (心)", tipImg: "Nhận (爫) tình cảm từ tim (心) bạn (夂).", tipSoundOn: "**Ai** yêu.", tipSoundKun: "", words: [{w:"可愛い (かわいい)", m:"Đáng yêu"}, {w:"愛 (あい)", m:"Tình yêu"}] },
            "汚": { hanviet: "Ô", mean: "Bẩn", on: "オ", kun: "きたな.い", radicals: "Thủy (氵) + Khuy (亏)", tipImg: "Nước (氵) đọng ở số 5 (亏) là bẩn.", tipSoundOn: "**O** ô nhiễm.", tipSoundKun: "**Kitana**i bẩn.", words: [{w:"汚い (きたない)", m:"Bẩn"}, {w:"汚染 (おせん)", m:"Ô nhiễm"}] },
            "臭": { hanviet: "XÚ", mean: "Hôi", on: "シュウ", kun: "くさ.い", radicals: "Tự (自) + Khuyển (犬)", tipImg: "Tự (自) mình ngửi thấy mùi chó (犬) hôi.", tipSoundOn: "**Shuu** xú.", tipSoundKun: "**Kusa**i hôi.", words: [{w:"臭い (くさい)", m:"Hôi"}, {w:"悪臭 (あくしゅう)", m:"Mùi hôi"}] },
            "親": { hanviet: "THÂN", mean: "Thân thiết/Bố mẹ", on: "シン", kun: "おや", radicals: "Lập (立) + Mộc (木) + Kiến (見)", tipImg: "Đứng (立) trên cây (木) nhìn (見) người thân.", tipSoundOn: "**Shin**setsu tốt bụng.", tipSoundKun: "**Oya** cha mẹ.", words: [{w:"親切 (しんせつ)", m:"Tốt bụng"}, {w:"親 (おや)", m:"Bố mẹ"}] },
            "切": { hanviet: "THIẾT", mean: "Cắt/Thiết thực", on: "セツ", kun: "き.る", radicals: "Thất (七) + Đao (刀)", tipImg: "Bảy (七) con dao (刀) cắt.", tipSoundOn: "**Setsu** thiết.", tipSoundKun: "**Ki**ru cắt.", words: [{w:"親切 (しんせつ)", m:"Tốt bụng"}, {w:"切手 (きって)", m:"Tem"}] },
            "引": { hanviet: "DẪN", mean: "Kéo/Dẫn", on: "イン", kun: "ひ.く", radicals: "Cung (弓) + Côn (丨)", tipImg: "Cây cung (弓) thẳng (丨) cần kéo căng.", tipSoundOn: "**In** dẫn.", tipSoundKun: "**Hi**ku kéo/bị cảm.", words: [{w:"引きます (ひきます)", m:"Bị (cảm)/Kéo"}, {w:"引力 (いんりょく)", m:"Lực hấp dẫn"}] },
            "産": { hanviet: "SẢN", mean: "Sản xuất/Quà", on: "サン", kun: "う.む", radicals: "Lập (立) + Sinh (生)", tipImg: "Đứng (立) trên vách núi (厂) sinh (生) sản.", tipSoundOn: "**San** sản.", tipSoundKun: "**U**mu sinh.", words: [{w:"お土産 (おみやげ)", m:"Quà lưu niệm"}, {w:"生産 (せいさん)", m:"Sản xuất"}] },
            "給": { hanviet: "CẤP", mean: "Cung cấp/Lương", on: "キュウ", kun: "", radicals: "Mịch (糸) + Hợp (合)", tipImg: "Sợi chỉ (糸) hợp (合) lại để cung cấp.", tipSoundOn: "**Kyuu**ryou lương.", tipSoundKun: "", words: [{w:"給料 (きゅうりょう)", m:"Lương"}, {w:"供給 (きょうきゅう)", m:"Cung cấp"}] },
            "料": { hanviet: "LIỆU", mean: "Nguyên liệu/Phí", on: "リョウ", kun: "", radicals: "Mễ (米) + Đấu (斗)", tipImg: "Gạo (米) đong đấu (斗) làm liệu.", tipSoundOn: "**Ryou** liệu.", tipSoundKun: "", words: [{w:"給料 (きゅうりょう)", m:"Lương"}, {w:"料理 (りょうり)", m:"Món ăn"}] },
            "賞": { hanviet: "THƯỞNG", mean: "Giải thưởng", on: "ショウ", kun: "", radicals: "Bối (貝) + Thượng (尚)", tipImg: "Thượng (尚) đế ban tiền (貝) thưởng.", tipSoundOn: "**Shou** thưởng.", tipSoundKun: "", words: [{w:"賞金 (しょうきん)", m:"Tiền thưởng"}] },
            "忘": { hanviet: "VONG", mean: "Quên", on: "ボウ", kun: "わす.れる", radicals: "Vong (亡) + Tâm (心)", tipImg: "Tim (心) chết (亡) là quên.", tipSoundOn: "**Bou** vong.", tipSoundKun: "**Wasu**reru quên.", words: [{w:"忘年会 (ぼうねんかい)", m:"Tiệc tất niên"}, {w:"忘れます (わすれます)", m:"Quên"}] },
            "年": { hanviet: "NIÊN", mean: "Năm", on: "ネン", kun: "とし", radicals: "Can (干)", tipImg: "Người vác lúa hoạch định năm.", tipSoundOn: "**Nen** năm.", tipSoundKun: "**Toshi** tuổi.", words: [{w:"忘年会 (ぼうねんかい)", m:"Tiệc tất niên"}, {w:"去年 (きょねん)", m:"Năm ngoái"}] },
            "会": { hanviet: "HỘI", mean: "Gặp gỡ/Tiệc", on: "カイ", kun: "あ.う", radicals: "Nhân (人)", tipImg: "Hai người gặp nhau dưới mái nhà.", tipSoundOn: "**Kai** hội.", tipSoundKun: "**A**u gặp.", words: [{w:"忘年会 (ぼうねんかい)", m:"Tiệc tất niên"}, {w:"会社 (かいしゃ)", m:"Công ty"}] },
            "新": { hanviet: "TÂN", mean: "Mới", on: "シン", kun: "あたら.しい", radicals: "Lập (立) + Mộc (木) + Cân (斤)", tipImg: "Rìu (斤) đẽo cây (木) đứng (立).", tipSoundOn: "**Shin** tân.", tipSoundKun: "**Atara**shii mới.", words: [{w:"新年会 (しんねんかい)", m:"Tiệc tân niên"}, {w:"新しい (あたらしい)", m:"Mới"}] },
            "遊": { hanviet: "DU", mean: "Chơi", on: "ユウ", kun: "あそ.ぶ", radicals: "Xước (⻌) + Phương (方)", tipImg: "Trẻ con cầm cờ đi chơi.", tipSoundOn: "**Yuu** du.", tipSoundKun: "**Aso**bu chơi.", words: [{w:"遊園地 (ゆうえんち)", m:"Công viên giải trí"}, {w:"遊びます (あそびます)", m:"Chơi"}] },
            "園": { hanviet: "VIÊN", mean: "Vườn", on: "エン", kun: "その", radicals: "Vi (囗) + Viên (袁)", tipImg: "Đất (口) xa (袁) làm vườn.", tipSoundOn: "**En** viên.", tipSoundKun: "**Sono** vườn.", words: [{w:"遊園地 (ゆうえんち)", m:"Công viên giải trí"}, {w:"公園 (こうえん)", m:"Công viên"}] },
            "地": { hanviet: "ĐỊA", mean: "Đất", on: "チ, ジ", kun: "", radicals: "Thổ (土) + Dã (也)", tipImg: "Đất (土) có con bọ cạp (也).", tipSoundOn: "**Chi** địa.", tipSoundKun: "", words: [{w:"遊園地 (ゆうえんち)", m:"Công viên giải trí"}, {w:"地下 (ちか)", m:"Dưới đất"}] },
            "習": { hanviet: "TẬP", mean: "Học", on: "シュウ", kun: "なら.う", radicals: "Vũ (羽) + Bạch (白)", tipImg: "Chim non tập vỗ cánh trắng.", tipSoundOn: "**Shuu** tập.", tipSoundKun: "**Nara**u học.", words: [{w:"練習 (れんしゅう)", m:"Luyện tập"}, {w:"習います (ならいます)", m:"Học"}] },
            "復": { hanviet: "PHỤC", mean: "Lặp lại", on: "フク", kun: "", radicals: "Xích (彳) + Phục (复)", tipImg: "Đi (彳) lại (复) nhiều lần.", tipSoundOn: "**Fuku**shuu ôn tập.", tipSoundKun: "", words: [{w:"復習 (ふくしゅう)", m:"Ôn tập"}, {w:"回復 (かいふく)", m:"Hồi phục"}] },
            "予": { hanviet: "DỰ", mean: "Dự báo", on: "ヨ", kun: "", radicals: "Dự (予)", tipImg: "Cái mâu (矛) dự báo.", tipSoundOn: "**Yo**shuu chuẩn bị bài.", tipSoundKun: "", words: [{w:"予習 (よしゅう)", m:"Chuẩn bị bài"}, {w:"予約 (よやく)", m:"Đặt trước"}] },
            "覚": { hanviet: "GIÁC", mean: "Nhớ/Thức", on: "カク", kun: "おぼ.える", radicals: "Kiến (見)", tipImg: "Nhìn sáng suốt giác ngộ.", tipSoundOn: "**Kaku** giác.", tipSoundKun: "**Obo**eru nhớ.", words: [{w:"覚えます (おぼえます)", m:"Nhớ"}, {w:"感覚 (かんかく)", m:"Cảm giác"}] },
            "頑": { hanviet: "NGOAN", mean: "Ngoan cố/Cố gắng", on: "ガン", kun: "", radicals: "Nguyên (元) + Hiệt (頁)", tipImg: "Nguyên (元) cái đầu (頁) ngoan cường.", tipSoundOn: "**Gan**baru cố gắng.", tipSoundKun: "", words: [{w:"頑張ります (がんばります)", m:"Cố gắng"}] },
            "張": { hanviet: "TRƯƠNG", mean: "Kéo dài/Căng", on: "チョウ", kun: "は.る", radicals: "Cung (弓) + Trường (長)", tipImg: "Cung (弓) dài (長) căng ra.", tipSoundOn: "**Chou** trương.", tipSoundKun: "Gan**ba**ru cố lên.", words: [{w:"頑張ります (がんばります)", m:"Cố gắng"}, {w:"出張 (しゅっちょう)", m:"Công tác"}] },
            "乾": { hanviet: "CAN", mean: "Khô", on: "カン", kun: "かわ.く", radicals: "Thập (十) + Nhật (日) + Khất (乞)", tipImg: "Mặt trời (日) mười (十) người cầu (乞) khô.", tipSoundOn: "**Kan**pai cạn ly.", tipSoundKun: "**Kawa**ku khô.", words: [{w:"乾杯 (かんぱい)", m:"Cạn ly"}, {w:"乾く (かわく)", m:"Khô"}] },
            "杯": { hanviet: "BÔI", mean: "Cốc/Ly", on: "ハイ", kun: "さかずき", radicals: "Mộc (木) + Bất (不)", tipImg: "Cây (木) không (不) làm ly được.", tipSoundOn: "Kan**pai** ly.", tipSoundKun: "**Sakazuki** chén rượu.", words: [{w:"乾杯 (かんぱい)", m:"Cạn ly"}, {w:"一杯 (いっぱい)", m:"Một cốc/Đầy"}] },
            "一": { hanviet: "NHẤT", mean: "Một", on: "イチ", kun: "ひと", radicals: "Nhất (一)", tipImg: "Một ngón tay.", tipSoundOn: "**I**ssho cùng.", tipSoundKun: "**Hito** một.", words: [{w:"一緒に (いっしょに)", m:"Cùng nhau"}, {w:"一番 (いちばん)", m:"Số 1"}] },
            "緒": { hanviet: "TỰ", mean: "Cùng nhau/Dây", on: "ショ", kun: "お", radicals: "Mịch (糸) + Giả (者)", tipImg: "Sợi chỉ (糸) của người giả (者) làm dây.", tipSoundOn: "Is**sho** cùng.", tipSoundKun: "**O** dây.", words: [{w:"一緒に (いっしょに)", m:"Cùng nhau"}] },
            "空": { hanviet: "KHÔNG", mean: "Trống/Bầu trời", on: "クウ", kun: "そら", radicals: "Huyệt (穴) + Công (工)", tipImg: "Dưới hang thợ làm việc.", tipSoundOn: "**Kuu**kou sân bay.", tipSoundKun: "**Sora** bầu trời.", words: [{w:"空港 (くうこう)", m:"Sân bay"}, {w:"空気 (くうき)", m:"Không khí"}] },
            "港": { hanviet: "CẢNG", mean: "Cảng", on: "コウ", kun: "みなと", radicals: "Thủy (氵) + Cung (巷)", tipImg: "Nước (氵) ở ngõ (巷) là cảng.", tipSoundOn: "Kuu**kou** cảng.", tipSoundKun: "**Minato** cảng.", words: [{w:"空港 (くうこう)", m:"Sân bay"}, {w:"港 (みなと)", m:"Cảng"}] },
            "痛": { hanviet: "THỐNG", mean: "Đau", on: "ツウ", kun: "いた.い", radicals: "Nạch (疒) + Dũng (甬)", tipImg: "Bệnh (疒) thông (甬) suốt rất đau.", tipSoundOn: "**Tsuu** thống.", tipSoundKun: "**Ita**i đau.", words: [{w:"痛い (いたい)", m:"Đau"}, {w:"頭痛 (ずつう)", m:"Đau đầu"}] },
            "寝": { hanviet: "TẨM", mean: "Ngủ", on: "シン", kun: "ね.る", radicals: "Miên (宀)", tipImg: "Trong nhà cầm tấm phản đi ngủ.", tipSoundOn: "**Ne**bou ngủ nướng.", tipSoundKun: "**Ne**ru ngủ.", words: [{w:"寝坊 (ねぼう)", m:"Ngủ nướng"}, {w:"寝ます (ねます)", m:"Ngủ"}] },
            "坊": { hanviet: "PHƯỜNG", mean: "Phường/Trai", on: "ボウ", kun: "", radicals: "Thổ (土) + Phương (方)", tipImg: "Đất (土) phương (方) này là phường.", tipSoundOn: "Ne**bou** nướng.", tipSoundKun: "", words: [{w:"寝坊 (ねぼう)", m:"Ngủ nướng"}, {w:"赤ん坊 (あかんぼう)", m:"Em bé"}] },
            "遅": { hanviet: "TRÌ", mean: "Muộn", on: "チ", kun: "おく.れる", radicals: "Xước (⻌) + Tê (犀)", tipImg: "Con cừu (羊) đi (⻌) muộn.", tipSoundOn: "**Chi** trì.", tipSoundKun: "**Oku**reru muộn.", words: [{w:"遅れます (おくれます)", m:"Muộn"}, {w:"遅い (おそい)", m:"Chậm"}] },
            "手": { hanviet: "THỦ", mean: "Tay", on: "シュ", kun: "て", radicals: "Thủ (手)", tipImg: "Bàn tay.", tipSoundOn: "**Te**tsudau giúp.", tipSoundKun: "**Te** tay.", words: [{w:"手伝います (てつだいます)", m:"Giúp đỡ"}] },
            "伝": { hanviet: "TRUYỀN", mean: "Truyền đạt", on: "デン", kun: "つた.える", radicals: "Nhân (亻) + Vân (云)", tipImg: "Người truyền tin qua mây.", tipSoundOn: "Tetsu**dau** giúp.", tipSoundKun: "**Tsuta**eru truyền.", words: [{w:"手伝います (てつだいます)", m:"Giúp đỡ"}, {w:"伝えます (つたえます)", m:"Truyền đạt"}] },
            "呼": { hanviet: "HÔ", mean: "Gọi", on: "コ", kun: "よ.ぶ", radicals: "Khẩu (口) + Hô (乎)", tipImg: "Miệng (口) hô (乎) hào.", tipSoundOn: "**Ko** hô.", tipSoundKun: "**Yo**bu gọi.", words: [{w:"呼びます (よびます)", m:"Gọi"}, {w:"呼吸 (こきゅう)", m:"Hô hấp"}] },
            "持": { hanviet: "TRÌ", mean: "Cầm", on: "ジ", kun: "も.つ", radicals: "Thủ (扌) + Tự (寺)", tipImg: "Tay cầm đồ ở chùa.", tipSoundOn: "**Ji** trì.", tipSoundKun: "**Mo**tsu cầm.", words: [{w:"持ちます (もちます)", m:"Cầm"}, {w:"気持ち (きもち)", m:"Cảm giác"}] },
            "迎": { hanviet: "NGHÊNH", mean: "Đón", on: "ゲイ", kun: "むか.える", radicals: "Xước (⻌) + Ngang (卬)", tipImg: "Đi ngẩng đầu đón.", tipSoundOn: "**Gei** nghênh.", tipSoundKun: "**Muka**eru đón.", words: [{w:"迎えます (むかえます)", m:"Đón"}, {w:"歓迎 (かんげい)", m:"Hoan nghênh"}] },
            "禁": { hanviet: "CẤM", mean: "Cấm", on: "キン", kun: "", radicals: "Lâm (林) + Thị (示)", tipImg: "Rừng (林) cấm tế lễ (示).", tipSoundOn: "**Kin**en cấm.", tipSoundKun: "", words: [{w:"禁煙 (きんえん)", m:"Cấm hút thuốc"}, {w:"禁止 (きんし)", m:"Cấm"}] },
            "煙": { hanviet: "YÊN", mean: "Khói", on: "エン", kun: "けむり", radicals: "Hỏa (火) + Tây (西) + Thổ (土)", tipImg: "Lửa (火) đốt đất tây (西) bốc khói.", tipSoundOn: "Kin**en** khói.", tipSoundKun: "**Kemuri** khói.", words: [{w:"禁煙 (きんえん)", m:"Cấm hút thuốc"}, {w:"煙 (けむり)", m:"Khói"}] },
            "司": { hanviet: "TI", mean: "Quản lý", on: "シ", kun: "", radicals: "Khẩu (口)", tipImg: "Một (一) cái miệng (口) quản lý.", tipSoundOn: "Jou**shi** cấp trên.", tipSoundKun: "", words: [{w:"上司 (じょうし)", m:"Cấp trên"}, {w:"司会 (しかい)", m:"MC"}] },
            "符": { hanviet: "PHÙ", mean: "Phù hiệu", on: "フ", kun: "", radicals: "Trúc (竹) + Phó (付)", tipImg: "Trúc (竹) giao phó (付) làm phù hiệu.", tipSoundOn: "Kip**pu** vé.", tipSoundKun: "", words: [{w:"切符 (きっぷ)", m:"Vé"}, {w:"符号 (ふごう)", m:"Ký hiệu"}] },
            "封": { hanviet: "PHONG", mean: "Phong bì", on: "フウ", kun: "", radicals: "Khuê (圭) + Thốn (寸)", tipImg: "Hai mảnh đất (圭) thốn (寸) lại làm phong bì.", tipSoundOn: "**Fuu**tou phong bì.", tipSoundKun: "", words: [{w:"封筒 (ふうとう)", m:"Phong bì"}] },
            "筒": { hanviet: "ĐỒNG", mean: "Ống", on: "トウ", kun: "つつ", radicals: "Trúc (竹) + Đồng (同)", tipImg: "Trúc (竹) cùng (同) làm ống.", tipSoundOn: "Fuu**tou** ống.", tipSoundKun: "**Tsutsu** ống.", words: [{w:"封筒 (ふうとう)", m:"Phong bì"}, {w:"水筒 (すいとう)", m:"Bình nước"}] },
            "祭": { hanviet: "TẾ", mean: "Lễ hội", on: "サイ", kun: "まつ.り", radicals: "Kỳ (示)", tipImg: "Thịt (月) tay (又) tế lễ (示).", tipSoundOn: "**Sai** tế.", tipSoundKun: "O**matsu**ri lễ hội.", words: [{w:"お祭り (おまつり)", m:"Lễ hội"}, {w:"文化祭 (ぶんかさい)", m:"Lễ hội văn hóa"}] },
            "土": { hanviet: "THỔ", mean: "Đất", on: "ド", kun: "つち", radicals: "Thổ (土)", tipImg: "Cây mọc từ đất.", tipSoundOn: "**Do**youbi thứ bảy.", tipSoundKun: "**Tsuchi** đất.", words: [{w:"お土産 (おみやげ)", m:"Quà lưu niệm"}, {w:"土地 (とち)", m:"Đất đai"}] },
            "玉": { hanviet: "NGỌC", mean: "Ngọc/Tròn", on: "ギョク", kun: "たま", radicals: "Ngọc (玉)", tipImg: "Vua (王) cầm viên ngọc (丶).", tipSoundOn: "**Gyoku** ngọc.", tipSoundKun: "**Tama** hòn ngọc.", words: [{w:"お年玉 (おとしだま)", m:"Tiền mừng tuổi"}, {w:"玉ねぎ (たまねぎ)", m:"Hành tây"}] },
            "正": { hanviet: "CHÍNH", mean: "Đúng/Chính", on: "セイ, ショウ", kun: "ただ.しい", radicals: "Chỉ (止)", tipImg: "Dừng lại (止) ở vạch số 1 (一) là chính xác.", tipSoundOn: "O**shou**gatsu Tết.", tipSoundKun: "**Tada**shii đúng.", words: [{w:"お正月 (おしょうがつ)", m:"Tết"}, {w:"正しい (ただしい)", m:"Đúng"}] },
            "彼": { hanviet: "BỈ", mean: "Anh ấy", on: "ヒ", kun: "かれ", radicals: "Xích (彳)", tipImg: "Người (彳) kia (皮) là anh ấy.", tipSoundOn: "**Hi** bỉ.", tipSoundKun: "**Kare** anh ấy.", words: [{w:"彼氏 (かれし)", m:"Bạn trai"}, {w:"彼女 (かのじょ)", m:"Cô ấy"}] },
            "女": { hanviet: "NỮ", mean: "Phụ nữ", on: "ジョ", kun: "おんな", radicals: "Nữ (女)", tipImg: "Dáng người phụ nữ.", tipSoundOn: "Ka**no**jo cô ấy.", tipSoundKun: "**Onna** phụ nữ.", words: [{w:"彼女 (かのじょ)", m:"Bạn gái/Cô ấy"}, {w:"女性 (じょせい)", m:"Phụ nữ"}] },
            "恋": { hanviet: "LUYẾN", mean: "Yêu", on: "レン", kun: "こい", radicals: "Tâm (心)", tipImg: "Lời nói (亦) từ trái tim (心).", tipSoundOn: "**Ren**ai luyến ái.", tipSoundKun: "**Koi** người yêu.", words: [{w:"恋人 (こいびと)", m:"Người yêu"}, {w:"初恋 (はつこい)", m:"Mối tình đầu"}] },
            "氏": { hanviet: "THỊ", mean: "Họ/Tên", on: "シ", kun: "うじ", radicals: "Thị (氏)", tipImg: "Người cúi chào.", tipSoundOn: "Kare**shi** bạn trai.", tipSoundKun: "**Uji** họ.", words: [{w:"彼氏 (かれし)", m:"Bạn trai"}, {w:"氏名 (しめい)", m:"Họ tên"}] },
            "友": { hanviet: "HỮU", mean: "Bạn", on: "ユウ", kun: "とも", radicals: "Hựu (又)", tipImg: "Hai tay bắt nhau.", tipSoundOn: "**Yuu**jin bạn thân.", tipSoundKun: "**Tomo**dachi bạn bè.", words: [{w:"友人 (ゆうじん)", m:"Bạn thân"}, {w:"友達 (ともだち)", m:"Bạn bè"}] },
            "弁": { hanviet: "BIỆN", mean: "Biện luận/Cơm hộp", on: "ベン", kun: "", radicals: "Củng (廾)", tipImg: "Hai tay (廾) nâng mũ (厶).", tipSoundOn: "**Ben**tou cơm hộp.", tipSoundKun: "", words: [{w:"お弁当 (おべんとう)", m:"Cơm hộp"}, {w:"弁護士 (べんごし)", m:"Luật sư"}] },
            "当": { hanviet: "ĐƯƠNG", mean: "Trúng/Đúng", on: "トウ", kun: "あ.たる", radicals: "Tiểu (小)", tipImg: "Tòa nhà (⺌) có cái chổi (彐) quét (đương nhiên).", tipSoundOn: "Oben**tou** cơm hộp.", tipSoundKun: "**A**taru trúng.", words: [{w:"お弁当 (おべんとう)", m:"Cơm hộp"}, {w:"本当 (ほんとう)", m:"Thật sự"}] },
            "茶": { hanviet: "TRÀ", mean: "Trà", on: "チャ, サ", kun: "", radicals: "Thảo (艹)", tipImg: "Người (人) hái trà (艹) trên cây (木).", tipSoundOn: "O**cha** trà.", tipSoundKun: "", words: [{w:"お茶 (おちゃ)", m:"Trà"}, {w:"茶色 (ちゃいろ)", m:"Màu nâu"}] },
            "紹": { hanviet: "THIỆU", mean: "Giới thiệu", on: "ショウ", kun: "", radicals: "Mịch (糸)", tipImg: "Sợi chỉ (糸) mời gọi (召).", tipSoundOn: "**Shou**kai giới thiệu.", tipSoundKun: "", words: [{w:"紹介 (しょうかい)", m:"Giới thiệu"}] },
            "介": { hanviet: "GIỚI", mean: "Ở giữa/Giới thiệu", on: "カイ", kun: "", radicals: "Nhân (人)", tipImg: "Người (人) đứng giữa hai vạch (||).", tipSoundOn: "Shou**kai** giới thiệu.", tipSoundKun: "", words: [{w:"紹介 (しょうかい)", m:"Giới thiệu"}, {w:"介入 (かいにゅう)", m:"Can thiệp"}] },
            "案": { hanviet: "ÁN", mean: "Đề án/Hướng dẫn", on: "アン", kun: "", radicals: "Mộc (木)", tipImg: "Người phụ nữ (女) an (安) tâm dưới cây (木).", tipSoundOn: "**An**nai hướng dẫn.", tipSoundKun: "", words: [{w:"案内 (あんない)", m:"Hướng dẫn"}, {w:"名案 (めいあん)", m:"Ý kiến hay"}] },
            "内": { hanviet: "NỘI", mean: "Bên trong", on: "ナイ", kun: "うち", radicals: "Quynh (冂)", tipImg: "Người (人) ở trong nhà (冂).", tipSoundOn: "An**nai** hướng dẫn.", tipSoundKun: "**Uchi** trong.", words: [{w:"案内 (あんない)", m:"Hướng dẫn"}, {w:"内容 (ないよう)", m:"Nội dung"}] },
            "作": { hanviet: "TÁC", mean: "Làm/Chế tạo", on: "サク", kun: "つく.る", radicals: "Nhân (亻)", tipImg: "Người (亻) làm việc (乍).", tipSoundOn: "**Saku**bun tập làm văn.", tipSoundKun: "**Tsuku**ru làm.", words: [{w:"作ります (つくります)", m:"Làm/Chế tạo"}, {w:"作家 (さっか)", m:"Tác giả"}] },
            "返": { hanviet: "PHẢN", mean: "Trả lại", on: "ヘン", kun: "かえ.す", radicals: "Xước (⻌)", tipImg: "Phản (反) đối rồi bỏ đi (⻌).", tipSoundOn: "**Hen**ji phản hồi.", tipSoundKun: "**Kae**su trả lại.", words: [{w:"返事 (へんじ)", m:"Trả lời"}, {w:"返します (かえします)", m:"Trả lại"}] },
            "漢": { hanviet: "HÁN", mean: "Hán", on: "カン", kun: "", radicals: "Thủy (氵)", tipImg: "Nước (氵) và đất sét (革) phơi khô (大).", tipSoundOn: "**Kan**ji hán tự.", tipSoundKun: "", words: [{w:"漢字 (かんじ)", m:"Chữ Hán"}] },
            "字": { hanviet: "TỰ", mean: "Chữ", on: "ジ", kun: "あざ", radicals: "Miên (宀)", tipImg: "Đứa trẻ (子) học chữ trong nhà (宀).", tipSoundOn: "Kan**ji** chữ hán.", tipSoundKun: "**Aza** chữ cái.", words: [{w:"漢字 (かんじ)", m:"Chữ Hán"}, {w:"文字 (もじ)", m:"Ký tự"}] },
            "場": { hanviet: "TRƯỜNG", mean: "Nơi chốn", on: "ジョウ", kun: "ば", radicals: "Thổ (土)", tipImg: "Đất (土) có mặt trời (昜) chiếu là nơi tốt.", tipSoundOn: "Ski-**jou** bãi trượt tuyết.", tipSoundKun: "**Ba** chỗ.", words: [{w:"スキー場 (スキーじょう)", m:"Khu trượt tuyết"}, {w:"場所 (ばしょ)", m:"Nơi chốn"}] },
            "焼": { hanviet: "THIÊU", mean: "Nướng", on: "ショウ", kun: "や.く", radicals: "Hỏa (火)", tipImg: "Lửa (火) đốt vua (堯).", tipSoundOn: "Nen**shou** đốt cháy.", tipSoundKun: "Suki**ya**ki lẩu nướng.", words: [{w:"すき焼き (すきやき)", m:"Lẩu Sukiyaki"}, {w:"焼肉 (やきにく)", m:"Thịt nướng"}] },
            "練": { hanviet: "LUYỆN", mean: "Luyện tập", on: "レン", kun: "ね.る", radicals: "Mịch (糸)", tipImg: "Sợi chỉ (糸) phía đông (東) được rèn luyện.", tipSoundOn: "**Ren**shuu luyện tập.", tipSoundKun: "**Ne**ru nhào nặn.", words: [{w:"練習 (れんしゅう)", m:"Luyện tập"}] },
            "上": { hanviet: "THƯỢNG", mean: "Trên", on: "ジョウ", kun: "うえ", radicals: "Nhất (一)", tipImg: "Chỉ lên trên.", tipSoundOn: "**Jou**shi cấp trên.", tipSoundKun: "**Ue** trên.", words: [{w:"上司 (じょうし)", m:"Cấp trên"}, {w:"上がる (あがる)", m:"Đi lên"}] },
            "花": { hanviet: "HOA", mean: "Hoa", on: "カ", kun: "はな", radicals: "Thảo (艹)", tipImg: "Cỏ (艹) hóa (化) thành hoa.", tipSoundOn: "**Ka**bin bình hoa.", tipSoundKun: "**Hana**bi pháo hoa.", words: [{w:"花火 (はなび)", m:"Pháo hoa"}, {w:"花見 (はなみ)", m:"Ngắm hoa"}] },
            "火": { hanviet: "HỎA", mean: "Lửa", on: "カ", kun: "ひ", radicals: "Hỏa (火)", tipImg: "Ngọn lửa đang cháy.", tipSoundOn: "**Ka**yobi thứ ba.", tipSoundKun: "Hana**bi** pháo hoa.", words: [{w:"花火 (はなび)", m:"Pháo hoa"}, {w:"火 (ひ)", m:"Lửa"}] }
        };

        // --- 4. APP LOGIC (Standard Day 1 Logic) ---
        let currentIndex = 0; 
        let currentQuizItem = null; 
        let score = 0; 
        let currentStrokeSvg = null;

        function init() {
            renderList();
            renderGrammarMenu();
            loadWord(0);
            
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', e => { 
                    const t = e.target.value.toLowerCase(); 
                    document.querySelectorAll('.vocab-item').forEach(el => el.style.display = el.innerText.toLowerCase().includes(t) ? 'block' : 'none'); 
                });
            }

            const mobileSearchInput = document.getElementById('mobileSearchInput');
            if (mobileSearchInput) {
                mobileSearchInput.addEventListener('input', e => { 
                    const t = e.target.value.toLowerCase(); 
                    document.querySelectorAll('.vocab-item').forEach(el => el.style.display = el.innerText.toLowerCase().includes(t) ? 'block' : 'none'); 
                });
            }

            const quizInput = document.getElementById('quiz-input');
            if (quizInput) {
                quizInput.addEventListener('keypress', e => { if(e.key === 'Enter') checkAnswer(); });
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            document.getElementById('learn-section').classList.toggle('hidden', tab !== 'learn');
            document.getElementById('quiz-section').classList.toggle('hidden', tab !== 'quiz');
            if(tab === 'quiz') nextQuestion();
        }

        function renderList() {
            const listD = document.getElementById('vocabList'); 
            const listM = document.getElementById('mobileVocabList');
            const html = vocabData.map((item, i) => `
                <div class="vocab-item p-3 border-b hover:bg-gray-50 cursor-pointer rounded-lg mx-1 my-1" data-index="${i}" onclick="loadWord(${i}); if(window.innerWidth < 768) toggleDrawer();">
                    <div class="flex justify-between font-bold items-center">
                        <span class="text-gray-800 ja-text">${item.Kanji || item.Furigana}</span>
                        <span class="text-gray-300 text-xs font-mono">#${item.STT}</span>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 truncate">${item.Nghĩa}</div>
                </div>`).join('');
            if (listD) listD.innerHTML = html;
            if (listM) listM.innerHTML = html;
        }

        function loadWord(idx) {
            currentIndex = idx; 
            const word = vocabData[idx];
            document.querySelectorAll('.vocab-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll(`.vocab-item[data-index="${idx}"]`).forEach(el => el.classList.add('active'));
            
            const activeItem = document.querySelector(`.vocab-item[data-index="${idx}"]`);
            if (activeItem) activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            document.getElementById('headerProgress').innerText = `${idx+1}/${vocabData.length}`;
            document.getElementById('wordIndex').innerText = `#${word.STT}`;
            document.getElementById('cardKanji').innerText = word.Kanji || word.Furigana;
            document.getElementById('cardFurigana').innerText = word.Furigana;
            document.getElementById('cardMeaning').innerText = word.Nghĩa;
            document.getElementById('wordType').innerText = word.type.toUpperCase();
            
            const hasKanji = word.Kanji && word.Kanji !== word.Furigana;
            document.getElementById('strokeBtn').classList.toggle('hidden', !hasKanji);
            
            renderShadowing(word);
        }

        function renderShadowing(word) {
            const cont = document.getElementById('sentenceList'); 
            cont.innerHTML = '';
            
            if(!word.conv) { 
                document.getElementById('emptyState').classList.remove('hidden'); 
                return; 
            }
            document.getElementById('emptyState').classList.add('hidden');
            
            const types = [
                { k:'polite', l:'Lịch sự', m:word.conv.pVi, i:'user-tie', c:'indigo' }, 
                { k:'casual', l:'Thân mật', m:word.conv.cVi, i:'comments', c:'pink' }
            ];
            
            types.forEach(t => {
                const grammarBtn = word.conv.gIds && word.conv.gIds.length > 0 
                    ? `<button onclick="openExplan('${word.conv.gIds.join(',')}')" class="text-xs text-indigo-500 hover:text-indigo-700 font-bold px-2 py-1 rounded hover:bg-indigo-50 transition"><i class="fas fa-info-circle"></i> Ngữ pháp</button>`
                    : '';

                cont.innerHTML += `
                    <div class="shadow-card bg-white rounded-2xl p-4 border border-gray-100">
                        <div class="flex justify-between border-b border-gray-100 pb-2 mb-3">
                            <div class="flex gap-2 items-center">
                                <div class="bg-${t.c}-50 p-1.5 rounded text-${t.c}-600"><i class="fas fa-${t.i}"></i></div>
                                <span class="text-xs font-bold text-gray-400 uppercase tracking-wide">${t.l}</span>
                            </div>
                            ${grammarBtn}
                        </div>
                        <div class="flex justify-between items-start gap-3">
                            <div>
                                <div class="text-lg md:text-xl ja-text font-medium text-gray-800 mb-1 cursor-pointer hover:text-indigo-600 transition-colors" onclick="speakText('${word.conv[t.k]}')">${word.conv[t.k]}</div>
                                <div class="text-sm text-gray-500 italic">${t.m}</div>
                            </div>
                            <button onclick="speakText('${word.conv[t.k]}')" class="audio-btn text-${t.c}-400 hover:text-${t.c}-600 p-2 rounded-full hover:bg-${t.c}-50 transition-colors flex-shrink-0">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                        </div>
                    </div>`;
            });
        }

        function openExplan(idsStr) {
            const ids = idsStr.split(','); 
            const f = document.getElementById('dgFormula'); 
            const e = document.getElementById('dgExplanation');
            
            f.innerText = ids.map(id => grammarRepo[id] ? grammarRepo[id].formula : "N/A").join("  /  ");
            e.innerHTML = ids.map(id => {
                if (!grammarRepo[id]) return `<div class="text-red-500">Missing grammar: ${id}</div>`;
                return `
                <div class="pb-2 border-b border-gray-100 last:border-0">
                    <strong class="text-indigo-700 block mb-1">${grammarRepo[id].title} <span class="text-xs font-normal text-gray-400">(${grammarRepo[id].desc.split(':')[0]})</span></strong>
                    <p>${grammarRepo[id].desc.split(':').slice(1).join(':') || grammarRepo[id].desc}</p>
                    <p class="text-xs text-gray-400 mt-1 italic">Vd: ${grammarRepo[id].ex}</p>
                </div>`;
            }).join("");
            
            showModal('detailGrammarModal');
        }

        function renderGrammarMenu() {
            const grid = document.getElementById('grammarGrid'); 
            grid.innerHTML = '';
            Object.keys(grammarRepo).forEach(key => {
                const r = grammarRepo[key];
                grid.innerHTML += `
                    <div class="bg-white p-4 rounded-xl border border-gray-100 flex flex-col justify-between hover:shadow-md transition cursor-pointer" onclick="speakText('${r.ex}')">
                        <div>
                            <div class="font-bold text-sm text-indigo-600 mb-1 flex items-center gap-2"><i class="fas fa-tag text-xs"></i> ${r.title}</div>
                            <code class="text-xs block bg-gray-50 p-1.5 rounded mb-2 border border-gray-200 font-mono text-gray-700">${r.formula}</code>
                            <p class="text-xs text-gray-500 mb-2 line-clamp-2">${r.desc}</p>
                        </div>
                        <div class="bg-indigo-50 p-2 rounded flex justify-between items-center gap-2 mt-2">
                            <span class="text-[11px] font-medium text-indigo-800 ja-text truncate">${r.ex}</span>
                            <i class="fas fa-volume-up text-indigo-400 text-xs"></i>
                        </div>
                    </div>`;
            });
        }

        function showModal(id) { 
            const modal = document.getElementById(id);
            modal.classList.remove('hidden'); 
            setTimeout(() => { 
                document.getElementById(id.replace('Modal','Backdrop')).classList.remove('opacity-0'); 
                document.getElementById(id.replace('Modal','Panel')).classList.remove('opacity-0', 'scale-95'); 
            }, 10); 
        }
        function closeModal(id) { 
            const b = document.getElementById(id.replace('Modal','Backdrop')); 
            const p = document.getElementById(id.replace('Modal','Panel'));
            if(b) b.classList.add('opacity-0'); 
            if(p) p.classList.add('opacity-0', 'scale-95');
            setTimeout(() => document.getElementById(id).classList.add('hidden'), 200); 
        }
        function openGrammarList() { showModal('grammarListModal'); }

        async function openStrokeModal(char) {
            const word = vocabData[currentIndex]; 
            const kanjis = word.Kanji.match(/[\u4e00-\u9faf]/g) || [];
            if(kanjis.length === 0) return;
            const target = char || kanjis[0];
            const tabs = document.getElementById('strokeTabs'); 
            tabs.innerHTML = '';
            if(kanjis.length > 1) {
                kanjis.forEach(k => {
                    const b = document.createElement('button'); 
                    b.innerText = k;
                    b.className = `w-12 h-12 text-xl rounded-xl font-bold border transition ja-text ${k===target ? 'bg-pink-600 text-white border-pink-600 shadow-lg' : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'}`;
                    b.onclick = () => showKanjiStroke(k); 
                    tabs.appendChild(b);
                });
            }
            showModal('strokeModal'); 
            await showKanjiStroke(target);
        }

        async function showKanjiStroke(k) {
            const d = kanjiDetails[k]; 
            const c = document.getElementById('kanjiDetailContent'); 
            const e = document.getElementById('kanjiDetailEmpty');
            if(d) {
                c.classList.remove('hidden'); e.classList.add('hidden');
                document.getElementById('detailKanji').innerText = k; 
                document.getElementById('detailHanViet').innerText = d.hanviet || '?';
                document.getElementById('detailMeaning').innerText = d.mean || ''; 
                document.getElementById('detailOn').innerText = d.on || '-'; 
                document.getElementById('detailKun').innerText = d.kun || '-';
                document.getElementById('detailRadicals').innerText = d.radicals || '...';
                
                const fmt = s => s.replace(/\*\*(.*?)\*\*/g, '<span class="font-bold text-gray-900">$1</span>');
                document.getElementById('detailTipImg').innerHTML = fmt(d.tipImg || ''); 
                document.getElementById('detailTipSoundOn').innerHTML = fmt(d.tipSoundOn || ''); 
                document.getElementById('detailTipSoundKun').innerHTML = fmt(d.tipSoundKun || '');
                
                document.getElementById('btnPlayOn').onclick = () => speakText(d.on);
                document.getElementById('btnPlayKun').onclick = () => speakText(d.kun);

                const wc = document.getElementById('detailWords'); 
                wc.innerHTML = '';
                if(d.words) {
                    d.words.forEach(w => wc.innerHTML += `<div class="flex justify-between items-center bg-gray-50 p-2 rounded hover:bg-gray-100 cursor-pointer border border-transparent hover:border-gray-200 transition" onclick="speakText('${w.w}')"><span class="text-lg font-bold text-indigo-700 ja-text">${w.w}</span><span class="text-xs text-gray-500 font-medium">${w.m}</span></div>`);
                }
            } else { 
                c.classList.add('hidden'); e.classList.remove('hidden'); 
            }
            const anim = document.getElementById('strokeAnimContainer'); 
            const grid = document.getElementById('strokeGridContainer');
            anim.innerHTML = '<i class="fas fa-spinner fa-spin text-gray-300 text-2xl"></i>'; 
            grid.innerHTML = '';
            try {
                const r = await fetch(`https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg/kanji/${getKanjiHex(k)}.svg`);
                if(!r.ok) throw new Error();
                const svgText = await r.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(svgText, "image/svg+xml");
                doc.querySelectorAll('path').forEach(p => p.setAttribute('style', 'opacity:0; stroke:#333; stroke-width:3; fill:none; stroke-linecap:round; stroke-linejoin:round;')); 
                anim.innerHTML = new XMLSerializer().serializeToString(doc.documentElement);
                const mainSvg = anim.querySelector('svg');
                mainSvg.setAttribute('width','100%'); mainSvg.setAttribute('height','100%');
                currentStrokeSvg = mainSvg;
                replayStrokeAnimation();
                const cleanDoc = parser.parseFromString(svgText, "image/svg+xml"); 
                cleanDoc.querySelectorAll('path').forEach((p, i) => {
                    const b = document.createElement('div'); 
                    b.className = "w-16 h-16 stroke-grid-box flex items-center justify-center rounded bg-white shadow-sm";
                    const clone = cleanDoc.documentElement.cloneNode(true);
                    clone.setAttribute('width','100%'); clone.setAttribute('height','100%');
                    clone.querySelectorAll('path').forEach((pp, idx) => {
                        pp.style.fill="none"; pp.style.strokeLinecap="round"; pp.style.strokeLinejoin="round";
                        if(idx<i) { pp.style.stroke="#e5e7eb"; pp.style.strokeWidth="3"; }
                        else if(idx===i) { pp.style.stroke="#db2777"; pp.style.strokeWidth="4"; } 
                        else pp.style.display="none";
                    });
                    b.appendChild(clone); grid.appendChild(b);
                });
            } catch(e) { anim.innerHTML = "<span class='text-xs text-red-400'>Lỗi tải nét viết</span>"; }
        }

        function replayStrokeAnimation() {
            if(!currentStrokeSvg) return;
            const paths = currentStrokeSvg.querySelectorAll('path');
            paths.forEach(p => { p.style.transition='none'; p.style.opacity='0'; });
            void currentStrokeSvg.offsetWidth;
            let delay = 0;
            paths.forEach(p => {
                const len = p.getTotalLength();
                p.style.strokeDasharray = len; p.style.strokeDashoffset = len; p.style.opacity = '1';
                setTimeout(() => { p.style.transition = `stroke-dashoffset 0.6s ease-in-out`; p.style.strokeDashoffset = '0'; }, delay * 1000);
                delay += 0.6;
            });
        }

        function getKanjiHex(k) { return k.charCodeAt(0).toString(16).padStart(5, '0'); }
        function speakText(t) { if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(t); u.lang = 'ja-JP'; u.rate = 0.9; speechSynthesis.speak(u); } }
        function speakCurrent() { speakText(vocabData[currentIndex].Furigana); }
        function toggleDrawer() { const d = document.getElementById('mobileDrawer'); const c = document.getElementById('drawerContent'); const b = document.getElementById('drawerBackdrop'); if(d.classList.contains('pointer-events-none')) { d.classList.remove('pointer-events-none'); c.classList.remove('-translate-x-full'); b.classList.remove('opacity-0'); } else { c.classList.add('-translate-x-full'); b.classList.add('opacity-0'); setTimeout(() => d.classList.add('pointer-events-none'), 300); } }

        function nextQuestion() {
            document.getElementById('feedback-area').classList.add('hidden'); document.getElementById('btn-check').classList.remove('hidden'); document.getElementById('btn-next').classList.add('hidden');
            document.getElementById('quiz-kanji').className = "text-6xl ja-text font-bold text-gray-800 mb-4 transition-all inline-block";
            const inp = document.getElementById('quiz-input'); inp.value = ''; inp.disabled = false; inp.focus();
            const valid = vocabData.filter(v => v.Furigana !== "...");
            currentQuizItem = valid[Math.floor(Math.random() * valid.length)];
            document.getElementById('quiz-kanji').innerText = currentQuizItem.Kanji || currentQuizItem.Furigana;
            document.getElementById('quiz-meaning').innerText = currentQuizItem.Nghĩa;
        }
        function checkAnswer() {
            const inp = document.getElementById('quiz-input'); if(!inp.value.trim()) return;
            inp.disabled = true; 
            const correct = inp.value.trim() === currentQuizItem.Furigana;
            const k = document.getElementById('quiz-kanji'); const fbTitle = document.getElementById('feedback-title'); const fbArea = document.getElementById('feedback-area');
            if(correct) { 
                score += 10; k.classList.add("text-green-600", "correct-anim"); 
                fbTitle.innerHTML = '<span class="text-green-600"><i class="fas fa-check-circle mr-2"></i> Chính xác!</span>';
                fbArea.className = fbArea.className.replace("bg-red-50 border-red-200", "") + " bg-green-50 border-green-200";
                speakText(currentQuizItem.Furigana); 
            } else { 
                score = Math.max(0, score - 5); k.classList.add("text-red-500", "wrong-anim"); 
                fbTitle.innerHTML = '<span class="text-red-600"><i class="fas fa-times-circle mr-2"></i> Sai rồi!</span>';
                fbArea.className = fbArea.className.replace("bg-green-50 border-green-200", "") + " bg-red-50 border-red-200";
            }
            document.getElementById('score-display').innerText = score; document.getElementById('correct-answer').innerText = currentQuizItem.Furigana;
            document.getElementById('feedback-area').classList.remove('hidden'); document.getElementById('btn-check').classList.add('hidden'); document.getElementById('btn-next').classList.remove('hidden');
        }
        function playQuizAudio() { if(currentQuizItem) speakText(currentQuizItem.Furigana); }
        function prevWord() { if(currentIndex > 0) loadWord(currentIndex - 1); }
        function nextWord() { if(currentIndex < vocabData.length - 1) loadWord(currentIndex + 1); }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
