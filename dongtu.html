<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AzaKanji - ƒê·ªông T·ª´ & Ng·ªØ Ph√°p N5-N3 (Final Debug)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; background-color: #f3f4f6; }
        .kanji-font { font-family: 'Noto Sans JP', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #9ca3af; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .modal-enter { animation: modalIn 0.3s ease-out forwards; }
        @keyframes modalIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .correct-anim { animation: bounce 0.5s; }
        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .wrong-anim { animation: shake 0.5s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        /* --- STROKE ORDER STYLES (NEW) --- */
        .stroke-path {
            fill: none;
            stroke: #333;
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .stroke-grid-box {
            border: 1px solid #e5e7eb;
            background-color: white;
            position: relative;
        }
        /* Dotted lines for kanji grid */
        .stroke-grid-box::after {
            content: ''; position: absolute; top: 0; left: 50%; width: 1px; height: 100%;
            background: repeating-linear-gradient(to bottom, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); z-index: 0;
        }
        .stroke-grid-box::before {
            content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px;
            background: repeating-linear-gradient(to right, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); z-index: 0;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-indigo-700 text-white shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="flex items-center space-x-3 cursor-pointer" onclick="location.reload()">
                    <i class="fas fa-torii-gate text-3xl text-pink-300"></i>
                    <div>
                        <h1 class="text-xl font-bold uppercase tracking-wider">AzaKanji Dojo</h1>
                        <p class="text-xs text-indigo-200">109 ƒê·ªông T·ª´ - V√≠ d·ª• Chu·∫©n Ng·ªØ Ph√°p JLPT</p>
                    </div>
                </div>
                <div class="flex bg-indigo-900 rounded-lg p-1 overflow-x-auto">
                    <button onclick="switchTab('learn')" id="tab-learn" class="px-4 py-2 rounded-md text-sm font-bold transition bg-white text-indigo-900 shadow whitespace-nowrap">
                        <i class="fas fa-book-open mr-2"></i>H·ªçc T·ª´
                    </button>
                     <a href="https://tiengnhatsieutoc.com/fcdongtu.html" class="px-4 py-2 rounded-md text-sm font-bold transition whitespace-nowrap flex items-center hover:bg-sky-600 ml-1">
                            <i class="fas fa-home mr-2"></i>FlashCard
                        </a>
                    <button onclick="switchTab('quiz')" id="tab-quiz" class="px-4 py-2 rounded-md text-sm font-bold transition text-indigo-300 hover:text-white whitespace-nowrap">
                        <i class="fas fa-keyboard mr-2"></i>Ki·ªÉm Tra
                    </button>
                    <button onclick="openGrammarModal()" class="px-4 py-2 rounded-md text-sm font-bold transition text-indigo-300 hover:text-white whitespace-nowrap border-l border-indigo-700 ml-1">
                        <i class="fas fa-book mr-2"></i>Ng·ªØ Ph√°p
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 flex-grow relative z-0" id="app-container">
        <div id="learn-section" class="fade-in"><div id="content-area" class="space-y-8"></div></div>
        <div id="quiz-section" class="hidden fade-in max-w-2xl mx-auto">
            <!-- Quiz UI -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white flex justify-between items-center">
                    <div><h2 class="text-2xl font-bold">Th·ª≠ Th√°ch Kanji</h2><p class="text-indigo-100 text-sm">Nh√¨n Kanji - G√µ Hiragana</p></div>
                    <div class="text-right"><div class="text-xs text-indigo-200 uppercase font-bold">ƒêi·ªÉm s·ªë</div><div class="text-4xl font-bold" id="score-display">0</div></div>
                </div>
                <div class="p-8 text-center">
                    <div class="mb-8">
                        <div class="text-sm text-gray-500 mb-2 uppercase tracking-wide font-bold">T·ª´ n√†y ƒë·ªçc l√† g√¨?</div>
                        <div id="quiz-kanji" class="text-6xl kanji-font font-bold text-gray-800 mb-4 transition-all"></div>
                        <div id="quiz-meaning" class="text-xl text-indigo-600 font-bold mb-2"></div>
                    </div>
                    <div class="relative max-w-md mx-auto mb-6">
                        <input type="text" id="quiz-input" class="w-full text-center text-2xl p-4 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:outline-none transition kanji-font" placeholder="Nh·∫≠p Hiragana" autocomplete="off">
                    </div>
                    <div id="feedback-area" class="hidden rounded-xl p-4 bg-gray-50 border border-gray-200 text-left mb-6">
                        <div id="feedback-title" class="font-bold text-lg mb-2 flex items-center"></div>
                        <div class="text-gray-700 mb-2">ƒê√°p √°n: <span id="correct-answer" class="font-bold text-xl text-indigo-600 mx-2 kanji-font"></span><button onclick="playCurrentAudio()" class="text-gray-500 hover:text-indigo-600"><i class="fas fa-volume-up"></i></button></div>
                        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200 text-sm text-gray-800"><div class="font-bold text-yellow-800 mb-1"><i class="fas fa-lightbulb mr-1"></i> M·∫πo ghi nh·ªõ:</div><div id="quiz-tip-img" class="mb-1"></div><div id="quiz-tip-sound"></div></div>
                    </div>
                    <div>
                        <button id="btn-check" onclick="checkAnswer()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition active:scale-95 text-lg">Ki·ªÉm Tra</button>
                        <button id="btn-next" onclick="nextQuestion()" class="hidden w-full md:w-auto bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition active:scale-95 text-lg">C√¢u Ti·∫øp Theo <i class="fas fa-arrow-right ml-2"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- MODAL (Conjugation) -->
    <div id="conjugation-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="closeModal()"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full modal-enter">
                <div class="bg-indigo-700 px-4 py-4 sm:px-6 flex justify-between items-center text-white">
                    <div><h3 class="text-lg leading-6 font-bold" id="modal-title">Chia Th·ªÉ & Ng·ªØ C·∫£nh</h3><p class="text-indigo-200 text-xs">V√≠ d·ª• ƒëa d·∫°ng (N5-N3)</p></div>
                    <button onclick="closeModal()" class="text-indigo-200 hover:text-white focus:outline-none"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div class="bg-gray-50 px-4 py-5 sm:p-6 max-h-[70vh] overflow-y-auto">
                    <div class="flex items-center mb-6 bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                        <div class="text-5xl kanji-font font-bold text-indigo-600 mr-4" id="modal-kanji"></div>
                        <div>
                            <div class="text-2xl font-bold text-gray-800" id="modal-hiragana"></div>
                            <div class="text-sm text-gray-500 font-bold uppercase tracking-wide" id="modal-group"></div>
                            <div class="text-lg text-gray-700" id="modal-meaning"></div>
                        </div>
                        <button id="modal-main-audio" class="ml-auto bg-indigo-50 text-indigo-600 p-3 rounded-full hover:bg-indigo-100 transition shadow-sm"><i class="fas fa-volume-up text-xl"></i></button>
                    </div>
                    <div class="space-y-4" id="conjugation-list"></div>
                </div>
                <div class="bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm" onclick="closeModal()">ƒê√≥ng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL (Stroke Order) - NEW -->
    <div id="stroke-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="closeStrokeModal()"></div>
            <div class="inline-block align-bottom bg-white rounded-xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full modal-enter relative">
                <div class="bg-pink-600 px-4 py-3 flex justify-between items-center text-white">
                    <h3 class="font-bold text-lg"><i class="fas fa-pen-nib mr-2"></i>T·∫≠p Vi·∫øt Kanji: <span id="stroke-modal-char" class="text-2xl ml-2"></span></h3>
                    <button onclick="closeStrokeModal()" class="hover:text-gray-200"><i class="fas fa-times text-xl"></i></button>
                </div>
                <div class="p-6 bg-gray-50 max-h-[80vh] overflow-y-auto">
                    <div class="flex flex-col md:flex-row gap-8 items-start justify-center">
                        <!-- Animation Box -->
                        <div class="bg-white p-4 rounded-lg shadow border border-gray-200 text-center">
                            <p class="text-sm text-gray-500 mb-2 font-bold uppercase">M√¥ ph·ªèng n√©t vi·∫øt</p>
                            <div id="stroke-animation-container" class="w-40 h-40 mx-auto bg-white border border-gray-300 relative stroke-grid-box flex items-center justify-center">
                                <span class="text-xs text-gray-400">ƒêang t·∫£i...</span>
                            </div>
                            <button onclick="replayStrokeAnimation()" class="mt-3 text-sm bg-pink-100 text-pink-700 px-3 py-1 rounded hover:bg-pink-200 transition font-bold"><i class="fas fa-redo mr-1"></i> Vi·∫øt l·∫°i</button>
                        </div>
                        
                        <!-- Grid Breakdown -->
                        <div class="flex-1">
                            <p class="text-sm text-gray-500 mb-3 font-bold uppercase">Th·ª© t·ª± t·ª´ng n√©t</p>
                            <div id="stroke-grid-container" class="flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GRAMMAR RULES MODAL -->
    <div id="grammar-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="closeGrammarModal()"></div>
            <div class="inline-block align-bottom bg-white rounded-xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full modal-enter relative">
                <button onclick="closeGrammarModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none z-10"><i class="fas fa-times text-2xl"></i></button>
                <div class="bg-white px-6 py-8 sm:p-8 max-h-[85vh] overflow-y-auto">
                    <h2 class="text-3xl font-extrabold text-indigo-700 mb-2 text-center"><i class="fas fa-book-reader mr-2"></i>Quy T·∫Øc Chia ƒê·ªông T·ª´ Ti·∫øng Nh·∫≠t</h2>
                    <p class="text-center text-gray-500 mb-6 text-sm">T·ªïng h·ª£p c√°ch chia 3 nh√≥m ƒë·ªông t·ª´ t·ª´ N5 ƒë·∫øn N3</p>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 text-sm">
                        <!-- Group 1 -->
                        <div class="bg-blue-50 rounded-xl border border-blue-200 shadow-sm overflow-hidden">
                            <div class="bg-blue-100 p-3 border-b border-blue-200">
                                <h3 class="text-lg font-bold text-blue-800 flex items-center justify-center"><span class="bg-blue-600 text-white rounded w-6 h-6 flex items-center justify-center mr-2 text-xs">1</span>Nh√≥m I (Godan)</h3>
                                <p class="text-center text-blue-600 text-xs italic">K·∫øt th√∫c b·∫±ng c·ªôt "u" (u, ku, su, tsu, nu, bu, mu, ru)</p>
                            </div>
                            <div class="p-4 space-y-3">
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Th·ªÉ Masu</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; i + masu<br><span class="text-xs text-gray-500">(iku &#8594; ikimasu)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Th·ªÉ Nai</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; a + nai<br><span class="text-xs text-gray-500">(u &#8594; wa: kau &#8594; kawanai)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2">
                                    <span class="font-bold text-gray-600 self-center">Th·ªÉ Te/Ta</span>
                                    <div class="col-span-2 text-blue-700 font-medium text-xs space-y-1">
                                        <div>ku &#8594; ite <span class="text-gray-400">(kaku&#8594;kaite)</span> <span class="text-red-500">*iku&#8594;itte</span></div>
                                        <div>gu &#8594; ide <span class="text-gray-400">(oyogu&#8594;oyoide)</span></div>
                                        <div>su &#8594; shite <span class="text-gray-400">(hanasu&#8594;hanashite)</span></div>
                                        <div>mu/nu/bu &#8594; nde <span class="text-gray-400">(yomu&#8594;yonde)</span></div>
                                        <div>u/tsu/ru &#8594; tte <span class="text-gray-400">(kau&#8594;katte)</span></div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Kh·∫£ nƒÉng</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; eru<br><span class="text-xs text-gray-500">(iku &#8594; ikeru)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">√ù ch√≠</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; ou<br><span class="text-xs text-gray-500">(iku &#8594; ikou)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">ƒêi·ªÅu ki·ªán</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; eba<br><span class="text-xs text-gray-500">(iku &#8594; ikeba)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-blue-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">M·ªánh l·ªánh</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; e<br><span class="text-xs text-gray-500">(iku &#8594; ike!)</span></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="font-bold text-gray-600">B·ªã ƒë·ªông</span>
                                    <span class="col-span-2 text-blue-700 font-medium">u &#8594; areru<br><span class="text-xs text-gray-500">(kaku &#8594; kakareru)</span></span>
                                </div>
                            </div>
                        </div>

                        <!-- Group 2 -->
                        <div class="bg-teal-50 rounded-xl border border-teal-200 shadow-sm overflow-hidden">
                            <div class="bg-teal-100 p-3 border-b border-teal-200">
                                <h3 class="text-lg font-bold text-teal-800 flex items-center justify-center"><span class="bg-teal-600 text-white rounded w-6 h-6 flex items-center justify-center mr-2 text-xs">2</span>Nh√≥m II (Ichidan)</h3>
                                <p class="text-center text-teal-600 text-xs italic">K·∫øt th√∫c b·∫±ng "eru" ho·∫∑c "iru"</p>
                            </div>
                            <div class="p-4 space-y-3">
                                <div class="bg-white p-2 rounded border border-teal-100 text-center mb-3">
                                    <span class="text-red-500 font-bold block mb-1 uppercase text-xs">Quy t·∫Øc v√†ng:</span>
                                    <span class="text-teal-800 font-bold">B·ªè "ru" + ƒêu√¥i t∆∞∆°ng ·ª©ng</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Th·ªÉ Masu</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ masu</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Th·ªÉ Nai</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ nai</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Th·ªÉ Te/Ta</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ te / + ta</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">Kh·∫£ nƒÉng</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ rareru</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">√ù ch√≠</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ you</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">ƒêi·ªÅu ki·ªán</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ reba</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 border-b border-teal-100 pb-2 items-center">
                                    <span class="font-bold text-gray-600">M·ªánh l·ªánh</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ ro</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="font-bold text-gray-600">B·ªã ƒë·ªông</span>
                                    <span class="col-span-2 text-teal-700 font-medium text-right pr-4">+ rareru</span>
                                </div>
                            </div>
                        </div>

                        <!-- Group 3 -->
                        <div class="bg-purple-50 rounded-xl border border-purple-200 shadow-sm overflow-hidden">
                            <div class="bg-purple-100 p-3 border-b border-purple-200">
                                <h3 class="text-lg font-bold text-purple-800 flex items-center justify-center"><span class="bg-purple-600 text-white rounded w-6 h-6 flex items-center justify-center mr-2 text-xs">3</span>B·∫•t Quy T·∫Øc</h3>
                                <p class="text-center text-purple-600 text-xs italic">Ch·ªâ c√≥ 2 ƒë·ªông t·ª´: Suru & Kuru</p>
                            </div>
                            <div class="p-4 space-y-4">
                                <!-- Suru -->
                                <div>
                                    <div class="text-center font-bold text-purple-900 bg-purple-200 py-1 rounded mb-2">„Åô„Çã (L√†m)</div>
                                    <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-purple-800">
                                        <div class="flex justify-between border-b border-purple-200"><span>Masu:</span> <b>shimasu</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Nai:</span> <b>shinai</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Te:</span> <b>shite</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Kh·∫£ nƒÉng:</span> <b>dekiru</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>√ù ch√≠:</span> <b>shiyou</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>B·ªã ƒë·ªông:</span> <b>sareru</b></div>
                                    </div>
                                </div>
                                <!-- Kuru -->
                                <div>
                                    <div class="text-center font-bold text-purple-900 bg-purple-200 py-1 rounded mb-2">Êù•„Çã (ƒê·∫øn)</div>
                                    <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-purple-800">
                                        <div class="flex justify-between border-b border-purple-200"><span>Masu:</span> <b>kimasu</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Nai:</span> <b>konai</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Te:</span> <b>kite</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>Kh·∫£ nƒÉng:</span> <b>korareru</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>√ù ch√≠:</span> <b>koyou</b></div>
                                        <div class="flex justify-between border-b border-purple-200"><span>B·ªã ƒë·ªông:</span> <b>korareru</b></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button onclick="closeGrammarModal()" class="bg-gray-800 hover:bg-gray-900 text-white font-bold py-2 px-10 rounded-full shadow-lg transition transform active:scale-95">ƒê√£ Hi·ªÉu</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. GLOBAL STATE & CONFIG ---
        let allWords = [];
        let currentQ = null;
        let score = 0;
        let currentStrokeSvg = null;
        
        const colorMap = { blue: "bg-blue-100 border-blue-400 text-blue-800", green: "bg-green-100 border-green-400 text-green-800", yellow: "bg-yellow-100 border-yellow-400 text-yellow-800", orange: "bg-orange-100 border-orange-400 text-orange-800", teal: "bg-teal-100 border-teal-400 text-teal-800", pink: "bg-pink-100 border-pink-400 text-pink-800", indigo: "bg-indigo-100 border-indigo-400 text-indigo-800", purple: "bg-purple-100 border-purple-400 text-purple-800", gray: "bg-gray-100 border-gray-400 text-gray-800" };
        const btnColorMap = { blue: "bg-blue-500 hover:bg-blue-600", green: "bg-green-500 hover:bg-green-600", yellow: "bg-yellow-500 hover:bg-yellow-600", orange: "bg-orange-500 hover:bg-orange-600", teal: "bg-teal-500 hover:bg-teal-600", pink: "bg-pink-500 hover:bg-pink-600", indigo: "bg-indigo-500 hover:bg-indigo-600", purple: "bg-purple-500 hover:bg-purple-600", gray: "bg-gray-500 hover:bg-gray-600" };

        const groupsConfig = [
            { title: "1. Nh√≥m Di Chuy·ªÉn üö∂‚úàÔ∏è", color: "blue", ids: ["Ë°å„Åè","Êù•„Çã","Â∏∞„Çã","ÂÖ•„Çã","Âá∫„Çã","ÂÖ•„Çå„Çã","Âá∫„Åô","Ê≠©„Åè","Ëµ∞„Çã","‰πó„Çã","Èôç„Çä„Çã","Áôª„Çã","Ê∏°„Çã","Êõ≤„Åå„Çã","ÁùÄ„Åè","ÊÄ•„Åê","Ê≠¢„ÇÄ","Âãï„Åè","ÂæÖ„Å§"] },
            { title: "2. Nh√≥m Sinh Ho·∫°t üè†üí§", color: "green", ids: ["È£ü„Åπ„Çã","È£≤„ÇÄ","Âê∏„ÅÜ","Á´ã„Å§","Â∫ß„Çã","ÂØù„Çã","Ëµ∑„Åç„Çã","Êµ¥„Å≥„Çã","Á£®„Åè","Ê¥ó„ÅÜ","Âàá„Çã","ÁÑº„Åè","Ê≥ä„Åæ„Çã","‰ºë„ÇÄ"] },
            { title: "3. Nh√≥m Mua B√°n üí∞üõçÔ∏è", color: "yellow", ids: ["Ë≤∑„ÅÜ","Â£≤„Çã","Êâï„ÅÜ","Ë≤∏„Åô","ÂÄü„Çä„Çã","Ëøî„Åô"] },
            { title: "4. Nh√≥m ƒê·ªì V·∫≠t üì¶üñêÔ∏è", color: "orange", ids: ["Ë¶ã„Çã","Èñã„Åë„Çã","Èñâ„ÇÅ„Çã","Êäº„Åô","Âºï„Åè","‰Ωú„Çã","‰Ωø„ÅÜ","Áõ¥„Åô","Êé¢„Åô","Ëß¶„Çã","Ë≤º„Çã","ÊíÆ„Çã","Êäï„Åí„Çã","Áõó„ÇÄ","Ë¶ã„Å§„Åã„Çã","Ë¶ã„Å§„Åë„Çã"] },
            { title: "5. Nh√≥m H·ªçc T·∫≠p üíºüìö", color: "teal", ids: ["ÂÉç„Åè","Âã§„ÇÅ„Çã","Êïô„Åà„Çã","Áøí„ÅÜ","Â≠¶„Å∂","Ë¶ö„Åà„Çã","Âøò„Çå„Çã","ËÄÉ„Åà„Çã","Áü•„Çã","ÂàÜ„Åã„Çã","Ë™ø„Åπ„Çã","Êõ∏„Åè"] },
            { title: "6. Nh√≥m Giao Ti·∫øp üó£Ô∏èüòä", color: "pink", ids: ["Ë®Ä„ÅÜ","Ë©±„Åô","ËÅû„Åè","Á≠î„Åà„Çã","Âëº„Å∂","Á¨ë„ÅÜ","Ê≥£„Åè","ÊÄí„Çã","Âñú„Å∂","Âõ∞„Çã","Áñ≤„Çå„Çã","Ë¶ã„Åõ„Çã"] },
            { title: "7. Nh√≥m Trang Ph·ª•c üëïüëü", color: "indigo", ids: ["ÁùÄ„Çã","Â±•„Åè","ËÑ±„Åê"] },
            { title: "8. Nh√≥m Cho/Nh·∫≠n üéÅü§ù", color: "purple", ids: ["‰∏ä„Åí„Çã","„ÇÇ„Çâ„ÅÜ","„Åè„Çå„Çã","Êâã‰ºù„ÅÜ","Âä©„Åë„Çã","È†º„ÇÄ","Ë™ò„ÅÜ","Ëøé„Åà„Çã","‰ºö„ÅÜ"] },
            { title: "9. Kh√°c üå∏‚è≥", color: "gray", ids: ["„ÅÇ„Çã","„ÅÑ„Çã","Ê≠ª„Å¨","Áîü„Åæ„Çå„Çã","Âßã„Åæ„Çã","ÁµÇ„Çè„Çã","Ê±∫„ÇÅ„Çã","Â§â„Åà„Çã","Âí≤„Åè","Èôç„Çã","ÂΩπÁ´ã„Å§","Ê≠å„ÅÜ","ÈÅä„Å∂","Ê≥≥„Åê","„Åô„Çã","„ÇÑ„Çã","Âôõ„ÇÄ","ÂΩπ„Å´Á´ã„Å§","„Åã„Åã„Çã"] }
        ];

        // --- 2. MASTER DATA ---
        const masterVerbList = [
            // 1. Movement
            { k: "Ë°å„Åè", h: "„ÅÑ„Åè", m: "ƒëi", t: 1, e: "iku", ti: "Ch√¢n b∆∞·ªõc tr√°i (**ÂΩ≥**) b∆∞·ªõc ph·∫£i (**‰∫ç**) l√† **H√ÄNH** ƒë·ªông ƒëi.", ta: "ƒêi Y nh∆∞ C·ª• (**Iku**) gi√†.", ctx: ["Â≠¶Ê†°","Êù±‰∫¨","ÊóÖË°å"] },
            { k: "Êù•„Çã", h: "„Åè„Çã", m: "ƒë·∫øn", t: 3, ti: "C√¢y (**Êú®**) m·ªçc 2 nh√°nh (**‰∏∑**) b√°o hi·ªáu t∆∞∆°ng **LAI**.", ta: "**Cu R≈©** (**Kuru**) v√¨ ch·ªù m√£i m·ªõi ƒë·∫øn.", ctx: ["„Éê„Çπ","ÂèãÈÅî","Êò•"] },
            { k: "Â∏∞„Çã", h: "„Åã„Åà„Çã", m: "tr·ªü v·ªÅ", t: 1, e: "kaeru", ti: "Qu√¢n s∆∞ (**‚ªè**) c·∫ßm c√°i **ch·ªïi** (**Â∏ö**) qu√©t nh√† ƒë√≥n ch·ªìng **QUY** h·ªìi.", ta: "Mua **C√° ·∫æ** (**Kaeru**) mang v·ªÅ kho.", ctx: ["Áî∞Ëàé","ÂÆ∂","ÂõΩ"] },
            { k: "ÂÖ•„Çã", h: "„ÅØ„ÅÑ„Çã", m: "v√†o", t: 1, e: "hairu", ti: "Gi·ªëng h√¨nh c√°i l·ªÅu (**ÂÖ•**), ng∆∞·ªùi chui (nh·∫≠p) v√†o.", ta: "**H√£i** (**Hai**) qu√° n√™n **R·ªß** (**ru**) ch·∫°y v√†o.", ctx: ["„ÅäÈ¢®ÂëÇ","ÈÉ®Â±ã","Â§ßÂ≠¶"] },
            { k: "Âá∫„Çã", h: "„Åß„Çã", m: "ra ngo√†i", t: 2, ti: "Hai ng·ªçn n√∫i (**Â±±**) ch·ªìng l√™n nhau **XU·∫§T** hi·ªán l·ª´ng l·ªØng.", ta: "**ƒê√™** (**De**) v·ª° n∆∞·ªõc ch·∫£y **R·ªß** (**ru**) ra ngo√†i.", ctx: ["ÂÆ∂","‰ºöË≠∞","ÁÜ±"] },
            { k: "ÂÖ•„Çå„Çã", h: "„ÅÑ„Çå„Çã", m: "cho v√†o", t: 2, ti: "Ng∆∞·ªùi (**‰∫∫**) ƒëem c√°i g√¨ ƒë√≥ v√†o (**ÂÖ•**) l√† **NH·∫¨P**.", ta: "**Y** nh∆∞ **R·ªÉ** **R·ªß** (**Ireru**) v√†o nh√†.", ctx: ["Á†ÇÁ≥ñ","Êú¨","„Ç´„Éº„Éâ"] },
            { k: "Âá∫„Åô", h: "„Å†„Åô", m: "l·∫•y ra/g·ª≠i", t: 1, ti: "T·ª´ hai ng·ªçn n√∫i (**Â±±**), l·∫•y ƒë·ªì v·∫≠t ra.", ta: "**ƒê√°** **S√π** (**Dasu**) l√¥ng.", ctx: ["ÊâãÁ¥ô","„Ç¥„Éü","Á≠î„Åà"] },
            { k: "Ê≠©„Åè", h: "„ÅÇ„Çã„Åè", m: "ƒëi b·ªô", t: 1, ti: "D·ª´ng l·∫°i (**Ê≠¢**) m·ªôt ch√∫t (**Â∞ë**) r·ªìi m·ªõi ƒëi **B·ªò** ti·∫øp.", ta: "**A! R·ªß C√∫** (**Aruku**) ƒëi b·ªô.", ctx: ["ÂÖ¨Âúí","ÈßÖ„Åæ„Åß","ÈÅì"] },
            { k: "Ëµ∞„Çã", h: "„ÅØ„Åó„Çã", m: "ch·∫°y", t: 1, e: "hashiru", ti: "Ng∆∞·ªùi ch·∫°y tr√™n ƒê·∫•t (**Âúü**) b·∫±ng Ch√¢n (**Èæ∞** - bi·∫øn th·ªÉ c·ªßa Áñã).", ta: "**H√° X√¨** (**Hashi**) h∆°i khi ch·∫°y **R·ªß** (**ru**) nhau.", ctx: ["Âªä‰∏ã","ÈßÖ„Åæ„Åß","„Éû„É©„ÇΩ„É≥"] },
            { k: "‰πó„Çã", h: "„ÅÆ„Çã", m: "l√™n xe", t: 1, ti: "C√¢y l√∫a (**Á¶æ**) ƒë·∫∑t tr√™n ƒë·ªânh ng√†n (**ÂçÉ**) chi·∫øc xe ƒë·ªÉ **TH·ª™A** k·∫ø.", ta: "**N√¥** (**No**) ƒë√πa **R·ªß** (**ru**) l√™n xe.", ctx: ["ÈõªËªä","„Éê„Çπ","Ëá™Ëª¢Ëªä"] },
            { k: "Èôç„Çä„Çã", h: "„Åä„Çä„Çã", m: "xu·ªëng xe", t: 2, ti: "B∆∞·ªõc xu·ªëng **G√≤ ƒë·∫•t** (**Èòù**) b·∫±ng ƒë√¥i ch√¢n ch√©o (**Â§Ö**) l√† **GI√ÅNG** tr·∫ßn.", ta: "**√î! Ri** (**Ori**) xu·ªëng xe r·ªìi k√¨a.", ctx: ["ÈõªËªä","Â±±","ÈöéÊÆµ"] },
            { k: "Áôª„Çã", h: "„ÅÆ„Åº„Çã", m: "leo n√∫i", t: 1, ti: "Hai ch√¢n (**Áô∂**) b∆∞·ªõc l√™n h·∫°t **ƒê·∫≠u** (**Ë±Ü**) th·∫ßn ƒë·ªÉ **ƒêƒÇNG** quang.", ta: "**N√¥** b·ªôc **B√≤** (**Nobo**) leo n√∫i.", ctx: ["ÂØåÂ£´Â±±","Êú®","ÈöéÊÆµ"] },
            { k: "Ê∏°„Çã", h: "„Çè„Åü„Çã", m: "bƒÉng qua", t: 1, ti: "V∆∞·ª£t qua d√≤ng **N∆∞·ªõc** (**Ê∞µ**) n√≥ng 30 **ƒê·ªô** (**Â∫¶**) l√† **ƒê·ªò** giang.", ta: "**Wa! Ta** (**Wata**) bƒÉng qua ƒë∆∞·ªùng.", ctx: ["Ê©ã","ÈÅì","Â∑ù"] },
            { k: "Êõ≤„Åå„Çã", h: "„Åæ„Åå„Çã", m: "r·∫Ω, qu·∫πo", t: 1, ti: "C√°nh ƒë·ªìng (**Áî∞**) d·ª±ng l√™n hai c√°i s·ª´ng t·∫°o th√†nh **KH√öC** quanh.", ta: "**Ma G√†** (**Maga**) r·∫Ω tr√°i.", ctx: ["Ëßí","Âè≥","Â∑¶"] },
            { k: "ÁùÄ„Åè", h: "„Å§„Åè", m: "ƒë·∫øn n∆°i", t: 1, ti: "Con **D√™** (**‚∫∂**) m·ªü **M·∫Øt** (**ÁõÆ**) th·∫•y m√¨nh ƒë√£ ƒë·∫øn ƒë√≠ch (**TR∆Ø·ªöC** ti√™n).", ta: "**X√π** (**Tsu**) l√¥ng **C√∫** (**ku**) khi ƒë·∫øn mu·ªôn.", ctx: ["ÈßÖ","Á©∫Ê∏Ø","Êó•Êú¨"] },
            { k: "ÊÄ•„Åê", h: "„ÅÑ„Åù„Åê", m: "v·ªôi, g·∫•p", t: 1, ti: "Con **Tim** (**ÂøÉ**) b·ªã b√≥ bu·ªôc (**Âàç**) n√™n th·∫•y kh·∫©n **C·∫§P**.", ta: "**I** nh∆∞ **S√¥** (**Iso**) c√¥ la ch·∫£y v√¨ v·ªôi.", ctx: ["ÊôÇÈñì","ÈßÖ„Å∏","Ê∫ñÂÇô"] },
            { k: "Ê≠¢„ÇÄ", h: "„ÇÑ„ÇÄ", m: "t·∫°nh (m∆∞a)", t: 1, ti: "D·ª´ng l·∫°i (**Ê≠¢**) l√† h·∫øt, m∆∞a t·∫°nh.", ta: "**Da** (**Ya**) d·∫ª **M√π** (**mu**) m·ªãt khi t·∫°nh.", ctx: ["Èõ®","Èõ™","È¢®"] },
            { k: "Âãï„Åè", h: "„ÅÜ„Åî„Åè", m: "di chuy·ªÉn", t: 1, ti: "D√πng **L·ª±c** (**Âäõ**) ƒë·∫©y v·∫≠t **N·∫∑ng** (**Èáç**) chuy·ªÉn **ƒê·ªòNG**.", ta: "**U G·ªì** (**Ugo**) gh·ªÅ kh√≥ di chuy·ªÉn.", ctx: ["Ê©üÊ¢∞","Ëªä","‰Ωì"] },
            { k: "ÂæÖ„Å§", h: "„Åæ„Å§", m: "ƒë·ª£i", t: 1, ti: "ƒêi (**ÂΩ≥**) ƒë·∫øn ch√πa (**ÂØ∫**) ƒë·ªÉ **ƒê√ÉI** (ƒë·ª£i) ai ƒë√≥.", ta: "**M√°** **T·ª±** (**Matsu**) ƒë·ª£i con.", ctx: ["„Éê„Çπ","ÂèãÈÅî","Ëøî‰∫ã"] },
            
            // 2. Daily Life
            { k: "È£ü„Åπ„Çã", h: "„Åü„Åπ„Çã", m: "ƒÉn", t: 2, ti: "Ng∆∞·ªùi (**‰∫∫**) t·ªët (**ËâØ**) m·ªõi c√≥ **TH·ª∞C** ph·∫©m ƒë·ªÉ ƒÉn.", ta: "**Ta B·ªÅ** (**Tabe**) s√™ ra ƒÉn.", ctx: ["Âà∫Ë∫´","ÈáéËèú","Êúù„Åî„ÅØ„Çì"] },
            { k: "È£≤„ÇÄ", h: "„ÅÆ„ÇÄ", m: "u·ªëng", t: 1, ti: "ƒÇn (**È£ü**) xong thi·∫øu (**Ê¨†**) n∆∞·ªõc th√¨ ph·∫£i **·∫®M** (u·ªëng).", ta: "**N√¥** (**No**) ƒë√πa l√†m v·ª° c√°i **M≈©** (**mu**).", ctx: ["„ÅäÈÖí","Ëñ¨","„Ç≥„Éº„Éí„Éº"] },
            { k: "Âê∏„ÅÜ", h: "„Åô„ÅÜ", m: "h√∫t", t: 1, ti: "Mi·ªáng (**Âè£**) h√≠t v√†o k·ªãp (**Âèä**) th·ªùi l√† h√¥ **H·∫§P**.", ta: "**Su Su** (**Suu**) x√†o.", ctx: ["„Çø„Éê„Ç≥","Á©∫Ê∞ó","ÊÅØ"] },
            { k: "Á´ã„Å§", h: "„Åü„Å§", m: "ƒë·ª©ng", t: 1, ti: "Ng∆∞·ªùi ƒë·ª©ng (**Á´ã**) tr√™n ƒë·∫•t **L·∫¨P** nghi·ªáp.", ta: "**Ta T·ª±** (**Tatsu**) ƒë·ª©ng.", ctx: ["„Éâ„Ç¢„ÅÆÂâç","Â∏≠","Êú®"] },
            { k: "Â∫ß„Çã", h: "„Åô„Çè„Çã", m: "ng·ªìi", t: 1, ti: "Hai ng∆∞·ªùi (**‰∫∫**) ng·ªìi tr√™n ƒë·∫•t (**Âúü**) trong nh√† (**Âπø**) ƒë·ªÉ **T·ªåA** ƒë√†m.", ta: "**Su** **Wa** **R·ªß** (**Suwaru**) ng·ªìi xu·ªëng.", ctx: ["Ê§ÖÂ≠ê","„Åì„Åì","„ÇΩ„Éï„Ç°„Éº"] },
            { k: "ÂØù„Çã", h: "„Å≠„Çã", m: "ng·ªß", t: 2, ti: "V√†o nh√† (**ÂÆÄ**) n·∫±m tr√™n t·∫•m ph·∫£n (**Áàø**) l√† **T·∫®M** cung.", ta: "**N·ªÉ** (**Ne**) t√¨nh m·ªõi ƒëi ng·ªß.", ctx: ["10ÊôÇ","„Éô„ÉÉ„Éâ","Êòº"] },
            { k: "Ëµ∑„Åç„Çã", h: "„Åä„Åç„Çã", m: "th·ª©c d·∫≠y", t: 2, ti: "B·∫£n th√¢n (**Â∑±**) ph·∫£i ch·∫°y (**Ëµ∞**) kh·ªèi gi∆∞·ªùng ƒë·ªÉ **KH·ªûI** ƒë·ªông.", ta: "**√î! K√¨** (**Oki**) l·∫°, sao d·∫≠y s·ªõm th·∫ø.", ctx: ["ÊØéÊúù","Êó©„Åè","6ÊôÇ"] },
            { k: "Êµ¥„Å≥„Çã", h: "„ÅÇ„Å≥„Çã", m: "t·∫Øm", t: 2, ti: "T·∫Øm ·ªü thung l≈©ng (**Ë∞∑**) c√≥ nhi·ªÅu n∆∞·ªõc (**Ê∞µ**) l√† t·∫Øm **D·ª§C**.", ta: "**A! Bi** (**Abi**) ƒëi t·∫Øm.", ctx: ["„Ç∑„É£„ÉØ„Éº","Êó•ÂÖâ","Ê∞¥"] },
            { k: "Á£®„Åè", h: "„Åø„Åå„Åè", m: "ƒë√°nh, m√†i", t: 1, ti: "D√πng ƒë√° (**Áü≥**) **MA** s√°t v√†o c√¢y gai (**È∫ª**) trong nh√† (**Âπø**).", ta: "**Mi G√† C√∫** (**Migaku**) ƒëang ƒë√°nh rƒÉng.", ctx: ["Ê≠Ø","Èù¥","ËÖï"] },
            { k: "Ê¥ó„ÅÜ", h: "„ÅÇ„Çâ„ÅÜ", m: "r·ª≠a", t: 1, ti: "D√πng n∆∞·ªõc (**Ê∞µ**) **T·∫®Y** r·ª≠a tr∆∞·ªõc ti√™n (**ÂÖà**).", ta: "**A! Rau** (**Arau**) c·∫ßn ph·∫£i r·ª≠a.", ctx: ["Êâã","Áöø","Êúç"] },
            { k: "Âàá„Çã", h: "„Åç„Çã", m: "c·∫Øt", t: 1, e: "kiru", ti: "S·ªë 7 (**‰∏É**) con dao (**ÂàÄ**) **THI·∫æT** s·∫Øc l·∫πm.", ta: "**Ki** (**Ki**) bo kh√¥ng cho m∆∞·ª£n dao.", ctx: ["Á¥ô","È´™","ÈõªË©±"] },
            { k: "ÁÑº„Åè", h: "„ÇÑ„Åè", m: "n∆∞·ªõng", t: 1, ti: "D√πng **L·ª≠a** (**ÁÅ´**) n∆∞·ªõng ƒë·∫•t s√©t (**Â∞≠**) l√† **THI√äU**.", ta: "**D·∫° C·ª•** (**Yaku**) th√≠ch ƒÉn ƒë·ªì n∆∞·ªõng.", ctx: ["ËÇâ","„Éë„É≥","È≠ö"] },
            { k: "Ê≥ä„Åæ„Çã", h: "„Å®„Åæ„Çã", m: "tr·ªç l·∫°i", t: 1, ti: "C√≥ **N∆∞·ªõc** (**Ê∞µ**) m√†u **Tr·∫Øng** (**ÁôΩ**) ·ªü b·∫øn **B·∫†C**.", ta: "**T√¥** m√¨ **M√†** **R·ªß** (**Tomaru**) tr·ªç l·∫°i ƒÉn.", ctx: ["„Éõ„ÉÜ„É´","ÂèãÈÅî„ÅÆÂÆ∂","‰∫¨ÈÉΩ"] },
            { k: "‰ºë„ÇÄ", h: "„ÇÑ„Åô„ÇÄ", m: "ngh·ªâ ng∆°i", t: 1, ti: "Ng∆∞·ªùi (**‰∫ª**) d·ª±a v√†o c√¢y (**Êú®**) ngh·ªâ **H∆ØU**.", ta: "**Ya**! **S∆∞ M√π** (**Yasumu**) ƒëang ngh·ªâ.", ctx: ["‰ºöÁ§æ","Â∞ë„Åó","Â≠¶Ê†°"] },

            // 3. Money
            { k: "Ë≤∑„ÅÜ", h: "„Åã„ÅÜ", m: "mua", t: 1, ti: "C√°i l∆∞·ªõi (**ÁΩí**) ch·ª•p ti·ªÅn (**Ë≤ù**) ƒë·ªÉ **M√ÉI** (mua).", ta: "**Ca U** (**Kau**) s·∫ßu v√¨ mua h·ªõ.", ctx: ["Ëªä","Êúç","„ÉÅ„Ç±„ÉÉ„Éà"] },
            { k: "Â£≤„Çã", h: "„ÅÜ„Çã", m: "b√°n", t: 1, ti: "K·∫ª sƒ© (**Â£´**) tr√πm khƒÉn (**ÂÜñ**) ƒëi b√°n ch√¢n (**ÂÑø**) l√† **M·∫†I**.", ta: "**U R≈©** (**Uru**) r∆∞·ª£i v√¨ b√°n ·∫ø.", ctx: ["ÂÆ∂","Êú¨","ÈáéËèú"] },
            { k: "Êâï„ÅÜ", h: "„ÅØ„Çâ„ÅÜ", m: "tr·∫£ ti·ªÅn", t: 1, ti: "Tay (**Êâå**) tr·∫£ ti·ªÅn cho vi·ªác ri√™ng t∆∞ (**„É†**) r·ªìi **PH·∫§T** √°o ra ƒëi.", ta: "**H·∫£? Rau** (**Harau**) ƒë·∫Øt th·∫ø √°?", ctx: ["„ÅäÈáë","„Ç´„Éº„Éâ","ÂÆ∂Ë≥É"] },
            { k: "Ë≤∏„Åô", h: "„Åã„Åô", m: "cho m∆∞·ª£n", t: 1, ti: "ƒê·ªïi (**‰ª£**) l·∫•y ti·ªÅn (**Ë≤ù**) l√† cho vay m∆∞·ª£n (**TH·∫¢I**).", ta: "**Ca** sƒ© **S√π** (**Kasu**) ti·ªÅn cho m∆∞·ª£n.", ctx: ["„ÅäÈáë","Êú¨","ÂÇò"] },
            { k: "ÂÄü„Çä„Çã", h: "„Åã„Çä„Çã", m: "m∆∞·ª£n", t: 2, ti: "Ng∆∞·ªùi (**‰∫ª**) x∆∞a (**Êòî**) hay ƒëi **T√Å** t√∫c.", ta: "**Ca Ri L∆∞** (**Kariru**) th∆∞a ti·ªÅn n√™n ƒëi m∆∞·ª£n.", ctx: ["Âõ≥Êõ∏È§®","„Éö„É≥","Èáë"] },
            { k: "Ëøî„Åô", h: "„Åã„Åà„Åô", m: "tr·∫£ l·∫°i", t: 1, ti: "ƒêi (**‚ªå**) ng∆∞·ª£c l·∫°i (**Âèç**) con ƒë∆∞·ªùng ƒë·ªÉ tr·∫£ ƒë·ªì (**PH·∫¢N**).", ta: "**Ca ·∫æ S√π** (**Kaesu**) n·ª£ ph·∫£i tr·∫£ l·∫°i.", ctx: ["Êú¨","„ÅäÈáë","Ëøî‰∫ã"] },

            // 4. Objects
            { k: "Ë¶ã„Çã", h: "„Åø„Çã", m: "nh√¨n", t: 2, ti: "M·∫Øt (**ÁõÆ**) g·∫Øn tr√™n ch√¢n ng∆∞·ªùi (**ÂÑø**) ƒë·ªÉ ƒëi **KI·∫æN** t·∫≠p.", ta: "**Mi R·ªß** (**Miru**) nh√¨n g√¨?", ctx: ["Êò†Áîª","„ÉÜ„É¨„Éì","Â§¢"] },
            { k: "Èñã„Åë„Çã", h: "„ÅÇ„Åë„Çã", m: "m·ªü", t: 2, ti: "Hai tay m·ªü c·ªïng (**ÈñÄ**) **KHAI** tr∆∞∆°ng.", ta: "**A! K·ªá** (**Ake**) c·ª© m·ªü ƒëi.", ctx: ["„Éâ„Ç¢","Á™ì","Â∫ó"] },
            { k: "Èñâ„ÇÅ„Çã", h: "„Åó„ÇÅ„Çã", m: "ƒë√≥ng", t: 2, ti: "ƒê√≥ng c·ª≠a (**ÈñÄ**) l·∫°i ƒë·ªÉ tr·ªçng d·ª•ng nh√¢n t√†i (**Êâç**) b√™n trong l√† **B·∫æ**.", ta: "**Si M√™** (**Shime**) ƒë√≥ng c·ª≠a l√≤ng.", ctx: ["„Ç´„Éº„ÉÜ„É≥","Â∫ó","Ëìã"] },
            { k: "Êäº„Åô", h: "„Åä„Åô", m: "·∫•n, ƒë·∫©y", t: 1, ti: "D√πng **Tay** (**Êâå**) ·∫•n v√†o √°o **Gi√°p** (**Áî≤**) ƒë·ªÉ tr·∫•n **√ÅP**.", ta: "**√î! S∆∞** (**Osu**) ƒëang ·∫•n chu√¥ng c·ª≠a.", ctx: ["„Éú„Çø„É≥","ËÉå‰∏≠","Âà§„Åì"] },
            { k: "Âºï„Åè", h: "„Å≤„Åè", m: "k√©o", t: 1, ti: "Cung (**Âºì**) ƒë∆∞·ª£c **D·∫™N** cƒÉng ra b·∫±ng 1 ƒë∆∞·ªùng th·∫≥ng (**‰∏®**).", ta: "**Hi** h√≥p m√° **C·ª•** (**Hiku**) k√©o xe.", ctx: ["„Éâ„Ç¢","ËæûÊõ∏","È¢®ÈÇ™"] },
            { k: "‰Ωú„Çã", h: "„Å§„Åè„Çã", m: "l√†m", t: 1, ti: "Ng∆∞·ªùi (**‰∫ª**) l√†m ra **T√ÅC** ph·∫©m b·ªóng nhi√™n (**‰πç**).", ta: "**Xu C≈© R·ªß** (**Tsukuru**) l√†m ƒë·ªì gi·∫£.", ctx: ["ÊñôÁêÜ","ÈáéËèú","ÂèãÈÅî"] },
            { k: "‰Ωø„ÅÜ", h: "„Å§„Åã„ÅÜ", m: "s·ª≠ d·ª•ng", t: 1, ti: "Ng∆∞·ªùi (**‰∫ª**) l√†m quan **L·∫°i** (**Âêè**) m·ªõi ƒë∆∞·ª£c **S·ª¨** d·ª•ng l√≠nh.", ta: "**X√π C√°u** (**Tsukau**) khi b·ªã sai s·ª≠ d·ª•ng.", ctx: ["„Éë„ÇΩ„Ç≥„É≥","Êó•Êú¨Ë™û","ÁÆ∏"] },
            { k: "Áõ¥„Åô", h: "„Å™„Åä„Åô", m: "s·ª≠a ch·ªØa", t: 1, ti: "M∆∞·ªùi (**ÂçÅ**) con M·∫Øt (**ÁõÆ**) nh√¨n th·∫≥ng g√≥c (**‰πö**) ƒë·ªÉ s·ª≠a cho **TR·ª∞C** (th·∫≥ng).", ta: "**N√†o! S∆∞** (**Naosu**) s·ª≠a l·∫°i c√°i √°o ƒëi.", ctx: ["Ëªä","ÈñìÈÅï„ÅÑ","ÁóÖÊ∞ó"] },
            { k: "Êé¢„Åô", h: "„Åï„Åå„Åô", m: "t√¨m ki·∫øm", t: 1, ti: "Tay (**Êâå**) m√≤ v√†o hang S√¢u (**ÁΩô**) ƒë·ªÉ **TH√ÅM** hi·ªÉm.", ta: "**Sa G√† S√π** (**Sagasu**) l√¥ng ƒëi t√¨m th√≥c.", ctx: ["‰ªï‰∫ã","Èçµ","ÁäØ‰∫∫"] },
            { k: "Ëß¶„Çã", h: "„Åï„Çè„Çã", m: "s·ªù, ch·∫°m", t: 1, ti: "C√¥n tr√πng (**Ëô´**) d√πng c√°i S·ª´ng (**Ëßí**) ƒë·ªÉ **X√öC** ch·∫°m.", ta: "**Sa** v√†o **Wa** **R·ªß** (**Sawaru**) nhau s·ªù th·ª≠.", ctx: ["Áµµ","È´™","ÂïÜÂìÅ"] },
            { k: "Ë≤º„Çã", h: "„ÅØ„Çã", m: "d√°n", t: 1, ti: "D√πng ti·ªÅn (**Ë≤ù**) **Chi·∫øm** (**Âç†**) l·∫•y ch·ªó ƒë·ªÉ d√°n t·∫•m **THI·∫æP**.", ta: "**H·∫£? R·ªß** (**Haru**) d√°n gi·∫•y √†?", ctx: ["ÂàáÊâã","„Éù„Çπ„Çø„Éº","„Ç∑„ÉÉ„Éó"] },
            { k: "ÊíÆ„Çã", h: "„Å®„Çã", m: "ch·ª•p ·∫£nh", t: 1, ti: "Tay (**Êâå**) ch·ªçn g√≥c ƒë·∫πp Nh·∫•t (**ÊúÄ**) ƒë·ªÉ ch·ª•p ·∫£nh **TO√ÅT** th·∫ßn th√°i.", ta: "**T√¥** son **R·ªß** (**Toru**) nhau ch·ª•p ·∫£nh.", ctx: ["ÂÜôÁúü","„Éì„Éá„Ç™","Êò†Áîª"] },
            { k: "Êäï„Åí„Çã", h: "„Å™„Åí„Çã", m: "n√©m", t: 2, ti: "Tay (**Êâå**) c·∫ßm binh kh√≠ (**ÊÆ≥**) n√©m ƒëi (**ƒê·∫¶U** c∆°).", ta: "**N√° Gh√™ R·ªß** (**Nageru**) nhau n√©m ƒë√°.", ctx: ["„Éú„Éº„É´","Áü≥","„Ç¥„Éü"] },
            { k: "Áõó„ÇÄ", h: "„Å¨„Åô„ÇÄ", m: "ƒÉn tr·ªôm", t: 1, ti: "L·∫ßn ti·∫øp theo (**Ê¨°**) s·∫Ω tr·ªôm c√°i ƒëƒ©a (**Áöø**) l√† k·∫ª **ƒê·∫†O** ch√≠ch.", ta: "**Nu**√¥i **S∆∞ M√π** (**Nusumu**) m√† l·∫°i ƒëi ƒÉn tr·ªôm.", ctx: ["Ë≤°Â∏É","Ëá™Ëª¢Ëªä","ÂøÉ"] },
            { k: "Ë¶ã„Å§„Åã„Çã", h: "„Åø„Å§„Åã„Çã", m: "ƒë∆∞·ª£c t√¨m th·∫•y", t: 1, ti: "M·∫Øt (**ÁõÆ**) d√≠nh ch·∫∑t (**‰ªò**) v√†o v·∫≠t.", ta: "**Mi** **Tsu** **Ka** **Ru**.", ctx: ["‰ªï‰∫ã","Èçµ","Á≠î„Åà"] },
            { k: "Ë¶ã„Å§„Åë„Çã", h: "„Åø„Å§„Åë„Çã", m: "t√¨m th·∫•y", t: 2, ti: "M·∫Øt (**ÁõÆ**) ki·∫øn (**KI·∫æN**) t·∫°o ra v·∫≠t.", ta: "**Mi** **Tsu** **Ke** **Ru**.", ctx: ["ËâØ„ÅÑÂ∫ó","ÊñπÊ≥ï","ÈñìÈÅï„ÅÑ"] },
            
            // 5. Work & Study
            { k: "ÂÉç„Åè", h: "„ÅØ„Åü„Çâ„Åè", m: "l√†m vi·ªác", t: 1, ti: "Ng∆∞·ªùi (**‰∫ª**) d√πng s·ª©c (**Âäõ**) l√†m vi·ªác N·∫∑ng (**Èáç**) l√† lao **ƒê·ªòNG**.", ta: "**H√† Ta Ra C≈©ng** (**Hataraku**) ph·∫£i l√†m vi·ªác.", ctx: ["‰ºöÁ§æ","ÈäÄË°å","ÊØéÊó•"] },
            { k: "Âã§„ÇÅ„Çã", h: "„Å§„Å®„ÇÅ„Çã", m: "l√†m (cty)", t: 2, ti: "D√πng s·ª©c (**Âäõ**) l√†m vi·ªác chuy√™n **C·∫¶N** tr√™n ƒë·∫•t s√©t (**Â†á**).", ta: "**Xu T√¥ M√™ R·ªß** (**Tsutomeru**) ƒëi l√†m.", ctx: ["‰ºöÁ§æ","Â≠¶Ê†°","ÈäÄË°å"] },
            { k: "Êïô„Åà„Çã", h: "„Åä„Åó„Åà„Çã", m: "d·∫°y", t: 2, ti: "D·∫°y ch·ªØ Hi·∫øu (**Â≠ù**) th√¨ ph·∫£i nghi√™m kh·∫Øc ƒë√°nh kh·∫Ω (**Êîµ**) l√† **GI√ÅO** d·ª•c.", ta: "**√î! Si √ä R·ªß** (**Oshieru**) d·∫°y h·ªçc √†?", ctx: ["Êó•Êú¨Ë™û","ÈÅì","‰ΩèÊâÄ"] },
            { k: "Áøí„ÅÜ", h: "„Å™„Çâ„ÅÜ", m: "h·ªçc (th·∫ßy)", t: 1, ti: "Chim non t·∫≠p v·ªó ƒë√¥i C√°nh (**ÁæΩ**) m√†u Tr·∫Øng (**ÁôΩ**) ƒë·ªÉ **T·∫¨P** bay.", ta: "**Na Ra U**·ªëng (**Narau**) n∆∞·ªõc sau khi h·ªçc.", ctx: ["„Éî„Ç¢„Éé","Ëã±Ë™û","ÈÅãËª¢"] },
            { k: "Â≠¶„Å∂", h: "„Åæ„Å™„Å∂", m: "h·ªçc", t: 1, ti: "ƒê·ª©a Tr·∫ª (**Â≠ê**) d∆∞·ªõi m√°i nh√† (**ÂÜñ**) h·ªçc ƒëi·ªÅu s√°ng su·ªët (**‚∫ç**) l√† **H·ªåC** h√†nh.", ta: "**M√°! Na B·ª±** (**Manabu**) th·∫ø, h·ªçc g√¨ n·ªïi.", ctx: ["Ê≠¥Âè≤","ÁµåÊ∏à","Â§ßÂ≠¶"] },
            { k: "Ë¶ö„Åà„Çã", h: "„Åä„Åº„Åà„Çã", m: "nh·ªõ", t: 2, ti: "·ªû d∆∞·ªõi nh√† (**ÂÜñ**) s√°ng su·ªët (**‚∫ç**) nh√¨n (**Ë¶ã**) l√† s·∫Ω **GI√ÅC** ng·ªô (nh·ªõ).", ta: "**√î! B·ªë √ä R·ªß** (**Oboeru**) nh·ªõ b√†i ch∆∞a?", ctx: ["ÂçòË™û","ÈÅì","È°î"] },
            { k: "Âøò„Çå„Çã", h: "„Çè„Åô„Çå„Çã", m: "qu√™n", t: 2, ti: "Con Tim (**ÂøÉ**) m√† ch·∫øt (**‰∫°**) th√¨ s·∫Ω **VONG** t√¨nh (qu√™n).", ta: "**Wa! S∆∞ R·ªÉ R·ªß** (**Wasureru**) qu√™n h·∫øt s·ª± ƒë·ªùi.", ctx: ["ÂÆøÈ°å","ÂêçÂâç","Ë≤°Â∏É"] },
            { k: "ËÄÉ„Åà„Çã", h: "„Åã„Çì„Åå„Åà„Çã", m: "suy nghƒ©", t: 2, ti: "√îng Gi√† (**ËÄÇ**) ch·ªëng g·∫≠y suy nghƒ© (**‰∏Ç**) ƒë·ªÉ **KH·∫¢O** s√°t.", ta: "**C√°n G√† √ä R·ªß** (**Kangaeru**) suy nghƒ© c√°ch c·ª©u.", ctx: ["Â∞ÜÊù•","Á≠î„Åà","ÊñπÊ≥ï"] },
            { k: "Áü•„Çã", h: "„Åó„Çã", m: "bi·∫øt", t: 1, e: "shiru", ti: "M≈©i t√™n (**Áü¢**) b·∫Øn ra t·ª´ mi·ªáng (**Âè£**) l√† l·ªùi n√≥i c·ªßa ng∆∞·ªùi c√≥ **TRI** th·ª©c.", ta: "**Si R·ªß** (**Shiru**) nhau ƒëi t√¨m hi·ªÉu cho bi·∫øt.", ctx: ["„Éã„É•„Éº„Çπ","ÁßòÂØÜ","‰ΩèÊâÄ"] },
            { k: "ÂàÜ„Åã„Çã", h: "„Çè„Åã„Çã", m: "hi·ªÉu", t: 1, ti: "D√πng Dao (**ÂàÄ**) chia l√†m T√°m (**ÂÖ´**) ph·∫ßn s·∫Ω **PH√ÇN** bi·ªát v√† hi·ªÉu r√µ.", ta: "**Wa! C√° R·ªß** (**Wakaru**) nhau b∆°i, hi·ªÉu r·ªìi.", ctx: ["ÊÑèÂë≥","Ê∞óÊåÅ„Å°","ÁêÜÁî±"] },
            { k: "Ë™ø„Åπ„Çã", h: "„Åó„Çâ„Åπ„Çã", m: "ƒëi·ªÅu tra", t: 2, ti: "D√πng L·ªùi n√≥i (**Ë®Ä**) h·ªèi kh·∫Øp Chu vi (**Âë®**) ƒë·ªÉ **ƒêI·ªÄU** tra.", ta: "**Si Ra B√™ R·ªß** (**Shiraberu**) ƒëi·ªÅu tra.", ctx: ["Ë®ÄËëâ","ÊôÇÈñì","Â†¥ÊâÄ"] },
            { k: "Êõ∏„Åè", h: "„Åã„Åè", m: "vi·∫øt", t: 1, ti: "Tay c·∫ßm b√∫t (**ËÅø**) vi·∫øt chuy·ªán h√†ng Ng√†y (**Êó•**) v√†o s√°ch (**TH∆Ø**).", ta: "**Ca C·ª©** (**Kaku**) h√°t khi vi·∫øt.", ctx: ["ÊâãÁ¥ô","Êó•Ë®ò","ÂêçÂâç"] },
            
            // 6. Communication
            { k: "Ë®Ä„ÅÜ", h: "„ÅÑ„ÅÜ", m: "n√≥i", t: 1, ti: "Mi·ªáng (**Âè£**) ph√°t ra **NG√îN** t·ª´.", ta: "**I U** (**Iu** - Y√™u) th√¨ n√≥i ƒëi.", ctx: ["ÂÜóË´á","„ÅäÁ§º","ÊÑèË¶ã"] },
            { k: "Ë©±„Åô", h: "„ÅØ„Å™„Åô", m: "n√≥i chuy·ªán", t: 1, ti: "C√°i L∆∞·ª°i (**Ëàå**) u·ªën √©o n√≥i l·ªùi (**Ë®Ä**) **THO·∫†I**.", ta: "**H·∫£? Na S√π** (**Hanasu**) l√¥ng khi n√≥i chuy·ªán √†?", ctx: ["ÂèãÈÅî","Êó•Êú¨Ë™û","ÈõªË©±"] },
            { k: "ËÅû„Åè", h: "„Åç„Åè", m: "nghe", t: 1, ti: "Gh√© Tai (**ËÄ≥**) v√†o c·ªïng (**ÈñÄ**) ƒë·ªÉ nghe tin **VƒÇN**.", ta: "**Ki C·ª•** (**Kiku**) ƒëang nghe ƒë√†i.", ctx: ["Èü≥Ê•Ω","ÂÖàÁîü","ÈÅì"] },
            { k: "Á≠î„Åà„Çã", h: "„Åì„Åü„Åà„Çã", m: "tr·∫£ l·ªùi", t: 2, ti: "Tr√∫c (**Á´π**) xinh tr√∫c m·ªçc ƒë·∫ßu ƒë√¨nh, H·ª£p (**Âêà**) l·∫°i tr·∫£ l·ªùi gi·∫£i **ƒê√ÅP** th√¥ng minh.", ta: "**C√¥ Ta √ä R·ªß** (**Kotaeru**) tr·∫£ l·ªùi c√¢u h·ªèi.", ctx: ["Ë≥™Âïè","„ÉÜ„Çπ„Éà","ÊâãÁ¥ô"] },
            { k: "Âëº„Å∂", h: "„Çà„Å∂", m: "g·ªçi", t: 1, ti: "Mi·ªáng (**Âè£**) d√πng tay (**Êâã**) **H√î** ho√°n to l√™n.", ta: "**D√¥ B·ª±** (**Yobu**) g·ªçi nhau ƒëi nh·∫≠u.", ctx: ["„Çø„ÇØ„Ç∑„Éº","ÂêçÂâç","Ë≠¶ÂØü"] },
            { k: "Á¨ë„ÅÜ", h: "„Çè„Çâ„ÅÜ", m: "c∆∞·ªùi", t: 1, ti: "C√¢y Tr√∫c (**Á´π**) m√∫a may nh∆∞ ng∆∞·ªùi Tr·∫ª (**Â§≠**) ƒëang **TI·∫æU** (c∆∞·ªùi).", ta: "**Wa! Rau** (**Warau**) c∆∞·ªùi toe to√©t.", ctx: ["Â§ßÂ£∞","„Éã„Ç≥„Éã„Ç≥","Âπ∏„Åõ"] },
            { k: "Ê≥£„Åè", h: "„Å™„Åè", m: "kh√≥c", t: 1, ti: "ƒê·ª©ng (**Á´ã**) r·ªõt n∆∞·ªõc (**Ê∞µ**) m·∫Øt l√† **KH·∫§P** (kh√≥c).", ta: "**Na C·ª•** (**Naku**) kh√≥c hu hu.", ctx: ["Â≠ê‰æõ","ÊÑüÂãï","Â§ú"] },
            { k: "ÊÄí„Çã", h: "„Åä„Åì„Çã", m: "t·ª©c gi·∫≠n", t: 1, ti: "Tr√°i Tim (**ÂøÉ**) ng∆∞·ªùi N√¥ l·ªá (**Â•¥**) ch·ª©a ƒë·∫ßy ph·∫´n **N·ªò**.", ta: "**√î! C√¥ R·ªß** (**Okoru**) nhau t·ª©c gi·∫≠n √†?", ctx: ["Áà∂","‰∏äÂè∏","Ëá™ÂàÜ"] },
            { k: "Âñú„Å∂", h: "„Çà„Çç„Åì„Å∂", m: "vui m·ª´ng", t: 1, ti: "ƒê√°nh Tr·ªëng (**Â£¥**) ƒÉn m·ª´ng, mi·ªáng (**Âè£**) c∆∞·ªùi **H·ª∂** h·∫£.", ta: "**D√¥ R·ªì C√¥ B·ª±** (**Yorokobu**) vui m·ª´ng qu√°.", ctx: ["„Éó„É¨„Çº„É≥„Éà","ÂêàÊ†º","ÊØç"] },
            { k: "Âõ∞„Çã", h: "„Åì„Åæ„Çã", m: "kh√≥ khƒÉn", t: 1, ti: "C√¢y (**Êú®**) b·ªã nh·ªët trong h·ªôp (**Âõó**) kh√¥ng l·ªõn ƒë∆∞·ª£c -> **KH·ªêN** kh·ªï.", ta: "**C√¥ Ma R·ªß** (**Komaru**) l√†m kh√≥ nhau.", ctx: ["„ÅäÈáë","Ëøî‰∫ã","ÁîüÊ¥ª"] },
            { k: "Áñ≤„Çå„Çã", h: "„Å§„Åã„Çå„Çã", m: "m·ªát", t: 2, ti: "Da (**ÁöÆ**) b·ªçc x∆∞∆°ng l·∫°i c√≤n b·ªánh (**Áñí**) th√¨ r·∫•t m·ªát m·ªèi (**B√å**).", ta: "**Xu C√† R·ªÉ R·ªß** (**Tsukareru**) m·ªát qu√°.", ctx: ["ÁõÆ","‰Ωì","‰ªï‰∫ã"] },
            { k: "Ë¶ã„Åõ„Çã", h: "„Åø„Åõ„Çã", m: "cho xem", t: 2, ti: "M·∫Øt (**ÁõÆ**) ki·∫øn (**KI·∫æN**) t·∫°o.", ta: "**Mi S√™ R·ªß** (**Miseru**) cho xem.", ctx: ["ÂÜôÁúü","„Éë„Çπ„Éù„Éº„Éà","Ë®ºÊã†"] },
            
            // 7. Clothing
            { k: "ÁùÄ„Çã", h: "„Åç„Çã", m: "m·∫∑c (√°o)", t: 2, ti: "Con D√™ (**‚∫∂**) m·ªü M·∫Øt (**ÁõÆ**) ch·ªçn b·ªô ƒë·ªì **TR∆Ø·ªöC** khi m·∫∑c.", ta: "**Ki R·ªß** (**Kiru**) m·∫∑c √°o ƒë√¥i.", ctx: ["„Ç∑„É£„ÉÑ","ÁùÄÁâ©","„Çπ„Éº„ÉÑ"] },
            { k: "Â±•„Åè", h: "„ÅØ„Åè", m: "ƒëi (gi√†y)", t: 1, ti: "Th√¢n th·ªÉ (**Â∞∏**) ph·ª•c h·ªìi (**Âæ©**) l·∫°i ƒë·ªÉ b∆∞·ªõc ƒëi gi√†y (**L√ù**).", ta: "**H√† C·ª•** (**Haku**) ƒëi gi√†y v√†o.", ctx: ["Èù¥","„Ç∫„Éú„É≥","„Çπ„Ç´„Éº„Éà"] },
            { k: "ËÑ±„Åê", h: "„Å¨„Åê", m: "c·ªüi", t: 1, ti: "Da th·ªãt (**Êúà**) vui v·∫ª (**ÂÖë**) **THO√ÅT** ra kh·ªèi qu·∫ßn √°o.", ta: "**N·ª•** c∆∞·ªùi **Gu** (**Nugu**) m·∫∑n khi c·ªüi ƒë·ªì.", ctx: ["Êúç","Â∏ΩÂ≠ê","Èù¥"] },
            
            // 8. Giving/Helping
            { k: "‰∏ä„Åí„Çã", h: "„ÅÇ„Åí„Çã", m: "t·∫∑ng/cho", t: 2, ti: "ƒê∆∞a l√™n tr√™n (**TH∆Ø·ª¢NG**).", ta: "**A! Gh√™ R·ªß** (**Ageru**) t·∫∑ng qu√†.", ctx: ["„Éó„É¨„Çº„É≥„Éà","Áµ¶Êñô","Êâã"] },
            { k: "Ë≤∞„ÅÜ", h: "„ÇÇ„Çâ„ÅÜ", m: "nh·∫≠n", t: 1, ti: "**Th·∫ø** (**‰∏ñ**) gian ban cho Ti·ªÅn (**Ë≤ù**) l√† **TH·∫æ** (nh·∫≠n).", ta: "**M·ªè Ra U** (**Morau**) nh·∫≠n qu√†.", ctx: ["„ÅäÂπ¥Áéâ","Áµ¶Êñô","„É°„Éº„É´"] },
            { k: "„Åè„Çå„Çã", h: "„Åè„Çå„Çã", m: "cho (m√¨nh)", t: 2, ti: "(Th∆∞·ªùng d√πng Kana).", ta: "**Cu R√™ R·ªß** (**Kureru**) cho m√¨nh.", ctx: ["„ÅäËèìÂ≠ê","„ÉÅ„É£„É≥„Çπ","ÈõªË©±"] },
            { k: "Êâã‰ºù„ÅÜ", h: "„Å¶„Å§„Å†„ÅÜ", m: "gi√∫p ƒë·ª°", t: 1, ti: "D√πng Tay (**Êâå**) **TRUY·ªÄN** (**‰ºù**) c√¥ng l·ª±c gi√∫p ƒë·ª°.", ta: "**T·∫øt T·ª± ƒê√¢u** (**Tetsudau**) gi√∫p.", ctx: ["ÊØç","‰ªï‰∫ã","ÂÆøÈ°å"] },
            { k: "Âä©„Åë„Çã", h: "„Åü„Åô„Åë„Çã", m: "c·ª©u gi√∫p", t: 2, ti: "D√πng S·ª©c (**Âäõ**) v√† h∆°n th·∫ø n·ªØa (**‰∏î**) ƒë·ªÉ h·ªó **TR·ª¢** c·ª©u gi√∫p.", ta: "**Ta S∆∞ K·ªá R·ªß** (**Tasukeru**) c·ª©u gi√∫p.", ctx: ["‰∫∫","ÂëΩ","ÂèãÈÅî"] },
            { k: "È†º„ÇÄ", h: "„Åü„ÅÆ„ÇÄ", m: "nh·ªù v·∫£", t: 1, ti: "Ki·∫øm ti·ªÅn (**Ë≤ù**) r·ªìi b√≥ (**Êùü**) ƒë·ªì l·∫°i ƒë·ªôi l√™n ƒë·∫ßu (**È†Å**) ƒëi ·ª∑ **L·∫†I** (nh·ªù v·∫£).", ta: "**Ta N√¥ M≈©** (**Tanomu**) nh·ªù v·∫£ c·∫ßm h·ªô.", ctx: ["‰ªï‰∫ã","„Çø„ÇØ„Ç∑„Éº","ÊØç"] },
            { k: "Ë™ò„ÅÜ", h: "„Åï„Åù„ÅÜ", m: "m·ªùi/r·ªß", t: 1, ti: "D√πng l·ªùi (**Ë®Ä**) ƒë∆∞·ªùng m·∫≠t d·ª• d·ªó ng∆∞·ªùi ∆∞u t√∫ (**ÁßÄ**) l√† **D·ª§** ho·∫∑c.", ta: "**Xa X√¥i U** (**Sasou**) v·∫´n m·ªùi m·ªçc.", ctx: ["Êò†Áîª","„Éá„Éº„Éà","È£ü‰∫ã"] },
            { k: "Ëøé„Åà„Çã", h: "„ÇÄ„Åã„Åà„Çã", m: "ƒë√≥n", t: 2, ti: "V·ª´a ƒëi (**‚ªå**) v·ª´a ng·∫©ng cao ƒë·∫ßu (**Âç¨**) ƒë√≥n ti·∫øp **NGH√äNH** di·ªán.", ta: "**M·ª• C√° √ä R·ªß** (**Mukaeru**) ra ƒë√≥n kh√°ch.", ctx: ["Ê≠£Êúà","ÂÆ¢","Êò•"] },
            { k: "‰ºö„ÅÜ", h: "„ÅÇ„ÅÜ", m: "g·∫∑p", t: 1, ti: "Ng∆∞·ªùi (**‰∫∫**) t·ª• h·ªçp n√≥i chuy·ªán nh∆∞ m√¢y (**‰∫ë**) bay l√† **H·ªòI** ng·ªô.", ta: "**A U** (**Au**) g·∫∑p.", ctx: ["ÊÅã‰∫∫","ÈßÖ","ÂÅ∂ÁÑ∂"] },
            
            // 9. Others
            { k: "Êúâ„Çã", h: "„ÅÇ„Çã", m: "c√≥ (v·∫≠t)", t: 1, ti: "Tay (**†Çá**) c·∫ßm mi·∫øng th·ªãt (**Êúà**) l√† S·ªü **H·ªÆU** trong tay.", ta: "**A! R·ªß** (**Aru**) nhau c√≥ ƒë·ªì ch∆°i.", ctx: ["„ÅäÈáë","ÊôÇÈñì","Á¥ÑÊùü"] },
            { k: "Â±Ö„Çã", h: "„ÅÑ„Çã", m: "c√≥ (ng∆∞·ªùi)", t: 2, ti: "X√°c ch·∫øt (**Â∞∏**) c·ªï (**Âè§**) v·∫´n **C∆Ø** tr√∫.", ta: "**I** nh∆∞ **R·ªß** (**Iru**) c√≥.", ctx: ["Â≠ê‰æõ","ÂΩºÂ•≥","Êó•Êú¨"] },
            { k: "Ê≠ª„Å¨", h: "„Åó„Å¨", m: "ch·∫øt", t: 1, ti: "X∆∞∆°ng t√†n (**Ê≠π**) g·∫∑p dao gƒÉm (**Âåï**) l√† **T·ª¨**.", ta: "**Si N·ªØ** (**Shinu**) ch·∫øt v√¨ t√¨nh.", ctx: ["È≠ö","ÁóÖÊ∞ó","‰∫ãÊïÖ"] },
            { k: "Áîü„Åæ„Çå„Çã", h: "„ÅÜ„Åæ„Çå„Çã", m: "sinh ra", t: 2, ti: "**SINH** s√¥i n·∫£y n·ªü.", ta: "**U M√° R·ªÉ R·ªß** (**Umareru**) sinh con.", ctx: ["Ëµ§„Å°„ÇÉ„Çì","1990Âπ¥","Êù±‰∫¨"] },
            { k: "Âßã„Åæ„Çã", h: "„ÅØ„Åò„ÇÅ„Çã", m: "b·∫Øt ƒë·∫ßu", t: 2, ti: "Ng∆∞·ªùi ph·ª• N·ªØ (**Â•≥**) ƒë·ª©ng tr√™n b·ª•c ƒê√†i (**Âè∞**) ƒë·ªÉ b·∫Øt ƒë·∫ßu (kh·ªüi **TH·ª¶Y**) bu·ªïi l·ªÖ.", ta: "**H·∫£? Chi M√™ R·ªß** (**Hajimeru**) b·∫Øt ƒë·∫ßu y√™u.", ctx: ["ÊéàÊ•≠","‰ºöË≠∞","Êñ∞ÁîüÊ¥ª"] },
            { k: "ÁµÇ„Çè„Çã", h: "„Åä„Çè„Çã", m: "k·∫øt th√∫c", t: 1, ti: "S·ª£i T∆° (**Á≥∏**) d·ªát xong v√†o m√πa ƒê√¥ng (**ÂÜ¨**) l√† **CHUNG** k·∫øt.", ta: "**√î! Wa R·ªß** (**Owaru**) h·∫øt.", ctx: ["‰ªï‰∫ã","Â§è‰ºë„Åø","„ÉÜ„Çπ„Éà"] },
            { k: "Ê±∫„ÇÅ„Çã", h: "„Åç„ÇÅ„Çã", m: "quy·∫øt ƒë·ªãnh", t: 2, ti: "D√≤ng N∆∞·ªõc (**Ê∞µ**) kho√©t (**Â§¨**) s√¢u **QUY·∫æT** li·ªát kh∆°i th√¥ng.", ta: "**K√¨ M√™ R·ªß** (**Kimeru**) quy·∫øt.", ctx: ["ÈÄ≤Ë∑Ø","Êó•‰ªò","ÂøÉ"] },
            { k: "Â§â„Åà„Çã", h: "„Åã„Åà„Çã", m: "thay ƒë·ªïi", t: 2, ti: "M·ªçi th·ª© (**‰∫¶**) b·ªã ƒë√°nh (**Êîµ**) n√™n thay ƒë·ªïi **BI·∫æN** d·∫°ng.", ta: "**C√° ·∫æ R·ªß** (**Kaeru**) ƒë·ªïi.", ctx: ["È´™Âûã","‰∫àÂÆö","Êúç"] },
            { k: "Âí≤„Åè", h: "„Åï„Åè", m: "n·ªü (hoa)", t: 1, ti: "Mi·ªáng (**Âè£**) c∆∞·ªùi (**ÂÖ≥**) t∆∞∆°i nh∆∞ hoa n·ªü l√† **TI·∫æU**.", ta: "**Sa C·ª•** (**Saku**) hoa n·ªü r·ªìi.", ctx: ["Ê°ú","Ëä±","Â∫≠"] },
            { k: "Èôç„Çã", h: "„Åµ„Çã", m: "r∆°i (m∆∞a)", t: 1, ti: "G√≤ ƒë·∫•t (**Èòù**) c√≥ b∆∞·ªõc ch√¢n (**Â§Ö**) ƒëi xu·ªëng l√† **GI√ÅNG** tr·∫ßn.", ta: "**Ph√π R·ªß** (**Furu**) r∆°i.", ctx: ["Èõ®","Èõ™","Êòü"] },
            { k: "ÂΩπÁ´ã„Å§", h: "„ÇÑ„Åè„Å´„Åü„Å§", m: "c√≥ √≠ch", t: 1, ti: "ƒêi (**ÂΩ≥**) c·∫ßm binh kh√≠ (**ÊÆ≥**) l√†m chi·∫øn **D·ªäCH** c√≥ √≠ch.", ta: "**Yaku** **Ni** **Tatsu**.", ctx: ["Á§æ‰ºö","‰ªï‰∫ã","ÂãâÂº∑"] },
            { k: "Ê≠å„ÅÜ", h: "„ÅÜ„Åü„ÅÜ", m: "h√°t", t: 1, ti: "Hai anh Kh·∫£ (**ÂèØ**) h√° mi·ªáng ng√°p (**Ê¨†**) ƒë·ªÉ **CA** h√°t.", ta: "**U Ta U** (**Utau**) h√°t.", ctx: ["„Ç´„É©„Ç™„Ç±","Ê≠å","Â§ßÂ£∞"] },
            { k: "ÈÅä„Å∂", h: "„ÅÇ„Åù„Å∂", m: "ch∆°i", t: 1, ti: "ƒê·ª©a T·ª≠ (**Â≠ê**) c·∫ßm c·ªù Vu√¥ng (**Êñπ**) ch·∫°y lƒÉng xƒÉng (**‚ªå**) ƒëi **DU** ch∆°i.", ta: "**A! X√¥ B·ª±** (**Asobu**) ch∆°i.", ctx: ["ÂÖ¨Âúí","„Ç≤„Éº„É†","ÂèãÈÅî"] },
            { k: "Ê≥≥„Åê", h: "„Åä„Çà„Åê", m: "b∆°i", t: 1, ti: "·ªû d∆∞·ªõi N∆∞·ªõc (**Ê∞µ**) b∆°i m√£i m√£i (Vƒ©nh - **Ê∞∏**) kh√¥ng th√¥i l√† **V·ªäNH**.", ta: "**Ong D√¥ Gu** (**Oyogu**) b∆°i.", ctx: ["Êµ∑","„Éó„Éº„É´","50„É°„Éº„Éà„É´"] },
            { k: "„Åô„Çã", h: "„Åô„Çã", m: "l√†m", t: 3, ti: "(Th∆∞·ªùng d√πng Kana).", ta: "**S∆∞** (**Suru**) th·∫ßy l√†m.", ctx: ["ÂÆøÈ°å","„ÉÜ„Éã„Çπ","ÈõªË©±"] },
            { k: "„ÇÑ„Çã", h: "„ÇÑ„Çã", m: "l√†m/cho", t: 1, ti: "(Th∆∞·ªùng d√πng Kana).", ta: "**Ya** (**Yaru**) l√† l√†m.", ctx: ["ÂÆøÈ°å","Ê∞ó","‰ªï‰∫ã"] },
            { k: "Âôõ„ÇÄ", h: "„Åã„ÇÄ", m: "c·∫Øn, nhai", t: 1, ti: "Mi·ªáng (**Âè£**) d√πng rƒÉng (**Ê≠Ø**) ƒë·ªÉ **C·∫ÆN** (**C·∫¢O**).", ta: "**C√° M√∫** (**Kamu**) c·∫Øn.", ctx: ["„Ç¨„É†","Áä¨","Êåá"] },
            { k: "ÂΩπ„Å´Á´ã„Å§", h: "„ÇÑ„Åè„Å´„Åü„Å§", m: "c√≥ √≠ch", t: 1, ti: "Chi·∫øn **D·ªäCH** thi·∫øt **L·∫¨P**.", ta: "**Yaku Ni Tatsu**.", ctx: ["Êú¨","ÁµåÈ®ì","ËæûÊõ∏"] },
            { k: "„Åã„Åã„Çã", h: "„Åã„Åã„Çã", m: "t·ªën (th·ªùi gian/ti·ªÅn)", t: 1, ti: "(Th∆∞·ªùng d√πng Kana).", ta: "**Ca Ca R·ªß** (**Kakaru**).", ctx: ["ÊôÇÈñì","„ÅäÈáë","Ëø∑ÊÉë"] }
        ];

        // --- GRAMMAR RICH EXAMPLES (Based on N5-N3 Grammar Doc) ---
        const specificExamples = {
            "Ë°å„Åè": {
                dict: { ex: "Â§è‰ºë„Åø„ÅØ„Å©„Åì„ÅãË°å„Åç„Åæ„Åô„Åã„ÄÇ", romaji: "Natsuyasumi wa dokoka ikimasu ka.", mean: "Ngh·ªâ h√® b·∫°n c√≥ ƒëi ƒë√¢u kh√¥ng? (N5 - dokoka)." },
                masu: { ex: "ÂèãÈÅî„Å´‰ºö„ÅÑ„Å´Ë°å„Åç„Åæ„Åô„ÄÇ", romaji: "Tomodachi ni ai ni ikimasu.", mean: "ƒêi g·∫∑p b·∫°n (N5 - ni iku)." },
                te: { ex: "„Åæ„Å£„Åô„ÅêË°å„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Massugu itte kudasai.", mean: "H√£y ƒëi th·∫≥ng (N5 - te kudasai)." },
                ta: { ex: "Êó•Êú¨„Å∏Ë°å„Å£„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„Åã„ÄÇ", romaji: "Nihon e itta koto ga arimasu ka.", mean: "B·∫°n ƒë√£ t·ª´ng ƒëi Nh·∫≠t ch∆∞a? (N4 - ta koto ga aru)." },
                nai: { ex: "„Å©„Åì„ÇÇË°å„Åã„Å™„ÅÑ„Å§„ÇÇ„Çä„Åß„Åô„ÄÇ", romaji: "Dokomo ikanai tsumori desu.", mean: "T√¥i ƒë·ªãnh kh√¥ng ƒëi ƒë√¢u c·∫£ (N4 - tsumori)." },
                potential: { ex: "‰∏Ä‰∫∫„ÅßË°å„Åë„Çã„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ", romaji: "Hitori de ikeru to omoimasu.", mean: "T√¥i nghƒ© m√¨nh c√≥ th·ªÉ ƒëi m·ªôt m√¨nh (N4 - to omou)." },
                volitional: { ex: "‰∏ÄÁ∑í„Å´Êò†Áîª„ÇíË¶ã„Å´Ë°å„Åì„ÅÜ„ÄÇ", romaji: "Issho ni eiga o mi ni ik≈ç.", mean: "C√πng ƒëi xem phim n√†o (N5 - volitional)." },
                conditional: { ex: "Êó©„ÅèË°å„Åë„Å∞„ÄÅÈñì„Å´Âêà„ÅÜ„Åß„Åó„Çá„ÅÜ„ÄÇ", romaji: "Hayaku ikeba, maniau desh≈ç.", mean: "N·∫øu ƒëi s·ªõm ch·∫Øc s·∫Ω k·ªãp (N4 - deshou)." }
            },
            "È£ü„Åπ„Çã": {
                dict: { ex: "È£ü„Åπ„ÇãÂâç„Å´Êâã„ÇíÊ¥ó„ÅÑ„Åæ„Åô„ÄÇ", romaji: "Taberu mae ni te o araimasu.", mean: "R·ª≠a tay tr∆∞·ªõc khi ƒÉn (N5 - mae ni)." },
                masu: { ex: "„ÇÇ„ÅÜÊòº„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Åæ„Åó„Åü„Åã„ÄÇ", romaji: "M≈ç hirugohan o tabemashita ka.", mean: "B·∫°n ƒë√£ ƒÉn tr∆∞a ch∆∞a? (N5 - mou)." },
                te: { ex: "ÈáéËèú„ÇÇÈ£ü„Åπ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Yasai mo tabete kudasai.", mean: "H√£y ƒÉn c·∫£ rau n·ªØa (N5 - te kudasai)." },
                ta: { ex: "È£ü„Åπ„ÅüÂæå„Åß„ÄÅËñ¨„ÇíÈ£≤„Åø„Åæ„Åô„ÄÇ", romaji: "Tabeta ato de, kusuri o nomimasu.", mean: "Sau khi ƒÉn xong s·∫Ω u·ªëng thu·ªëc (N5 - ato de)." },
                nai: { ex: "Êúù„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„Å™„ÅÑ„ÅßÂ≠¶Ê†°„Å∏Êù•„Åæ„Åó„Åü„ÄÇ", romaji: "Asagohan o tabenai de gakk≈ç e kimashita.", mean: "ƒê·∫øn tr∆∞·ªùng m√† kh√¥ng ƒÉn s√°ng (N4 - nai de)." },
                potential: { ex: "Á¥çË±Ü„ÅåÈ£ü„Åπ„Çâ„Çå„Åæ„Åô„Åã„ÄÇ", romaji: "Natt≈ç ga taberaremasu ka.", mean: "B·∫°n c√≥ ƒÉn ƒë∆∞·ª£c Natto kh√¥ng? (N4 - potential)." },
                volitional: { ex: "ÁæéÂë≥„Åó„ÅÑ„ÇÇ„ÅÆ„ÇíÈ£ü„Åπ„Çà„ÅÜ„ÄÇ", romaji: "Oishii mono o tabey≈ç.", mean: "H√£y c√πng ƒÉn m√≥n g√¨ ngon ƒëi (N5 - volitional)." },
                conditional: { ex: "È£ü„Åπ„Çå„Å∞„Çè„Åã„Çä„Åæ„Åô„ÄÇ", romaji: "Tabereba wakarimasu.", mean: "ƒÇn th·ª≠ l√† bi·∫øt ngay (N4 - conditional)." }
            },
            "Ë≤∑„ÅÜ": {
                dict: { ex: "Êñ∞„Åó„ÅÑËªä„ÇíË≤∑„ÅÜ‰∫àÂÆö„Åß„Åô„ÄÇ", romaji: "Atarashii kuruma o kau yotei desu.", mean: "T√¥i d·ª± ƒë·ªãnh mua xe m·ªõi (N4 - yotei)." },
                masu: { ex: "„Åì„Çå„ÇíË≤∑„ÅÑ„Åæ„Åô„ÄÇ", romaji: "Kore o kaimasu.", mean: "T√¥i s·∫Ω mua c√°i n√†y." },
                te: { ex: "„ÉÅ„Ç±„ÉÉ„Éà„ÇíË≤∑„Å£„Å¶„Åä„Åç„Åæ„Åô„ÄÇ", romaji: "Chiketto o katte okimasu.", mean: "T√¥i s·∫Ω mua v√© s·∫µn (N4 - te oku)." },
                ta: { ex: "„Å§„ÅÑ„ÄÅÈ´ò„ÅÑÊúç„ÇíË≤∑„Å£„Å¶„Åó„Åæ„Å£„Åü„ÄÇ", romaji: "Tsui, takai fuku o katte shimatta.", mean: "L·ª° tay mua b·ªô ƒë·ªì ƒë·∫Øt ti·ªÅn m·∫•t r·ªìi (N4 - te shimau)." },
                nai: { ex: "È´ò„ÅÑ„Åã„ÇâË≤∑„Çè„Å™„ÅÑ„Åì„Å®„Å´„Åó„Åæ„Åó„Åü„ÄÇ", romaji: "Takai kara kawanai koto ni shimashita.", mean: "V√¨ ƒë·∫Øt n√™n t√¥i quy·∫øt ƒë·ªãnh kh√¥ng mua (N4 - koto ni suru)." },
                potential: { ex: "„Éç„ÉÉ„Éà„ÅßË≤∑„Åà„Åæ„Åô„ÄÇ", romaji: "Netto de kaemasu.", mean: "C√≥ th·ªÉ mua tr√™n m·∫°ng." },
                volitional: { ex: "„ÅäÂúüÁî£„ÇíË≤∑„Åä„ÅÜ„ÄÇ", romaji: "Omiyage o ka≈ç.", mean: "Mua qu√† l∆∞u ni·ªám n√†o." },
                conditional: { ex: "ÂÆâ„Åë„Çå„Å∞Ë≤∑„ÅÑ„Åæ„Åô„ÄÇ", romaji: "Yasukereba kaimasu.", mean: "N·∫øu r·∫ª th√¨ t√¥i s·∫Ω mua." }
            },
            "Ë¶ã„Çã": {
                dict: { ex: "Êò†Áîª„ÇíË¶ã„Çã„ÅÆ„ÅåÂ•Ω„Åç„Åß„Åô„ÄÇ", romaji: "Eiga o miru no ga suki desu.", mean: "T√¥i th√≠ch xem phim (N5 - no ga suki)." },
                masu: { ex: "„ÉÜ„É¨„Éì„ÇíË¶ã„Å™„Åå„Çâ„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Åæ„Åô„ÄÇ", romaji: "Terebi o minagara gohan o tabemasu.", mean: "V·ª´a xem tivi v·ª´a ƒÉn c∆°m (N4 - nagara)." },
                te: { ex: "„Å°„Çá„Å£„Å®Ë¶ã„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Chotto mite mite kudasai.", mean: "H√£y th·ª≠ nh√¨n xem (N4 - te miru)." },
                ta: { ex: "Ê°ú„ÇíË¶ã„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„Åã„ÄÇ", romaji: "Sakura o mita koto ga arimasu ka.", mean: "B·∫°n ƒë√£ t·ª´ng ng·∫Øm hoa anh ƒë√†o ch∆∞a? (N4 - ta koto ga aru)." },
                nai: { ex: "ÊÄñ„ÅÑÊò†Áîª„ÅØË¶ã„Å™„ÅÑ„Åª„ÅÜ„Åå„ÅÑ„ÅÑ„Åß„Åô„ÄÇ", romaji: "Kowai eiga wa minai h≈ç ga ii desu.", mean: "Kh√¥ng n√™n xem phim ma th√¨ h∆°n (N4 - hou ga ii)." },
                potential: { ex: "„Åì„Åì„Åã„ÇâÂØåÂ£´Â±±„ÅåË¶ã„Åà„Åæ„Åô„ÄÇ", romaji: "Koko kara Fuji-san ga miemasu.", mean: "T·ª´ ƒë√¢y c√≥ th·ªÉ nh√¨n th·∫•y n√∫i Ph√∫ Sƒ© (N4 - miemasu)." },
                volitional: { ex: "‰∏ÄÁ∑í„Å´Ë¶ã„Çà„ÅÜ„ÄÇ", romaji: "Issho ni miy≈ç.", mean: "C√πng xem nh√©." },
                conditional: { ex: "„Çà„ÅèË¶ã„Çå„Å∞„Çè„Åã„Çä„Åæ„Åô„ÄÇ", romaji: "Yoku mireba wakarimasu.", mean: "N·∫øu nh√¨n k·ªπ s·∫Ω hi·ªÉu." }
            },
            "Êõ∏„Åè": {
                dict: { ex: "Êº¢Â≠ó„ÇíÊõ∏„Åè„ÅÆ„ÅØÈõ£„Åó„ÅÑ„Åß„Åô„ÄÇ", romaji: "Kanji o kaku no wa muzukashii desu.", mean: "Vi·∫øt Kanji th·∫≠t kh√≥ (N5 - no wa...)." },
                masu: { ex: "ÂÖàÁîü„ÅÆË®Ä„Å£„ÅüÈÄö„Çä„Å´Êõ∏„Åç„Åæ„Åô„ÄÇ", romaji: "Sensei no itta toori ni kakimasu.", mean: "Vi·∫øt theo ƒë√∫ng l·ªùi th·∫ßy n√≥i (N3 - toori ni)." },
                te: { ex: "„Åì„Åì„Å´ÂêçÂâç„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Koko ni namae o kaite kudasai.", mean: "H√£y vi·∫øt t√™n v√†o ƒë√¢y." },
                ta: { ex: "„É¨„Éù„Éº„Éà„ÅØ„ÇÇ„ÅÜÊõ∏„Åç„Åæ„Åó„Åü„Åã„ÄÇ", romaji: "Rep≈çto wa m≈ç kakimashita ka.", mean: "B·∫°n ƒë√£ vi·∫øt b√°o c√°o ch∆∞a?" },
                nai: { ex: "„Éú„Éº„É´„Éö„É≥„ÅßÊõ∏„Åã„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "B≈çrupen de kakanaide kudasai.", mean: "Xin ƒë·ª´ng vi·∫øt b·∫±ng b√∫t bi (N5 - nai de)." },
                potential: { ex: "Êº¢Â≠ó„ÅåÊõ∏„Åë„Åæ„Åô„ÄÇ", romaji: "Kanji ga kakemasu.", mean: "T√¥i c√≥ th·ªÉ vi·∫øt Kanji." },
                volitional: { ex: "Êó•Ë®ò„ÇíÊõ∏„Åì„ÅÜ„Å®ÊÄù„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ", romaji: "Nikki o kak≈ç to omotte imasu.", mean: "T√¥i ƒë·ªãnh vi·∫øt nh·∫≠t k√Ω (N4 - to omotte iru)." },
                conditional: { ex: "Êõ∏„Åë„Å∞Ë¶ö„Åà„Åæ„Åô„ÄÇ", romaji: "Kakeba oboemasu.", mean: "N·∫øu vi·∫øt s·∫Ω nh·ªõ." }
            },
            "„Åô„Çã": {
                dict: { ex: "ÈÅãÂãï„Åô„Çã„Åì„Å®„ÅØÂÅ•Â∫∑„Å´„ÅÑ„ÅÑ„ÄÇ", romaji: "Und≈ç suru koto wa kenk≈ç ni ii.", mean: "V·∫≠n ƒë·ªông t·ªët cho s·ª©c kh·ªèe (N5 - koto)." },
                masu: { ex: "ÊòéÊó•„ÉÜ„Éã„Çπ„Çí„Åó„Åæ„Åô„ÄÇ", romaji: "Ashita tenisu o shimasu.", mean: "Ng√†y mai t√¥i ch∆°i tennis." },
                te: { ex: "ÊéÉÈô§„Çí„Åó„Å¶„Åã„ÇâÂá∫„Åã„Åë„Åæ„Åô„ÄÇ", romaji: "S≈çji o shite kara dekakemasu.", mean: "D·ªçn d·∫πp xong r·ªìi m·ªõi ra ngo√†i (N5 - te kara)." },
                ta: { ex: "ÂÆøÈ°å„Çí„Åó„Åü„Åª„ÅÜ„Åå„ÅÑ„ÅÑ„Åß„Åô„ÄÇ", romaji: "Shukudai o shita h≈ç ga ii desu.", mean: "N√™n l√†m b√†i t·∫≠p v·ªÅ nh√† th√¨ h∆°n (N4 - hou ga ii)." },
                nai: { ex: "ÁÑ°ÁêÜ„Çí„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Muri o shinaide kudasai.", mean: "Xin ƒë·ª´ng qu√° s·ª©c." },
                potential: { ex: "Êó•Êú¨Ë™û„Åå„Åß„Åç„Åæ„Åô„ÄÇ", romaji: "Nihongo ga dekimasu.", mean: "T√¥i bi·∫øt ti·∫øng Nh·∫≠t (N4 - dekimasu)." },
                volitional: { ex: "ÁµêÂ©ö„Åó„Çà„ÅÜ„ÄÇ", romaji: "Kekkon shiy≈ç.", mean: "Ch√∫ng m√¨nh k·∫øt h√¥n nh√©." },
                conditional: { ex: "Á∑¥Áøí„Åô„Çå„Å∞‰∏äÊâã„Å´„Å™„Çä„Åæ„Åô„ÄÇ", romaji: "Rensh≈´ sureba j≈çzu ni narimasu.", mean: "N·∫øu luy·ªán t·∫≠p s·∫Ω gi·ªèi l√™n (N4 - narimasu)." }
            },
            "Êù•„Çã": {
                dict: { ex: "ÂΩº„ÅåÊù•„Çã„ÅØ„Åö„Åß„Åô„ÄÇ", romaji: "Kare ga kuru hazu desu.", mean: "Ch·∫Øc ch·∫Øn anh ·∫•y s·∫Ω ƒë·∫øn (N4 - hazu)." },
                masu: { ex: "ÂÖàÁîü„ÅåÊù•„Åæ„Åô„ÄÇ", romaji: "Sensei ga kimasu.", mean: "Th·∫ßy gi√°o ƒë·∫øn." },
                te: { ex: "Êó©„ÅèÊù•„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Hayaku kite kudasai.", mean: "H√£y ƒë·∫øn nhanh l√™n." },
                ta: { ex: "„Éê„Çπ„ÅåÊù•„Åæ„Åó„Åü„ÄÇ", romaji: "Basu ga kimashita.", mean: "Xe bu√Ωt ƒë·∫øn r·ªìi." },
                nai: { ex: "„Å™„Åã„Å™„ÅãÊù•„Åæ„Åõ„Çì„ÄÇ", romaji: "Nakanaka kimasen.", mean: "M√£i m√† kh√¥ng th·∫•y ƒë·∫øn (N5 - nakanaka)." },
                potential: { ex: "ÊòéÊó•Êù•„Çâ„Çå„Åæ„Åô„Åã„ÄÇ", romaji: "Ashita koraremasu ka.", mean: "Mai b·∫°n ƒë·∫øn ƒë∆∞·ª£c kh√¥ng?" },
                volitional: { ex: "„Åæ„ÅüÊù•„Çà„ÅÜ„ÄÇ", romaji: "Mata koy≈ç.", mean: "L·∫ßn sau l·∫°i ƒë·∫øn nh√©." },
                conditional: { ex: "Êò•„ÅåÊù•„Çå„Å∞Ëä±„ÅåÂí≤„Åç„Åæ„Åô„ÄÇ", romaji: "Haru ga kureba hana ga sakimasu.", mean: "N·∫øu m√πa xu√¢n ƒë·∫øn hoa s·∫Ω n·ªü." }
            },
            "Ë©±„Åô": {
                dict: { ex: "Êó•Êú¨Ë™û„ÇíË©±„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ", romaji: "Nihongo o hanasu koto ga dekimasu.", mean: "T√¥i c√≥ th·ªÉ n√≥i ti·∫øng Nh·∫≠t (N5 - koto ga dekiru)." },
                masu: { ex: "ÂÖàÁîü„Å®Ë©±„Åó„Åæ„Åô„ÄÇ", romaji: "Sensei to hanashimasu.", mean: "N√≥i chuy·ªán v·ªõi th·∫ßy." },
                te: { ex: "„ÇÇ„Å£„Å®„ÇÜ„Å£„Åè„ÇäË©±„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", romaji: "Motto yukkuri hanashite kudasai.", mean: "H√£y n√≥i ch·∫≠m h∆°n." },
                ta: { ex: "Á§æÈï∑„Å®Ë©±„Åó„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", romaji: "Shach≈ç to hanashita koto ga arimasu.", mean: "T√¥i t·ª´ng n√≥i chuy·ªán v·ªõi gi√°m ƒë·ªëc (N4 - ta koto ga aru)." },
                nai: { ex: "ÁßòÂØÜ„ÅØË©±„Åï„Å™„ÅÑ„Å§„ÇÇ„Çä„Åß„Åô„ÄÇ", romaji: "Himitsu wa hanasanai tsumori desu.", mean: "T√¥i ƒë·ªãnh s·∫Ω kh√¥ng n√≥i b√≠ m·∫≠t ƒë√¢u (N4 - tsumori)." },
                potential: { ex: "Ëã±Ë™û„ÅåË©±„Åõ„Åæ„Åô„ÄÇ", romaji: "Eigo ga hanasemasu.", mean: "T√¥i n√≥i ƒë∆∞·ª£c ti·∫øng Anh." },
                volitional: { ex: "„ÅÇ„Å®„ÅßË©±„Åù„ÅÜ„ÄÇ", romaji: "Atode hanas≈ç.", mean: "ƒê·ªÉ sau h·∫µng n√≥i." },
                conditional: { ex: "Ë©±„Åõ„Å∞„Çè„Åã„Çä„Åæ„Åô„ÄÇ", romaji: "Hanaseba wakarimasu.", mean: "N·∫øu n√≥i chuy·ªán s·∫Ω hi·ªÉu nhau." }
            }
        };

        // --- DYNAMIC GRAMMAR GENERATOR (FALLBACK) ---
        function getExamples(word, forms) {
            const m = word.m.toLowerCase();
            const ctx = word.ctx || ["„Åù„Çå", "ÊØéÊó•", "Êò®Êó•"]; // Fallback context
            const specific = specificExamples[word.k];
            
            if(specific) {
                return [
                    { f: forms.dict, j: specific.dict.ex, r: specific.dict.romaji, v: specific.dict.mean },
                    { f: forms.masu, j: specific.masu.ex, r: specific.masu.romaji, v: specific.masu.mean },
                    { f: forms.te, j: specific.te.ex, r: specific.te.romaji, v: specific.te.mean },
                    { f: forms.ta, j: specific.ta.ex, r: specific.ta.romaji, v: specific.ta.mean },
                    { f: forms.nai, j: specific.nai.ex, r: specific.nai.romaji, v: specific.nai.mean },
                    { f: forms.pot, j: specific.potential.ex, r: specific.potential.romaji, v: specific.potential.mean },
                    { f: forms.vol, j: specific.volitional.ex, r: specific.volitional.romaji, v: specific.volitional.mean },
                    { f: forms.cond, j: specific.conditional.ex, r: specific.conditional.romaji, v: specific.conditional.mean }
                ];
            }
            
            // Randomly select one context word for variety
            const getCtx = () => ctx[Math.floor(Math.random() * ctx.length)];

            const patterns = {
                dict: [
                    { j: `${getCtx()}„Çí${forms.dict}„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ`, r: `... koto ga dekimasu.`, v: `C√≥ th·ªÉ ${word.m} (N5 - Kh·∫£ nƒÉng).` },
                    { j: `${getCtx()}„Çí${forms.dict}„Å§„ÇÇ„Çä„Åß„Åô„ÄÇ`, r: `... tsumori desu.`, v: `D·ª± ƒë·ªãnh s·∫Ω ${word.m} (N4 - √ù ƒë·ªãnh).` },
                    { j: `${forms.dict}Ââç„Å´„ÄÅÊ∫ñÂÇô„Åó„Åæ„Åô„ÄÇ`, r: `... mae ni, junbi shimasu.`, v: `Tr∆∞·ªõc khi ${word.m} th√¨ chu·∫©n b·ªã (N5 - Th·ªùi gian).` },
                    { j: `${forms.dict}„ÅÆ„ÅåÂ•Ω„Åç„Åß„Åô„ÄÇ`, r: `... no ga suki desu.`, v: `Th√≠ch vi·ªác ${word.m} (N5 - Danh t·ª´ h√≥a).` },
                    { j: `${forms.dict}„Çà„ÅÜ„Å´„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ`, r: `... you ni shiteimasu.`, v: `ƒêang c·ªë g·∫Øng ${word.m} (N4 - Th√≥i quen).` }
                ],
                masu: [
                    { j: `${forms.masu.replace('„Åæ„Åô', '')}„Åô„Åé„Åæ„Åó„Åü„ÄÇ`, r: `... sugimashita.`, v: `ƒê√£ ${word.m} qu√° nhi·ªÅu (N4 - M·ª©c ƒë·ªô).` },
                    { j: `${forms.masu.replace('„Åæ„Åô', '')}„Å´„Åè„ÅÑ„Åß„Åô„ÄÇ`, r: `... nikui desu.`, v: `Kh√≥ ${word.m} (N4 - T√≠nh ch·∫•t).` },
                    { j: `${forms.masu.replace('„Åæ„Åô', '')}„ÇÑ„Åô„ÅÑ„Åß„Åô„ÄÇ`, r: `... yasui desu.`, v: `D·ªÖ ${word.m} (N4 - T√≠nh ch·∫•t).` },
                    { j: `${forms.masu.replace('„Åæ„Åô', '')}„Å™„Åå„ÇâË©±„Åó„Åæ„Åô„ÄÇ`, r: `... nagara hanashimasu.`, v: `V·ª´a ${word.m} v·ª´a n√≥i chuy·ªán (N4 - ƒê·ªìng th·ªùi).` },
                    { j: `${forms.masu.replace('„Åæ„Åô', '')}„Åü„ÅÑ„Åß„Åô„ÄÇ`, r: `... tai desu.`, v: `Mu·ªën ${word.m} (N5 - Mong mu·ªën).` }
                ],
                te: [
                    { j: `${forms.te}„Åó„Åæ„ÅÑ„Åæ„Åó„Åü„ÄÇ`, r: `... shimaimashita.`, v: `L·ª° ${word.m} m·∫•t r·ªìi / ƒê√£ ${word.m} xong (N4 - Ho√†n th√†nh/H·ªëi ti·∫øc).` },
                    { j: `${forms.te}„Åø„Åæ„Åô„ÄÇ`, r: `... mimasu.`, v: `Th·ª≠ ${word.m} xem sao (N4 - Th·ª≠).` },
                    { j: `${forms.te}„ÅØ„ÅÑ„Åë„Åæ„Åõ„Çì„ÄÇ`, r: `... wa ikemasen.`, v: `C·∫•m ${word.m} (N5 - C·∫•m ƒëo√°n).` },
                    { j: `${forms.te}„Åè„Å†„Åï„ÅÑ„ÄÇ`, r: `... kudasai.`, v: `H√£y ${word.m} ƒëi (N5 - Y√™u c·∫ßu).` },
                    { j: `${forms.te}„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„Åã„ÄÇ`, r: `... mo ii desu ka.`, v: `${word.m} ƒë∆∞·ª£c kh√¥ng? (N5 - Xin ph√©p).` }
                ],
                ta: [
                    { j: `${forms.ta}„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„Åã„ÄÇ`, r: `... koto ga arimasu ka.`, v: `ƒê√£ t·ª´ng ${word.m} bao gi·ªù ch∆∞a? (N4 - Kinh nghi·ªám).` },
                    { j: `${forms.ta}„Åª„ÅÜ„Åå„ÅÑ„ÅÑ„Åß„Åô„ÄÇ`, r: `... h≈ç ga ii desu.`, v: `N√™n ${word.m} th√¨ h∆°n (N4 - L·ªùi khuy√™n).` },
                    { j: `${forms.ta}Âæå„Åß„ÄÅÈõªË©±„Åó„Åæ„Åô„ÄÇ`, r: `... ato de, denwa shimasu.`, v: `Sau khi ${word.m} s·∫Ω g·ªçi ƒëi·ªán (N5 - Th·ªùi gian).` },
                    { j: `${forms.ta}„Çä„ÄÅÂØù„Åü„Çä„Åó„Åæ„Åô„ÄÇ`, r: `... ri, netari shimasu.`, v: `L√∫c th√¨ ${word.m}, l√∫c th√¨ ng·ªß (N5 - Li·ªát k√™).` },
                    { j: `${forms.ta}„Å∞„Åã„Çä„Åß„Åô„ÄÇ`, r: `... bakari desu.`, v: `V·ª´a m·ªõi ${word.m} xong (N4 - V·ª´a xong).` }
                ],
                nai: [
                    { j: `${forms.nai}„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ`, r: `... de kudasai.`, v: `Xin ƒë·ª´ng ${word.m} (N5 - Y√™u c·∫ßu).` },
                    { j: `${forms.nai}„Åª„ÅÜ„Åå„ÅÑ„ÅÑ„Åß„Åô„ÄÇ`, r: `... h≈ç ga ii desu.`, v: `Kh√¥ng n√™n ${word.m} (N4 - L·ªùi khuy√™n).` },
                    { j: `${forms.nai}„Å§„ÇÇ„Çä„Åß„Åô„ÄÇ`, r: `... tsumori desu.`, v: `ƒê·ªãnh s·∫Ω kh√¥ng ${word.m} (N4 - √ù ƒë·ªãnh).` },
                    { j: `${forms.nai}„Å®„ÄÅÂõ∞„Çä„Åæ„Åô„ÄÇ`, r: `... to, komarimasu.`, v: `H·ªÖ kh√¥ng ${word.m} l√† r·∫Øc r·ªëi ƒë·∫•y (N5 - ƒêi·ªÅu ki·ªán).` },
                    { j: `${forms.nai}„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„ÄÇ`, r: `... kereba narimasen.`, v: `Ph·∫£i ${word.m} (N4 - B·∫Øt bu·ªôc).` }
                ],
                pot: [
                    { j: `ÁßÅ„ÅØ${forms.pot}„ÄÇ`, r: `Watashi wa ${forms.pot}.`, v: `T√¥i c√≥ th·ªÉ ${word.m} (N4 - Kh·∫£ nƒÉng).` },
                    { j: `${forms.pot}„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ`, r: `... you ni narimashita.`, v: `ƒê√£ tr·ªü n√™n c√≥ th·ªÉ ${word.m} (N4 - Bi·∫øn ƒë·ªïi).` }
                ],
                vol: [
                    { j: `‰∏ÄÁ∑í„Å´${forms.vol}„ÄÇ`, r: `Issho ni ${forms.vol}.`, v: `C√πng ${word.m} n√†o (N5 - √ù ch√≠ ng·∫Øn).` },
                    { j: `${forms.vol}„Å®ÊÄù„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ`, r: `... to omotte imasu.`, v: `T√¥i ƒëang ƒë·ªãnh ${word.m} (N4 - D·ª± ƒë·ªãnh).` }
                ],
                cond: [
                    { j: `${forms.cond}„ÄÅ„ÅÑ„ÅÑ„Åß„Åô„ÄÇ`, r: `${forms.cond}, ii desu.`, v: `N·∫øu ${word.m} th√¨ t·ªët (N4 - ƒêi·ªÅu ki·ªán).` },
                    { j: `${forms.cond}„ÄÅ„Çè„Åã„Çä„Åæ„Åô„ÄÇ`, r: `${forms.cond}, wakarimasu.`, v: `H·ªÖ ${word.m} l√† hi·ªÉu ngay.` }
                ]
            };

            // Use hashing based on Kanji to pick specific patterns for specific verbs consistently
            const hash = word.k.charCodeAt(0) % 5;
            const hash2 = (word.k.charCodeAt(0) + 1) % 5;
            const hash3 = (word.k.charCodeAt(0) + 2) % 5;

            // Helper to pick deterministic random
            const pick = (arr, h) => arr[h % arr.length];

            return [
                { f: forms.dict, ...pick(patterns.dict, hash) },
                { f: forms.masu, ...pick(patterns.masu, hash2) },
                { f: forms.te, ...pick(patterns.te, hash3) },
                { f: forms.ta, ...pick(patterns.ta, hash) },
                { f: forms.nai, ...pick(patterns.nai, hash2) },
                { f: forms.pot, ...pick(patterns.pot, hash) },
                { f: forms.vol, ...pick(patterns.vol, hash) },
                { f: forms.cond, ...pick(patterns.cond, hash) }
            ];
        }

        // --- CONJUGATION & RENDER LOGIC ---
        function conjugate(word, type, exc) {
            let h = word.h, stem = "";
            let f = { dict: h, masu: "", te: "", ta: "", nai: "", pot: "", vol: "", cond: "" };
            
            if (exc === "iku") { f.masu="„ÅÑ„Åç„Åæ„Åô"; f.te="„ÅÑ„Å£„Å¶"; f.ta="„ÅÑ„Å£„Åü"; f.nai="„ÅÑ„Åã„Å™„ÅÑ"; f.pot="„ÅÑ„Åë„Çã"; f.vol="„ÅÑ„Åì„ÅÜ"; f.cond="„ÅÑ„Åë„Å∞"; return f; }
            if (exc === "kiru") type=1;
            if (exc === "kaeru") type=1;
            if (exc === "hashiru") type=1;
            if (exc === "shiru") type=1;
            if (exc === "hairu") type=1;

            if (type === 3) {
                if (h === "„Åè„Çã") { f.masu="„Åç„Åæ„Åô"; f.te="„Åç„Å¶"; f.ta="„Åç„Åü"; f.nai="„Åì„Å™„ÅÑ"; f.pot="„Åì„Çâ„Çå„Çã"; f.vol="„Åì„Çà„ÅÜ"; f.cond="„Åè„Çå„Å∞"; }
                else if (h === "„Åô„Çã") { f.masu="„Åó„Åæ„Åô"; f.te="„Åó„Å¶"; f.ta="„Åó„Åü"; f.nai="„Åó„Å™„ÅÑ"; f.pot="„Åß„Åç„Çã"; f.vol="„Åó„Çà„ÅÜ"; f.cond="„Åô„Çå„Å∞"; }
            } else if (type === 2) {
                stem = h.slice(0, -1);
                f.masu=stem+"„Åæ„Åô"; f.te=stem+"„Å¶"; f.ta=stem+"„Åü"; f.nai=stem+"„Å™„ÅÑ"; f.pot=stem+"„Çâ„Çå„Çã"; f.vol=stem+"„Çà„ÅÜ"; f.cond=stem+"„Çå„Å∞";
            } else {
                let end = h.slice(-1); stem = h.slice(0, -1);
                let i="", n="", te="", ta="", e="", o="";
                switch(end) {
                    case '„ÅÜ': i='„ÅÑ'; n='„Çè'; te='„Å£„Å¶'; ta='„Å£„Åü'; e='„Åà'; o='„Åä'; break;
                    case '„Åè': i='„Åç'; n='„Åã'; te='„ÅÑ„Å¶'; ta='„ÅÑ„Åü'; e='„Åë'; o='„Åì'; break;
                    case '„Åê': i='„Åé'; n='„Åå'; te='„ÅÑ„Åß'; ta='„ÅÑ„Å†'; e='„Åí'; o='„Åî'; break;
                    case '„Åô': i='„Åó'; n='„Åï'; te='„Åó„Å¶'; ta='„Åó„Åü'; e='„Åõ'; o='„Åù'; break;
                    case '„Å§': i='„Å°'; n='„Åü'; te='„Å£„Å¶'; ta='„Å£„Åü'; e='„Å¶'; o='„Å®'; break;
                    case '„Å¨': i='„Å´'; n='„Å™'; te='„Çì„Åß'; ta='„Çì„Å†'; e='„Å≠'; o='„ÅÆ'; break;
                    case '„Å∂': i='„Å≥'; n='„Å∞'; te='„Çì„Åß'; ta='„Çì„Å†'; e='„Åπ'; o='„Åº'; break;
                    case '„ÇÄ': i='„Åø'; n='„Åæ'; te='„Çì„Åß'; ta='„Çì„Å†'; e='„ÇÅ'; o='„ÇÇ'; break;
                    case '„Çã': i='„Çä'; n='„Çâ'; te='„Å£„Å¶'; ta='„Å£„Åü'; e='„Çå'; o='„Çç'; break;
                }
                f.masu=stem+i+"„Åæ„Åô"; f.nai=stem+n+"„Å™„ÅÑ"; f.te=stem+te; f.ta=stem+ta; f.pot=stem+e+"„Çã"; f.cond=stem+e+"„Å∞"; f.vol=stem+o+"„ÅÜ";
            }
            return f;
        }

        // --- RENDER LOGIC ---
        function renderContent() {
            const container = document.getElementById("content-area");
            container.innerHTML = "";
            groupsConfig.forEach(group => {
                const groupDiv = document.createElement("div");
                groupDiv.className = "bg-white rounded-lg shadow-md overflow-hidden mb-8";
                groupDiv.innerHTML = `<div class="${colorMap[group.color]} px-6 py-4 border-l-8 font-bold text-xl flex justify-between items-center"><span>${group.title}</span></div>`;
                const grid = document.createElement("div");
                grid.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6";
                group.ids.forEach(kanji => {
                    const word = masterVerbList.find(w => w.k === kanji);
                    if(!word) return;
                    allWords.push(word);
                    const wordStr = encodeURIComponent(JSON.stringify(word));
                    const card = document.createElement("div");
                    card.className = "border border-gray-200 rounded-xl p-4 hover:shadow-lg transition duration-200 bg-white flex flex-col relative group";
                    // EDITED: Removed the second div that contained word.h (hiragana) below the kanji
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-3 border-b border-gray-100 pb-2">
                            <div><div class="text-3xl kanji-font font-bold text-gray-800">${word.k}</div></div>
                            <div class="flex space-x-2">
                                <button onclick="showStrokeOrder('${word.k}')" class="bg-pink-100 hover:bg-pink-200 text-pink-600 p-2 rounded-full w-10 h-10 flex items-center justify-center shadow-sm transition"><i class="fas fa-pen-nib"></i></button>
                                <button onclick="openModal('${wordStr}')" class="bg-gray-100 hover:bg-indigo-100 text-indigo-600 p-2 rounded-full w-10 h-10 flex items-center justify-center shadow-sm transition"><i class="fas fa-list-ul"></i></button>
                                <button onclick="speak('${word.k}', '${word.h}')" class="${btnColorMap[group.color]} text-white p-2 rounded-full w-10 h-10 flex items-center justify-center shadow-md focus:outline-none transform active:scale-95 transition"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </div>
                        <div class="mb-2"><span class="inline-block bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded font-bold mr-2 uppercase">${word.h}</span><span class="font-bold text-indigo-700 text-lg">${word.m}</span></div>
                        <div class="mt-auto bg-gray-50 rounded-lg p-3 text-sm space-y-2">
                            <div class="text-gray-700 leading-snug"><span class="font-semibold text-gray-900">üñºÔ∏è H√¨nh:</span> ${word.ti.replace(/\*\*(.*?)\*\*/g, '<span class="text-red-600 font-bold">$1</span>')}</div>
                            <div class="text-gray-700 leading-snug border-t border-gray-200 pt-2 mt-2"><span class="font-semibold text-gray-900">üîä √Çm:</span> ${word.ta.replace(/\*\*(.*?)\*\*/g, '<span class="text-blue-600 font-bold">$1</span>')}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
                groupDiv.appendChild(grid);
                container.appendChild(groupDiv);
            });
        }

        // --- STROKE ORDER LOGIC ---
        function getKanjiHex(kanji) {
            return kanji.charCodeAt(0).toString(16).padStart(5, '0');
        }

        async function fetchKanjiSvg(hex) {
            const url = `https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg/kanji/${hex}.svg`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Not found');
                return await response.text();
            } catch (e) {
                console.error("Error fetching SVG:", e);
                return null;
            }
        }

        async function showStrokeOrder(kanji) {
            const hex = getKanjiHex(kanji);
            document.getElementById('stroke-modal').classList.remove('hidden');
            document.getElementById('stroke-modal-char').innerText = kanji;
            
            const animContainer = document.getElementById('stroke-animation-container');
            const gridContainer = document.getElementById('stroke-grid-container');
            animContainer.innerHTML = '<span class="text-xs text-gray-400">ƒêang t·∫£i...</span>';
            
            const svgContent = await fetchKanjiSvg(hex);
            
            if (!svgContent) {
                animContainer.innerHTML = "<p class='p-4 text-red-500 text-xs'>L·ªói t·∫£i d·ªØ li·ªáu.</p>";
                gridContainer.innerHTML = "";
                return;
            }

            // 1. Setup Animation
            animContainer.innerHTML = svgContent;
            const mainSvg = animContainer.querySelector('svg');
            mainSvg.setAttribute('width', '100%');
            mainSvg.setAttribute('height', '100%');
            
            const paths = mainSvg.querySelectorAll('path');
            paths.forEach((path) => {
                const length = path.getTotalLength();
                path.style.strokeDasharray = length;
                path.style.strokeDashoffset = length;
                path.style.stroke = "#333";
                path.style.strokeWidth = "4";
                path.style.fill = "none";
                path.style.strokeLinecap = "round";
                path.style.strokeLinejoin = "round";
            });
            
            currentStrokeSvg = mainSvg;
            replayStrokeAnimation();

            // 2. Setup Static Grid
            gridContainer.innerHTML = '';
            const numStrokes = paths.length;
            
            for (let i = 0; i < numStrokes; i++) {
                const stepBox = document.createElement('div');
                stepBox.className = "w-20 h-20 bg-white border border-gray-200 relative stroke-grid-box flex items-center justify-center";
                
                const parser = new DOMParser();
                const doc = parser.parseFromString(svgContent, "image/svg+xml");
                const svgClone = doc.querySelector('svg');
                svgClone.setAttribute('width', '100%');
                svgClone.setAttribute('height', '100%');
                
                const clonePaths = svgClone.querySelectorAll('path');
                clonePaths.forEach((p, pIdx) => {
                    p.style.fill = "none";
                    p.style.strokeLinecap = "round";
                    p.style.strokeLinejoin = "round";
                    if (pIdx < i) { p.style.stroke = "#9ca3af"; p.style.strokeWidth = "3"; }
                    else if (pIdx === i) { p.style.stroke = "#000"; p.style.strokeWidth = "4"; }
                    else { p.style.display = "none"; }
                });
                
                stepBox.appendChild(svgClone);
                gridContainer.appendChild(stepBox);
            }
        }

        function replayStrokeAnimation() {
            if(!currentStrokeSvg) return;
            const paths = currentStrokeSvg.querySelectorAll('path');
            paths.forEach(p => { p.style.transition = 'none'; p.style.strokeDashoffset = p.getTotalLength(); });
            void currentStrokeSvg.offsetWidth;
            let delay = 0; const duration = 0.6;
            paths.forEach((p) => {
                p.style.transition = `stroke-dashoffset ${duration}s ease-in-out ${delay}s`;
                p.style.strokeDashoffset = '0';
                delay += duration;
            });
        }

        function closeStrokeModal() { document.getElementById('stroke-modal').classList.add('hidden'); }

        // --- MODAL LOGIC ---
        function openModal(wordStr) {
            const word = JSON.parse(decodeURIComponent(wordStr));
            const forms = conjugate(word, word.t, word.e);
            const examples = getExamples(word, forms);
            document.getElementById("modal-kanji").innerText = word.k;
            document.getElementById("modal-hiragana").innerText = word.h;
            document.getElementById("modal-meaning").innerText = word.m;
            document.getElementById("modal-group").innerText = word.t === 1 ? "Nh√≥m 1 (Godan)" : (word.t === 2 ? "Nh√≥m 2 (Ichidan)" : "Nh√≥m 3 (B·∫•t quy t·∫Øc)");
            const btn = document.getElementById("modal-main-audio");
            btn.onclick = () => speak(word.k, word.h);
            const list = document.getElementById("conjugation-list");
            list.innerHTML = "";
            const labels = ["T·ª´ ƒëi·ªÉn", "Th·ªÉ „Åæ„Åô (L·ªãch s·ª±)", "Th·ªÉ „Å¶ (N·ªëi)", "Th·ªÉ „Åü (Qu√° kh·ª©)", "Th·ªÉ „Å™„ÅÑ (Ph·ªß ƒë·ªãnh)", "Kh·∫£ nƒÉng", "√ù ch√≠", "ƒêi·ªÅu ki·ªán"];
            examples.forEach((ex, i) => {
                const row = `
                <div class="bg-white border border-gray-200 rounded-lg p-4 hover:border-indigo-300 transition">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs font-bold uppercase text-gray-400 tracking-wider">${labels[i]}</span>
                        <div class="flex items-center">
                            <span class="text-xl font-bold text-indigo-700 kanji-font mr-3">${Object.values(forms)[i]}</span>
                            <button onclick="speak('${Object.values(forms)[i]}', '')" class="text-indigo-400 hover:text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-full w-8 h-8 flex items-center justify-center transition"><i class="fas fa-volume-up text-sm"></i></button>
                        </div>
                    </div>
                    <div class="bg-indigo-50 rounded p-3 text-sm relative group">
                        <div class="font-bold text-gray-800 kanji-font mb-1 text-lg">${ex.j}</div>
                        <div class="text-gray-500 text-xs italic mb-1">${ex.r}</div>
                        <div class="text-gray-700">${ex.v}</div>
                        <button onclick="speak('${ex.j}', '')" class="absolute top-2 right-2 text-indigo-400 hover:text-indigo-600 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm"><i class="fas fa-volume-up"></i></button>
                    </div>
                </div>`;
                list.innerHTML += row;
            });
            document.getElementById("conjugation-modal").classList.remove("hidden");
        }

        function closeModal() { document.getElementById("conjugation-modal").classList.add("hidden"); }
        function openGrammarModal() { document.getElementById("grammar-modal").classList.remove("hidden"); }
        function closeGrammarModal() { document.getElementById("grammar-modal").classList.add("hidden"); }
        
        function switchTab(m) {
            document.getElementById("learn-section").classList.toggle("hidden", m!=="learn");
            document.getElementById("quiz-section").classList.toggle("hidden", m!=="quiz");
            document.getElementById("tab-learn").className = m==="learn" ? "px-4 py-2 rounded-md text-sm font-bold transition bg-white text-indigo-900 shadow whitespace-nowrap" : "px-4 py-2 rounded-md text-sm font-bold transition text-indigo-200 whitespace-nowrap";
            document.getElementById("tab-quiz").className = m==="quiz" ? "px-4 py-2 rounded-md text-sm font-bold transition bg-white text-indigo-900 shadow whitespace-nowrap" : "px-4 py-2 rounded-md text-sm font-bold transition text-indigo-200 whitespace-nowrap";
            if(m==="quiz") nextQuestion();
        }

        function nextQuestion() {
            document.getElementById("feedback-area").classList.add("hidden");
            document.getElementById("btn-check").classList.remove("hidden");
            document.getElementById("btn-next").classList.add("hidden");
            document.getElementById("quiz-input").value = "";
            document.getElementById("quiz-input").disabled = false;
            document.getElementById("quiz-input").focus();
            const uniqueWords = Array.from(new Set(allWords.map(a => a.k))).map(k => allWords.find(a => a.k === k));
            currentQ = uniqueWords[Math.floor(Math.random() * uniqueWords.length)];
            document.getElementById("quiz-kanji").innerText = currentQ.k;
            document.getElementById("quiz-meaning").innerText = currentQ.m;
            document.getElementById("quiz-kanji").className = "text-6xl kanji-font font-bold text-gray-800 mb-4 transition-all";
        }

        function checkAnswer() {
            const val = document.getElementById("quiz-input").value.trim();
            if(!val) return;
            document.getElementById("quiz-input").disabled = true;
            const correct = val === currentQ.h;
            const k = document.getElementById("quiz-kanji");
            if(correct) {
                score+=10; k.className = "text-6xl kanji-font font-bold text-green-600 mb-4 transition-all correct-anim";
                document.getElementById("feedback-title").innerHTML = '<i class="fas fa-check-circle text-green-600 mr-2"></i> Ch√≠nh x√°c!';
                document.getElementById("feedback-title").className = "font-bold text-lg mb-2 flex items-center text-green-700";
            } else {
                score=Math.max(0, score-5); k.className = "text-6xl kanji-font font-bold text-red-600 mb-4 transition-all wrong-anim";
                document.getElementById("feedback-title").innerHTML = '<i class="fas fa-times-circle text-red-600 mr-2"></i> Sai r·ªìi!';
                document.getElementById("feedback-title").className = "font-bold text-lg mb-2 flex items-center text-red-700";
            }
            document.getElementById("score-display").innerText = score;
            document.getElementById("correct-answer").innerText = currentQ.h;
            document.getElementById("quiz-tip-img").innerHTML = `<span class="font-bold text-gray-700">üñºÔ∏è H√¨nh:</span> ` + currentQ.ti.replace(/\*\*(.*?)\*\*/g, '<span class="text-red-600 font-bold">$1</span>');
            document.getElementById("quiz-tip-sound").innerHTML = `<span class="font-bold text-gray-700">üîä √Çm:</span> ` + currentQ.ta.replace(/\*\*(.*?)\*\*/g, '<span class="text-blue-600 font-bold">$1</span>');
            
            document.getElementById("feedback-area").classList.remove("hidden");
            document.getElementById("btn-check").classList.add("hidden");
            document.getElementById("btn-next").classList.remove("hidden");
            document.getElementById("btn-next").focus();
        }

        function playCurrentAudio() { if(currentQ) speak(currentQ.k, currentQ.h); }
        function speak(t, h) {
            if('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(t);
                u.lang = 'ja-JP'; u.rate = 0.9;
                window.speechSynthesis.speak(u);
            }
        }
        document.getElementById("quiz-input").addEventListener("keypress", function(e) { if(e.key==="Enter") checkAnswer(); });
        document.addEventListener('DOMContentLoaded', renderContent);
    </script>
</body>
</html>
