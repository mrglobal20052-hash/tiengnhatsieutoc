<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AzaKanji Tango - Ngày 7: Chuẩn bị & Sở thích</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Nunito', 'Inter', sans-serif; background-color: #f3f4f6; height: 100dvh; overflow: hidden; }
        .ja-text { font-family: 'Noto Sans JP', sans-serif; }
        .scroller { -webkit-overflow-scrolling: touch; overflow-y: auto; }
        .scroller::-webkit-scrollbar { width: 5px; height: 5px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
        
        .vocab-item { transition: all 0.2s; }
        .vocab-item.active { background-color: #eef2ff; border-left: 4px solid #4f46e5; color: #4338ca; padding-left: 0.75rem; }
        
        .shadow-card { transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s; }
        .shadow-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.3); }
        
        .tab-btn.active { background-color: white; color: #312e81; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
        .tab-btn { color: #a5b4fc; }
        
        /* Animation Classes */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .wrong-anim { animation: shake 0.3s ease-in-out; }
        
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .correct-anim { animation: pop 0.3s ease-in-out; }

        /* Stroke Order Styles */
        .stroke-grid-box { border: 1px solid #e5e7eb; background-color: white; position: relative; }
        .stroke-grid-box::after { content: ''; position: absolute; top: 0; left: 50%; width: 1px; height: 100%; background: repeating-linear-gradient(to bottom, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); pointer-events: none; }
        .stroke-grid-box::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px; background: repeating-linear-gradient(to right, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); pointer-events: none; }
        
        /* Hide stroke paths initially */
        #strokeAnimContainer svg path { opacity: 0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="flex flex-col text-slate-800">

    <!-- HEADER -->
    <header class="bg-indigo-700 text-white shadow-lg flex-none z-40 relative">
        <div class="container mx-auto px-4 py-2 md:py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-3">
                <div class="flex items-center gap-3 cursor-pointer select-none w-full md:w-auto justify-between" onclick="location.reload()">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-torii-gate text-3xl text-white"></i>
                        <div>
                            <h1 class="text-lg md:text-xl font-bold uppercase tracking-wider">AzaKanji Tango</h1>
                            <p class="text-[10px] md:text-xs text-indigo-200">Ngày 7: Chuẩn bị & Sở thích</p>
                        </div>
                    </div>
                    <div class="md:hidden text-xs font-semibold bg-indigo-800 px-3 py-1 rounded-full border border-indigo-500/50"><span id="headerProgress">1/87</span></div>
                </div>
                <div class="flex items-center gap-3 w-full md:w-auto">
                    <div class="flex bg-indigo-900/50 rounded-lg p-1 w-full md:w-auto overflow-x-auto no-scrollbar">
                        <button onclick="switchTab('learn')" id="tab-learn" class="tab-btn active flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-book-open"></i> Học Từ</button>
                        <button onclick="switchTab('quiz')" id="tab-quiz" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-keyboard"></i> Kiểm Tra</button>
                        <div class="w-px bg-indigo-600 mx-1"></div>
                        <button onclick="openGrammarList()" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2 whitespace-nowrap"><i class="fas fa-scroll"></i> Cẩm Nang</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden relative w-full">
        <!-- DESKTOP SIDEBAR -->
        <aside class="hidden md:flex w-72 bg-white border-r border-gray-200 flex-col z-10">
            <div class="p-4 border-b border-gray-100 bg-gray-50">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
                    <input type="text" id="searchInput" placeholder="Tìm kiếm từ..." class="w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 transition-all shadow-sm outline-none">
                </div>
            </div>
            <div id="vocabList" class="flex-1 scroller p-2 space-y-1"></div>
        </aside>

        <!-- MAIN CONTENT (LEARN MODE) -->
        <main id="learn-section" class="flex-1 overflow-y-auto scroller bg-slate-50 p-4 pb-28 w-full scroll-smooth">
            <div class="max-w-3xl mx-auto flex flex-col items-center animate-fade-in">
                <!-- Flashcard -->
                <div class="w-full bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-indigo-50 to-pink-50 rounded-bl-full -mr-8 -mt-8 z-0 opacity-60 transition-transform group-hover:scale-110 duration-700"></div>
                    <div class="relative z-10 text-center">
                        <div class="inline-flex items-center gap-2 bg-gray-50 px-3 py-1 rounded-full mb-4 border border-gray-100">
                            <span id="wordType" class="text-[10px] font-bold uppercase text-indigo-500">WORD</span>
                            <div class="w-px h-3 bg-gray-300"></div>
                            <span class="text-[10px] text-gray-400 font-mono" id="wordIndex">#1</span>
                        </div>
                        <div class="relative inline-block mb-2">
                            <h2 id="cardKanji" class="text-5xl md:text-6xl font-bold text-gray-800 ja-text tracking-tight cursor-pointer hover:text-indigo-700 transition-colors" onclick="speakCurrent()">準備</h2>
                            <button id="strokeBtn" onclick="openStrokeModal()" class="absolute -right-10 top-2 w-8 h-8 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center shadow-sm hover:bg-pink-200 hover:scale-110 transition-all hidden" title="Tập viết">
                                <i class="fas fa-pen-nib text-sm"></i>
                            </button>
                        </div>
                        <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="speakCurrent()">
                            <span id="cardFurigana" class="text-xl text-indigo-600 font-medium ja-text">じゅんび</span>
                            <span id="cardMeaning" class="text-lg text-gray-500 font-medium">Chuẩn bị</span>
                        </div>
                    </div>
                </div>

                <!-- Shadowing Sentences -->
                <div class="w-full">
                    <div class="flex items-center gap-2 mb-4 px-1">
                        <div class="bg-pink-100 text-pink-600 p-1.5 rounded-lg text-sm"><i class="fas fa-comments"></i></div>
                        <h3 class="font-bold text-gray-700 text-lg">Hội thoại đời sống</h3>
                    </div>
                    <div id="sentenceList" class="space-y-4"></div>
                    
                    <!-- Empty State -->
                    <div id="emptyState" class="hidden flex-col items-center justify-center p-8 text-center bg-white rounded-2xl border border-dashed border-gray-300 text-gray-400">
                        <i class="fas fa-comment-dots text-4xl mb-2 text-gray-300"></i>
                        <p class="text-sm">Chưa có hội thoại mẫu cho từ này.</p>
                        <p class="text-xs text-gray-300 mt-1">(Dữ liệu đang cập nhật)</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- QUIZ MODE -->
        <div id="quiz-section" class="hidden flex-1 w-full overflow-y-auto scroller bg-slate-100 p-4 absolute inset-0 z-20">
            <div class="max-w-2xl mx-auto mt-4 md:mt-10 animate-fade-in">
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white flex justify-between items-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
                        <div class="relative z-10">
                            <h2 class="text-2xl font-bold flex items-center gap-2"><i class="fas fa-graduation-cap"></i> Thử Thách</h2>
                            <p class="text-indigo-100 text-sm">Nhìn Kanji - Đoán Hiragana</p>
                        </div>
                        <div class="text-right relative z-10 bg-white/10 p-2 rounded-lg backdrop-blur-sm">
                            <div class="text-[10px] text-indigo-100 uppercase font-bold tracking-wider">Điểm số</div>
                            <div class="text-3xl font-bold font-mono" id="score-display">0</div>
                        </div>
                    </div>
                    
                    <div class="p-6 md:p-10 text-center">
                        <div class="mb-8 relative">
                            <div class="text-xs text-gray-400 mb-2 uppercase font-bold tracking-widest">Từ này đọc là gì?</div>
                            <div id="quiz-kanji" class="text-6xl ja-text font-bold text-gray-800 mb-4 transition-all inline-block"></div>
                            <div id="quiz-meaning" class="text-lg text-indigo-600 font-bold mb-2"></div>
                        </div>
                        
                        <div class="relative max-w-md mx-auto mb-8">
                            <input type="text" id="quiz-input" class="w-full text-center text-2xl p-4 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all ja-text placeholder:text-gray-300" placeholder="nhập hiragana..." autocomplete="off">
                        </div>
                        
                        <div id="feedback-area" class="hidden rounded-xl p-5 bg-gray-50 border border-gray-200 text-left mb-6 animate-fade-in shadow-inner">
                            <div id="feedback-title" class="font-bold text-lg mb-2 flex items-center"></div>
                            <div class="text-gray-700 mb-3 flex items-center flex-wrap gap-2">
                                Đáp án đúng: <span id="correct-answer" class="font-bold text-xl text-indigo-600 px-3 py-1 bg-white border border-indigo-100 rounded-lg ja-text shadow-sm"></span>
                                <button onclick="playQuizAudio()" class="text-gray-400 hover:text-indigo-600 transition-colors w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-200 border border-transparent hover:border-gray-300"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </div>
                        
                        <div>
                            <button id="btn-check" onclick="checkAnswer()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto">
                                <i class="fas fa-check"></i> Kiểm Tra
                            </button>
                            <button id="btn-next" onclick="nextQuestion()" class="hidden w-full md:w-auto bg-gray-800 hover:bg-gray-900 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto">
                                Câu Tiếp Theo <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MOBILE BOTTOM BAR -->
        <div class="fixed bottom-0 left-0 right-0 glass px-4 py-3 pb-6 z-30 flex items-center justify-between gap-4 md:hidden shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] border-t border-gray-200">
            <button onclick="prevWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50 active:scale-95 transition">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button onclick="toggleDrawer()" class="flex-1 h-12 rounded-xl bg-indigo-600 text-white font-bold flex items-center justify-center shadow-lg gap-2 active:scale-95 transition active:bg-indigo-700">
                <i class="fas fa-list-ul"></i> Danh Sách
            </button>
            <button onclick="nextWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50 active:scale-95 transition">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- MODAL: GRAMMAR LIST -->
    <div id="grammarListModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/70 backdrop-blur-sm transition-opacity opacity-0" id="grammarListBackdrop" onclick="closeModal('grammarListModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-4xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[85vh]" id="grammarListPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-2xl">
                <div class="flex items-center gap-3">
                    <div class="bg-indigo-600 text-white p-2 rounded-lg shadow-sm"><i class="fas fa-book"></i></div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">Cẩm Nang Ngữ Pháp</h3>
                        <p class="text-xs text-gray-500">Thư viện ngữ pháp Day 7 (N5 - N3)</p>
                    </div>
                </div>
                <button onclick="closeModal('grammarListModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times text-xl"></i></button>
            </div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="grammarGrid"></div>
            </div>
            <div class="p-4 border-t border-gray-100 bg-white rounded-b-2xl flex justify-end">
                <button onclick="closeModal('grammarListModal')" class="px-6 py-2 bg-gray-800 text-white font-bold rounded-full text-sm transition active:scale-95 shadow-lg hover:bg-gray-700">Đã Hiểu</button>
            </div>
        </div>
    </div>

    <!-- MODAL: GRAMMAR DETAIL -->
    <div id="detailGrammarModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0" id="detailGrammarBackdrop" onclick="closeModal('detailGrammarModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-md relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col" id="detailGrammarPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-2xl">
                <div class="flex items-center gap-2">
                    <div class="bg-indigo-100 p-1.5 rounded-lg text-indigo-600"><i class="fas fa-info-circle"></i></div>
                    <h3 class="text-lg font-bold text-gray-800">Giải thích Ngữ pháp</h3>
                </div>
                <button onclick="closeModal('detailGrammarModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6">
                <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-3 text-center mb-4 shadow-sm">
                    <code class="text-lg font-bold text-indigo-700 font-mono" id="dgFormula"></code>
                </div>
                <div id="dgExplanation" class="text-gray-600 text-sm mb-4 space-y-3 leading-relaxed"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: KANJI STROKE -->
    <div id="strokeModal" class="fixed inset-0 z-[80] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity opacity-0" id="strokeBackdrop" onclick="closeModal('strokeModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-5xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[90vh]" id="strokePanel">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-pink-50 rounded-t-2xl">
                <h3 class="text-lg font-bold text-pink-700 flex items-center gap-2"><i class="fas fa-pen-nib"></i> Tập Viết & Chi Tiết Kanji</h3>
                <button onclick="closeModal('strokeModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50 flex-1">
                <div id="strokeTabs" class="flex justify-center gap-2 mb-6 flex-wrap"></div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col gap-6 text-center">
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 relative">
                            <p class="text-xs text-gray-400 mb-2 font-bold uppercase tracking-wider">Mô phỏng nét viết</p>
                            <div id="strokeAnimContainer" class="w-48 h-48 mx-auto bg-white border border-gray-300 relative stroke-grid-box flex items-center justify-center rounded-lg cursor-pointer" onclick="replayStrokeAnimation()"></div>
                            <button onclick="replayStrokeAnimation()" class="absolute top-4 right-4 bg-pink-50 text-pink-600 w-8 h-8 rounded-full flex items-center justify-center hover:bg-pink-100 transition shadow-sm z-10"><i class="fas fa-redo text-sm"></i></button>
                            <p class="text-[10px] text-gray-400 mt-2">Nhấn vào ô để chạy lại</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 text-left">
                            <p class="text-xs text-gray-400 mb-3 font-bold uppercase tracking-wider text-center">Thứ tự từng nét</p>
                            <div id="strokeGridContainer" class="flex flex-wrap gap-2 justify-center"></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col h-full text-left">
                        <div id="kanjiDetailContent">
                            <div class="flex items-center justify-between mb-6 border-b border-gray-100 pb-4">
                                <div><h2 id="detailKanji" class="text-6xl font-bold text-gray-800 ja-text mb-1 leading-none"></h2><div class="text-xs font-bold bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded inline-block mt-2" id="detailHanViet"></div></div>
                                <div class="text-right"><div class="text-2xl font-bold text-gray-600 capitalize" id="detailMeaning"></div></div>
                            </div>
                            <!-- Radicals -->
                            <div class="mb-4 bg-indigo-50 p-3 rounded-lg border border-indigo-100">
                                <span class="text-xs font-bold text-indigo-500 uppercase block mb-1"><i class="fas fa-layer-group mr-1"></i> Bộ thủ (Thành phần)</span>
                                <span class="text-sm font-medium text-indigo-900" id="detailRadicals">...</span>
                            </div>
                            <!-- On/Kun -->
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100 flex justify-between items-center group cursor-pointer" onclick="document.getElementById('btnPlayOn').click()"><div class="flex flex-col"><span class="text-xs font-bold text-gray-400 uppercase">On</span><span class="text-lg font-bold text-indigo-600 ja-text" id="detailOn"></span></div><button id="btnPlayOn" class="text-indigo-300 group-hover:text-indigo-600"><i class="fas fa-volume-up"></i></button></div>
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100 flex justify-between items-center group cursor-pointer" onclick="document.getElementById('btnPlayKun').click()"><div class="flex flex-col"><span class="text-xs font-bold text-gray-400 uppercase">Kun</span><span class="text-lg font-bold text-pink-600 ja-text" id="detailKun"></span></div><button id="btnPlayKun" class="text-pink-300 group-hover:text-pink-600"><i class="fas fa-volume-up"></i></button></div>
                            </div>
                            <!-- Tips -->
                            <div class="space-y-4 mb-6">
                                <div class="bg-green-50 p-4 rounded-lg border border-green-100">
                                    <h4 class="text-sm font-bold text-green-800 mb-2 flex items-center gap-2"><i class="fas fa-image"></i> Ghi nhớ hình ảnh</h4>
                                    <p class="text-sm text-green-700 leading-relaxed" id="detailTipImg"></p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg border border-orange-100">
                                    <h4 class="text-sm font-bold text-orange-800 mb-2 flex items-center gap-2"><i class="fas fa-music"></i> Mẹo nhớ âm thanh</h4>
                                    <div class="space-y-2">
                                        <p class="text-sm text-orange-700 flex items-start gap-2"><span class="font-bold text-[10px] bg-orange-200 px-1.5 py-0.5 rounded text-orange-800 min-w-[30px] text-center mt-0.5">ON</span> <span id="detailTipSoundOn"></span></p>
                                        <p class="text-sm text-orange-700 flex items-start gap-2"><span class="font-bold text-[10px] bg-pink-200 px-1.5 py-0.5 rounded text-pink-800 min-w-[30px] text-center mt-0.5">KUN</span> <span id="detailTipSoundKun"></span></p>
                                    </div>
                                </div>
                            </div>
                            <!-- Related Words -->
                            <div>
                                <h4 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-3">Từ vựng liên quan</h4>
                                <div class="space-y-2" id="detailWords"></div>
                            </div>
                        </div>
                        <div id="kanjiDetailEmpty" class="hidden h-full flex flex-col items-center justify-center text-center p-4 text-gray-400"><i class="fas fa-book-open text-4xl mb-3 opacity-30"></i><p class="text-sm">Chưa có dữ liệu chi tiết cho chữ Hán này.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. GRAMMAR REPO (N5 - N3) ---
        const grammarRepo = {
            "te_oku": { title: "Làm sẵn", formula: "Vておく", desc: "N4: Làm gì đó để chuẩn bị cho tương lai.", ex: "旅行の前にホテルを予約しておきます。" },
            "te_aru": { title: "Có sẵn (Trạng thái)", formula: "Vてある", desc: "N4: Trạng thái kết quả của một hành động có chủ ý.", ex: "カレンダーに予定が書いてあります。" },
            "volitional": { title: "Thể ý định", formula: "Vよう", desc: "N4: Dự định làm gì (văn nói) hoặc rủ rê.", ex: "夏休みは国へ帰ろうと思います。" },
            "tsumori": { title: "Dự định", formula: "Vる/ない + つもり", desc: "N4: Dự định làm hoặc không làm gì (khá chắc chắn).", ex: "来年、日本へ留学するつもりです。" },
            "yotei": { title: "Kế hoạch", formula: "N/Vる + 予定", desc: "N4: Kế hoạch, dự định đã được quyết định.", ex: "会議は3時に終わる予定です。" },
            "tara": { title: "Sau khi/Nếu", formula: "Vたら", desc: "N4: Điều kiện giả định hoặc hành động nối tiếp.", ex: "駅に着いたら、電話します。" },
            "hou_ga_ii": { title: "Nên/Không nên", formula: "Vた/Vない + ほうがいい", desc: "N4: Đưa ra lời khuyên.", ex: "薬を飲んだほうがいいですよ。" },
            "koto_ni_suru": { title: "Quyết định (Chủ quan)", formula: "Vる/ない + ことにする", desc: "N3: Tự mình quyết định làm gì.", ex: "タバコをやめることにしました。" },
            "koto_ni_naru": { title: "Được quyết định (Khách quan)", formula: "Vる/ない + ことになる", desc: "N3: Việc được quyết định không do ý chí bản thân.", ex: "来月、転勤することになりました。" },
            "nai_de": { title: "Không làm mà...", formula: "Vないで", desc: "N4: Làm V2 trong trạng thái không làm V1.", ex: "朝ごはんを食べないで学校へ行きました。" },
            "te_kudasai": { title: "Hãy...", formula: "Vてください", desc: "N5: Yêu cầu, nhờ vả lịch sự.", ex: "ここに名前を書いてください。" },
            "ta_form": { title: "Thể quá khứ ngắn", formula: "Vた", desc: "N5: Dùng trong văn nói thân mật.", ex: "もう食べた？" },
            "wa_desu": { title: "Cấu trúc định danh", formula: "N1 は N2 です", desc: "N5: Khẳng định N1 là N2.", ex: "私は学生です。" },
            "ni_place": { title: "Ở/Tại (Tồn tại/Đích đến)", formula: "N + に", desc: "N5: Chỉ nơi tồn tại hoặc điểm đến.", ex: "ホテルに泊まります。" },
            "o_particle": { title: "Trợ từ O", formula: "N + を + V", desc: "N5: Chỉ đối tượng tác động.", ex: "ご飯を食べます。" },
            "sou_da_hearsay": { title: "Nghe nói là", formula: "Vru/Adj + そうです", desc: "N4: Truyền đạt thông tin.", ex: "雨が降るそうです。" },
            "sou_da_visual": { title: "Trông có vẻ", formula: "Adj(bỏ i/na) + そう", desc: "N4: Phỏng đoán qua thị giác.", ex: "おいしそうです。" },
            "te_iru": { title: "Đang/Trạng thái", formula: "Vている", desc: "N5/N4: Hành động đang diễn ra hoặc trạng thái.", ex: "雨が降っています。" },
            "shi_shi": { title: "Vừa...vừa... (Liệt kê)", formula: "～し、～し", desc: "N4: Liệt kê lý do, tính chất.", ex: "安くて、おいしいです。" },
            "to_omou": { title: "Nghĩ rằng", formula: "～と 思います", desc: "N4: Biểu thị suy nghĩ, phỏng đoán.", ex: "明日雨が降ると思います。" },
            "mashou": { title: "Cùng làm nhé", formula: "Vましょう", desc: "N5: Rủ rê, đề nghị.", ex: "帰りましょう。" },
            "te_mo_ii": { title: "Làm...được không", formula: "Vてもいい", desc: "N5/N4: Xin phép làm gì đó.", ex: "入ってもいいですか。" },
            "ni_iku": { title: "Đi để...", formula: "V(bỏ masu)/N + に行く", desc: "N5: Đi đâu đó để thực hiện mục đích gì.", ex: "映画を見に行きます。" },
            "ndesu": { title: "Giải thích/Nhấn mạnh", formula: "V/Adj + んです", desc: "N4: Giải thích lý do, tình huống.", ex: "お腹が痛いんです。" },
            "te_simau": { title: "Lỡ/Hoàn thành", formula: "Vてしまう", desc: "N4: Hối tiếc vì lỡ làm hoặc làm xong hết.", ex: "食べてしまった。" },
            "tari_tari": { title: "Làm những việc như...", formula: "Vたり Vたり します", desc: "N4: Liệt kê hành động đại diện.", ex: "本を読んだり、テレビを見たりします。" },
            "nagara": { title: "Vừa...vừa...", formula: "V(bỏ masu) + ながら", desc: "N4: Hai hành động song song.", ex: "歩きながら話す。" },
            "te_kuru": { title: "Đi rồi về/Thay đổi", formula: "Vてくる", desc: "N4: Đi làm gì đó rồi quay lại, hoặc sự thay đổi hướng về phía mình.", ex: "行ってくる。" },
            "te_morau": { title: "Được làm cho", formula: "Vてもらう", desc: "N4: Được ai đó làm gì cho mình (biết ơn).", ex: "教えてもらった。" },
            "ba_yokatta": { title: "Giá mà...", formula: "Vば + よかった", desc: "N3: Hối tiếc về việc đã không làm.", ex: "もっと勉強すればよかった。" },
            "dake": { title: "Chỉ", formula: "N + だけ", desc: "N5: Giới hạn phạm vi (chỉ có cái này).", ex: "これだけです。" }
        };

        const vocabData = [
            { "STT": 1, "Kanji": "準備", "Nghĩa": "Chuẩn bị", "Furigana": "じゅんびします", "type": "verb", "conv": { "polite": "旅行の準備をしておきます。", "pVi": "Tôi sẽ chuẩn bị sẵn cho chuyến du lịch.", "casual": "旅行の準備しとくね。", "cVi": "Tớ chuẩn bị sẵn cho chuyến du lịch nhé.", "gIds": ["te_oku"] } },
            { "STT": 2, "Kanji": "決めます", "Nghĩa": "Quyết định", "Furigana": "きめます", "type": "verb", "conv": { "polite": "大学に行くことに決めました。", "pVi": "Tôi đã quyết định sẽ học đại học.", "casual": "大学行くって決めた。", "cVi": "Tớ quyết định đi học đại học rồi.", "gIds": ["koto_ni_suru"] } },
            { "STT": 3, "Kanji": "泊まります", "Nghĩa": "Trọ lại", "Furigana": "とまります", "type": "verb", "conv": { "polite": "ホテルに泊まる予定です。", "pVi": "Tôi dự định trọ lại khách sạn.", "casual": "ホテルに泊まる予定。", "cVi": "Định ở khách sạn.", "gIds": ["yotei"] } },
            { "STT": 4, "Kanji": "", "Nghĩa": "Cắm trại", "Furigana": "キャンプします", "type": "verb", "conv": { "polite": "週末、キャンプしようと思っています。", "pVi": "Cuối tuần tôi định đi cắm trại.", "casual": "週末、キャンプしようと思ってる。", "cVi": "Cuối tuần định đi cắm trại.", "gIds": ["volitional", "to_omou"] } },
            { "STT": 5, "Kanji": "乗ります", "Nghĩa": "Cưỡi (ngựa)", "Furigana": "のります", "type": "verb", "conv": { "polite": "馬に乗ったことがありますか。", "pVi": "Bạn đã từng cưỡi ngựa chưa?", "casual": "馬に乗ったことある？", "cVi": "Cưỡi ngựa bao giờ chưa?", "gIds": ["koto_ga_aru"] } },
            { "STT": 6, "Kanji": "登ります", "Nghĩa": "Leo (núi)", "Furigana": "のぼります", "type": "verb", "conv": { "polite": "富士山に登ってみたいです。", "pVi": "Tôi muốn thử leo núi Phú Sĩ.", "casual": "富士山登ってみたいな。", "cVi": "Muốn leo núi Phú Sĩ ghê.", "gIds": ["tai", "te_mo_ii"] } },
            { "STT": 7, "Kanji": "釣ります", "Nghĩa": "Câu cá", "Furigana": "つります", "type": "verb", "conv": { "polite": "川で魚を釣りました。", "pVi": "Tôi đã câu cá ở sông.", "casual": "川で魚釣ったよ。", "cVi": "Câu được cá ở sông đấy.", "gIds": ["ta_form"] } },
            { "STT": 8, "Kanji": "会ります", "Nghĩa": "Gặp", "Furigana": "あいます", "type": "verb", "conv": { "polite": "友達に会う約束があります。", "pVi": "Tôi có hẹn gặp bạn.", "casual": "友達に会う約束がある。", "cVi": "Có hẹn với bạn.", "gIds": ["ga_aru"] } },
            { "STT": 9, "Kanji": "着ます", "Nghĩa": "Mặc", "Furigana": "きます", "type": "verb", "conv": { "polite": "着物を着てみたいです。", "pVi": "Tôi muốn thử mặc Kimono.", "casual": "着物着てみたいな。", "cVi": "Muốn mặc thử Kimono.", "gIds": ["tai"] } },
            { "STT": 10, "Kanji": "", "Nghĩa": "Làm (chơi)", "Furigana": "します", "type": "verb", "conv": { "polite": "テニスをしませんか。", "pVi": "Chơi tennis không?", "casual": "テニスしない？", "cVi": "Làm ván tennis không?", "gIds": ["mashou"] } },
            { "STT": 11, "Kanji": "買います", "Nghĩa": "Mua", "Furigana": "かいます", "type": "verb", "conv": { "polite": "お土産を買っておきました。", "pVi": "Tôi đã mua sẵn quà lưu niệm.", "casual": "お土産買っといたよ。", "cVi": "Mua sẵn quà rồi nè.", "gIds": ["te_oku"] } },
            { "STT": 12, "Kanji": "飾ります", "Nghĩa": "Trang trí", "Furigana": "かざります", "type": "verb", "conv": { "polite": "部屋に花が飾ってあります。", "pVi": "Trong phòng có trang trí hoa (sẵn).", "casual": "部屋に花が飾ってある。", "cVi": "Phòng có cắm hoa sẵn rồi.", "gIds": ["te_aru"] } },
            { "STT": 13, "Kanji": "拭きます", "Nghĩa": "Lau", "Furigana": "ふきます", "type": "verb", "conv": { "polite": "テーブルを拭いておいてください。", "pVi": "Hãy lau bàn sẵn đi nhé.", "casual": "テーブル拭いといて。", "cVi": "Lau bàn sẵn đi.", "gIds": ["te_oku", "te_kudasai"] } },
            { "STT": 14, "Kanji": "干します", "Nghĩa": "Phơi", "Furigana": "ほします", "type": "verb", "conv": { "polite": "洗濯物を干しました。", "pVi": "Tôi đã phơi đồ giặt.", "casual": "洗濯物干したよ。", "cVi": "Phơi đồ rồi.", "gIds": ["ta_form"] } },
            { "STT": 15, "Kanji": "泳ぎます", "Nghĩa": "Bơi", "Furigana": "およぎます", "type": "verb", "conv": { "polite": "海で泳ぎたいです。", "pVi": "Tôi muốn bơi ở biển.", "casual": "海で泳ぎたい。", "cVi": "Muốn bơi ở biển.", "gIds": ["tai"] } },
            { "STT": 16, "Kanji": "洗濯します", "Nghĩa": "Giặt", "Furigana": "せんたくします", "type": "verb", "conv": { "polite": "服を洗濯しなければなりません。", "pVi": "Tôi phải giặt quần áo.", "casual": "服、洗濯しなきゃ。", "cVi": "Phải giặt đồ thôi.", "gIds": ["nakucha"] } },
            { "STT": 17, "Kanji": "聞きます", "Nghĩa": "Nghe", "Furigana": "ききます", "type": "verb", "conv": { "polite": "音楽を聞きながら勉強します。", "pVi": "Tôi vừa nghe nhạc vừa học.", "casual": "音楽聞きながら勉強する。", "cVi": "Vừa nghe nhạc vừa học.", "gIds": ["nagara"] } },
            { "STT": 18, "Kanji": "教えます", "Nghĩa": "Dạy/Chỉ", "Furigana": "おしえます", "type": "verb", "conv": { "polite": "住所を教えてください。", "pVi": "Hãy chỉ cho tôi địa chỉ.", "casual": "住所教えて。", "cVi": "Cho xin địa chỉ đi.", "gIds": ["te_kudasai"] } },
            { "STT": 19, "Kanji": "無くします", "Nghĩa": "Làm mất", "Furigana": "なくします", "type": "verb", "conv": { "polite": "財布を無くしてしまいました。", "pVi": "Tôi lỡ làm mất ví rồi.", "casual": "財布無くしちゃった。", "cVi": "Mất ví mất tiêu rồi.", "gIds": ["te_simau"] } },
            { "STT": 20, "Kanji": "心配します", "Nghĩa": "Lo lắng", "Furigana": "しんぱいします", "type": "verb", "conv": { "polite": "心配しないでください。", "pVi": "Xin đừng lo lắng.", "casual": "心配しないで。", "cVi": "Đừng lo.", "gIds": ["nai_de"] } },
            { "STT": 21, "Kanji": "触ります", "Nghĩa": "Chạm", "Furigana": "さわります", "type": "verb", "conv": { "polite": "展示物に触らないでください。", "pVi": "Xin đừng chạm vào vật trưng bày.", "casual": "触っちゃダメだよ。", "cVi": "Không được chạm vào đâu.", "gIds": ["nai_de", "kinshi"] } },
            { "STT": 22, "Kanji": "動きます", "Nghĩa": "Cử động", "Furigana": "うごきます", "type": "verb", "conv": { "polite": "動かないでください。", "pVi": "Xin đừng cử động.", "casual": "動かないで。", "cVi": "Đừng động đậy.", "gIds": ["nai_de"] } },
            { "STT": 23, "Kanji": "", "Nghĩa": "Sao chép", "Furigana": "コピーします", "type": "verb", "conv": { "polite": "資料をコピーしておきます。", "pVi": "Tôi sẽ photo tài liệu sẵn.", "casual": "資料コピーしとくね。", "cVi": "Để tớ photo sẵn tài liệu.", "gIds": ["te_oku"] } },
            { "STT": 24, "Kanji": "勉強します", "Nghĩa": "Học", "Furigana": "べんきょうします", "type": "verb", "conv": { "polite": "もっと勉強すればよかったです。", "pVi": "Giá mà tôi học chăm hơn.", "casual": "もっと勉強すればよかった。", "cVi": "Biết thế học chăm hơn.", "gIds": ["ba_yokatta"] } },
            { "STT": 25, "Kanji": "無理します", "Nghĩa": "Làm quá sức", "Furigana": "むりします", "type": "verb", "conv": { "polite": "無理しないでくださいね。", "pVi": "Đừng làm quá sức nhé.", "casual": "無理しないでね。", "cVi": "Đừng cố quá nha.", "gIds": ["nai_de"] } },
            { "STT": 26, "Kanji": "受けます", "Nghĩa": "Dự thi", "Furigana": "うけます", "type": "verb", "conv": { "polite": "試験を受けるつもりです。", "pVi": "Tôi định dự thi.", "casual": "試験受けるつもり。", "cVi": "Định đi thi.", "gIds": ["tsumori"] } },
            { "STT": 27, "Kanji": "やります", "Nghĩa": "Tưới (nước)", "Furigana": "やります", "type": "verb", "conv": { "polite": "花に水をやりましたか。", "pVi": "Bạn đã tưới nước cho hoa chưa?", "casual": "花に水やった？", "cVi": "Tưới hoa chưa?", "gIds": ["ta_form"] } },
            { "STT": 28, "Kanji": "終わります", "Nghĩa": "Kết thúc", "Furigana": "おわります", "type": "verb", "conv": { "polite": "仕事が終わったら、飲みに行きましょう。", "pVi": "Sau khi xong việc thì đi uống nhé.", "casual": "仕事終わったら、飲みに行こう。", "cVi": "Xong việc đi nhậu đi.", "gIds": ["tara", "mashou"] } },
            { "STT": 29, "Kanji": "入ります", "Nghĩa": "Vào", "Furigana": "はいります", "type": "verb", "conv": { "polite": "中に入ってもいいですか。", "pVi": "Tôi vào trong được không?", "casual": "中に入っていい？", "cVi": "Vào trong được không?", "gIds": ["te_mo_ii"] } },
            { "STT": 30, "Kanji": "着きます", "Nghĩa": "Đến nơi", "Furigana": "つきます", "type": "verb", "conv": { "polite": "駅に着いたら電話します。", "pVi": "Khi nào đến ga tôi sẽ gọi.", "casual": "駅に着いたら電話する。", "cVi": "Đến ga tớ gọi.", "gIds": ["tara"] } },
            { "STT": 31, "Kanji": "集めます", "Nghĩa": "Tập hợp", "Furigana": "あつめます", "type": "verb", "conv": { "polite": "切手を集めるのが趣味です。", "pVi": "Sở thích của tôi là sưu tập tem.", "casual": "切手集めるのが趣味。", "cVi": "Tớ thích sưu tập tem.", "gIds": ["wa_desu"] } },
            { "STT": 32, "Kanji": "困ります", "Nghĩa": "Gặp khó khăn", "Furigana": "こまります", "type": "verb", "conv": { "polite": "お金がなくて困っています。", "pVi": "Tôi đang gặp khó khăn vì không có tiền.", "casual": "お金なくて困ってる。", "cVi": "Không có tiền khổ ghê.", "gIds": ["te_iru"] } },
            { "STT": 33, "Kanji": "渡します", "Nghĩa": "Trao/Đưa", "Furigana": "わたします", "type": "verb", "conv": { "polite": "これを彼に渡してください。", "pVi": "Hãy đưa cái này cho anh ấy.", "casual": "これ彼に渡しといて。", "cVi": "Đưa cái này cho hắn nhé.", "gIds": ["te_kudasai"] } },
            { "STT": 34, "Kanji": "貼ります", "Nghĩa": "Dán", "Furigana": "はります", "type": "verb", "conv": { "polite": "切手を貼って出します。", "pVi": "Dán tem rồi gửi.", "casual": "切手貼って出す。", "cVi": "Dán tem rồi gửi.", "gIds": [] } },
            { "STT": 35, "Kanji": "答えます", "Nghĩa": "Trả lời", "Furigana": "こたえます", "type": "verb", "conv": { "polite": "質問に答えてください。", "pVi": "Hãy trả lời câu hỏi.", "casual": "質問に答えて。", "cVi": "Trả lời câu hỏi đi.", "gIds": ["te_kudasai"] } },
            { "STT": 36, "Kanji": "疲れます", "Nghĩa": "Mệt", "Furigana": "つかれます", "type": "verb", "conv": { "polite": "歩きすぎて疲れました。", "pVi": "Đi bộ nhiều quá nên mệt.", "casual": "歩きすぎて疲れた。", "cVi": "Đi nhiều mệt quá.", "gIds": ["ta_form"] } },
            { "STT": 37, "Kanji": "並べます", "Nghĩa": "Sắp xếp", "Furigana": "ならべます", "type": "verb", "conv": { "polite": "椅子を並べておきます。", "pVi": "Tôi sẽ xếp ghế sẵn.", "casual": "椅子並べとくね。", "cVi": "Tớ xếp ghế sẵn cho.", "gIds": ["te_oku"] } },
            { "STT": 38, "Kanji": "生まれます", "Nghĩa": "Sinh ra", "Furigana": "うまれます", "type": "verb", "conv": { "polite": "日本で生まれました。", "pVi": "Tôi sinh ra ở Nhật.", "casual": "日本で生まれた。", "cVi": "Sinh ra ở Nhật.", "gIds": ["ta_form"] } },
            { "STT": 39, "Kanji": "質問します", "Nghĩa": "Hỏi", "Furigana": "しつもんします", "type": "verb", "conv": { "polite": "先生に質問してもいいですか。", "pVi": "Tôi hỏi thầy giáo được không?", "casual": "先生に質問していい？", "cVi": "Hỏi thầy được không?", "gIds": ["te_mo_ii"] } },
            { "STT": 40, "Kanji": "差します", "Nghĩa": "Giương (ô)", "Furigana": "さします", "type": "verb", "conv": { "polite": "雨が降ったら傘を差します。", "pVi": "Nếu trời mưa tôi sẽ che ô.", "casual": "雨降ったら傘差す。", "cVi": "Mưa thì che ô.", "gIds": ["tara"] } },
            { "STT": 41, "Kanji": "頼みます", "Nghĩa": "Nhờ cậy", "Furigana": "たのみます", "type": "verb", "conv": { "polite": "友達に頼んでみます。", "pVi": "Tôi sẽ thử nhờ bạn xem sao.", "casual": "友達に頼んでみる。", "cVi": "Để tớ nhờ bạn xem.", "gIds": [] } },
            { "STT": 42, "Kanji": "守ります", "Nghĩa": "Tuân thủ", "Furigana": "まもります", "type": "verb", "conv": { "polite": "規則を守らなければなりません。", "pVi": "Phải tuân thủ quy tắc.", "casual": "規則守らなきゃ。", "cVi": "Phải tuân thủ quy tắc đấy.", "gIds": ["nakucha"] } },
            { "STT": 43, "Kanji": "歌います", "Nghĩa": "Hát", "Furigana": "うたいます", "type": "verb", "conv": { "polite": "カラオケで歌いました。", "pVi": "Tôi đã hát karaoke.", "casual": "カラオケで歌った。", "cVi": "Hát karaoke rồi.", "gIds": ["ta_form"] } },
            { "STT": 44, "Kanji": "弾きます", "Nghĩa": "Chơi (nhạc cụ)", "Furigana": "ひきます", "type": "verb", "conv": { "polite": "ピアノを弾くことができます。", "pVi": "Tôi có thể chơi piano.", "casual": "ピアノ弾けるよ。", "cVi": "Tớ chơi được piano đấy.", "gIds": ["potential"] } },
            { "STT": 45, "Kanji": "納豆", "Nghĩa": "Natto", "Furigana": "なっとう", "type": "food", "conv": { "polite": "納豆を食べたことがありますか。", "pVi": "Bạn đã từng ăn natto chưa?", "casual": "納豆食べたことある？", "cVi": "Ăn natto bao giờ chưa?", "gIds": ["koto_ga_aru"] } },
            { "STT": 46, "Kanji": "", "Nghĩa": "Sầu riêng", "Furigana": "ドリアン", "type": "food", "conv": { "polite": "ドリアンは臭いですが、おいしいです。", "pVi": "Sầu riêng hôi nhưng ngon.", "casual": "ドリアン臭いけど、うまい。", "cVi": "Sầu riêng thối mà ngon.", "gIds": ["shi_shi"] } },
            { "STT": 47, "Kanji": "", "Nghĩa": "Idol", "Furigana": "アイドル", "type": "noun", "conv": { "polite": "日本のアイドルが好きです。", "pVi": "Tôi thích idol Nhật Bản.", "casual": "日本のアイドル好き。", "cVi": "Thích idol Nhật.", "gIds": ["wa_desu"] } },
            { "STT": 48, "Kanji": "着物", "Nghĩa": "Kimono", "Furigana": "きもの", "type": "noun", "conv": { "polite": "着物を着てみたいです。", "pVi": "Tôi muốn thử mặc Kimono.", "casual": "着物着てみたいな。", "cVi": "Muốn mặc thử Kimono.", "gIds": ["tai"] } },
            { "STT": 49, "Kanji": "浴衣", "Nghĩa": "Yukata", "Furigana": "ゆかた", "type": "noun", "conv": { "polite": "お祭りで浴衣を着ます。", "pVi": "Tôi mặc Yukata ở lễ hội.", "casual": "お祭りで浴衣着る。", "cVi": "Đi lễ hội mặc Yukata.", "gIds": [] } },
            { "STT": 50, "Kanji": "お化け", "Nghĩa": "Ma quỷ", "Furigana": "おばけ", "type": "noun", "conv": { "polite": "お化けが怖いです。", "pVi": "Tôi sợ ma.", "casual": "お化け怖い。", "cVi": "Sợ ma lắm.", "gIds": ["wa_desu"] } },
            { "STT": 51, "Kanji": "旅館", "Nghĩa": "Lữ quán", "Furigana": "りょかん", "type": "place", "conv": { "polite": "旅館に泊まりたいです。", "pVi": "Tôi muốn trọ ở lữ quán.", "casual": "旅館に泊まりたい。", "cVi": "Muốn ở lữ quán.", "gIds": ["tai"] } },
            { "STT": 52, "Kanji": "", "Nghĩa": "Khách sạn", "Furigana": "ホテル", "type": "place", "conv": { "polite": "ホテルを予約しておきました。", "pVi": "Tôi đã đặt sẵn khách sạn.", "casual": "ホテル予約しといた。", "cVi": "Đặt khách sạn rồi.", "gIds": ["te_oku"] } },
            { "STT": 53, "Kanji": "相撲", "Nghĩa": "Sumo", "Furigana": "すもう", "type": "noun", "conv": { "polite": "相撲を見たことがありますか。", "pVi": "Bạn đã từng xem Sumo chưa?", "casual": "相撲見たことある？", "cVi": "Xem Sumo bao giờ chưa?", "gIds": ["koto_ga_aru"] } },
            { "STT": 54, "Kanji": "歌舞伎", "Nghĩa": "Kabuki", "Furigana": "かぶき", "type": "noun", "conv": { "polite": "歌舞伎は日本の伝統芸能です。", "pVi": "Kabuki là nghệ thuật truyền thống Nhật Bản.", "casual": "歌舞伎って日本の伝統芸能だよね。", "cVi": "Kabuki là nghệ thuật truyền thống Nhật nhỉ.", "gIds": ["wa_desu"] } },
            { "STT": 55, "Kanji": "一度", "Nghĩa": "Một lần", "Furigana": "いちど", "type": "noun", "conv": { "polite": "一度日本へ行きたいです。", "pVi": "Tôi muốn đi Nhật một lần.", "casual": "一度日本へ行きたい。", "cVi": "Muốn đi Nhật một lần.", "gIds": ["tai"] } },
            { "STT": 56, "Kanji": "一度も", "Nghĩa": "Chưa lần nào", "Furigana": "いちども", "type": "noun", "conv": { "polite": "一度も食べたことがありません。", "pVi": "Tôi chưa ăn lần nào.", "casual": "一度も食べたことない。", "cVi": "Chưa ăn bao giờ.", "gIds": ["koto_ga_aru"] } },
            { "STT": 57, "Kanji": "", "Nghĩa": "Tennis", "Furigana": "テニス", "type": "noun", "conv": { "polite": "週末、テニスをしませんか。", "pVi": "Cuối tuần chơi tennis không?", "casual": "週末、テニスしない？", "cVi": "Cuối tuần tennis hông?", "gIds": ["mashou"] } },
            { "STT": 58, "Kanji": "", "Nghĩa": "Bể bơi", "Furigana": "プール", "type": "place", "conv": { "polite": "プールで泳ぎます。", "pVi": "Tôi bơi ở bể bơi.", "casual": "プールで泳ぐ。", "cVi": "Bơi ở bể bơi.", "gIds": ["de_place"] } },
            { "STT": 59, "Kanji": "赤ちゃん", "Nghĩa": "Em bé", "Furigana": "あかちゃん", "type": "person", "conv": { "polite": "赤ちゃんが生まれました。", "pVi": "Em bé đã chào đời.", "casual": "赤ちゃん生まれたよ。", "cVi": "Em bé sinh ra rồi.", "gIds": ["ta_form"] } },
            { "STT": 60, "Kanji": "服", "Nghĩa": "Quần áo", "Furigana": "ふく", "type": "noun", "conv": { "polite": "新しい服を買いました。", "pVi": "Tôi đã mua quần áo mới.", "casual": "新しい服買った。", "cVi": "Mua đồ mới rồi.", "gIds": ["ta_form"] } },
            { "STT": 61, "Kanji": "花瓶", "Nghĩa": "Bình hoa", "Furigana": "かびん", "type": "noun", "conv": { "polite": "花瓶に花を飾ります。", "pVi": "Tôi cắm hoa vào bình.", "casual": "花瓶に花飾る。", "cVi": "Cắm hoa vào bình.", "gIds": [] } },
            { "STT": 62, "Kanji": "連休", "Nghĩa": "Kỳ nghỉ dài", "Furigana": "れんきゅう", "type": "noun", "conv": { "polite": "連休は何をしますか。", "pVi": "Kỳ nghỉ dài bạn làm gì?", "casual": "連休、何する？", "cVi": "Nghỉ lễ làm gì?", "gIds": [] } },
            { "STT": 63, "Kanji": "", "Nghĩa": "Phim Drama", "Furigana": "ドラマ", "type": "noun", "conv": { "polite": "日本のドラマが好きです。", "pVi": "Tôi thích phim truyền hình Nhật.", "casual": "日本のドラマ好き。", "cVi": "Thích phim Nhật.", "gIds": ["wa_desu"] } },
            { "STT": 64, "Kanji": "音楽", "Nghĩa": "Âm nhạc", "Furigana": "おんがく", "type": "noun", "conv": { "polite": "音楽を聞くのが趣味です。", "pVi": "Sở thích của tôi là nghe nhạc.", "casual": "音楽聞くのが趣味。", "cVi": "Thích nghe nhạc.", "gIds": ["wa_desu"] } },
            { "STT": 65, "Kanji": "外国語", "Nghĩa": "Ngoại ngữ", "Furigana": "がいこくご", "type": "noun", "conv": { "polite": "外国語を勉強したいです。", "pVi": "Tôi muốn học ngoại ngữ.", "casual": "外国語勉強したい。", "cVi": "Muốn học ngoại ngữ.", "gIds": ["tai"] } },
            { "STT": 66, "Kanji": "答え", "Nghĩa": "Câu trả lời", "Furigana": "こたえ", "type": "noun", "conv": { "polite": "答えがわかりません。", "pVi": "Tôi không biết câu trả lời.", "casual": "答えわかんない。", "cVi": "Chả biết câu trả lời.", "gIds": [] } },
            { "STT": 67, "Kanji": "財布", "Nghĩa": "Ví", "Furigana": "さいふ", "type": "noun", "conv": { "polite": "財布を落としてしまいました。", "pVi": "Tôi lỡ làm rơi ví.", "casual": "財布落としちゃった。", "cVi": "Rơi ví mất rồi.", "gIds": ["te_simau"] } },
            { "STT": 68, "Kanji": "", "Nghĩa": "Hộ chiếu", "Furigana": "パスポート", "type": "noun", "conv": { "polite": "パスポートを見せてください。", "pVi": "Hãy cho tôi xem hộ chiếu.", "casual": "パスポート見せて。", "cVi": "Cho xem hộ chiếu đi.", "gIds": ["te_kudasai"] } },
            { "STT": 69, "Kanji": "壁", "Nghĩa": "Tường", "Furigana": "かべ", "type": "noun", "conv": { "polite": "壁に絵が掛けてあります。", "pVi": "Trên tường có treo tranh.", "casual": "壁に絵が掛けてある。", "cVi": "Trên tường có tranh kìa.", "gIds": ["te_aru"] } },
            { "STT": 70, "Kanji": "遠慮", "Nghĩa": "Ngại ngần", "Furigana": "えんりょ", "type": "noun", "conv": { "polite": "遠慮しないでください。", "pVi": "Xin đừng ngại.", "casual": "遠慮しないで。", "cVi": "Đừng ngại.", "gIds": ["nai_de"] } },
            { "STT": 71, "Kanji": "夜遅く", "Nghĩa": "Đêm khuya", "Furigana": "よるおそく", "type": "noun", "conv": { "polite": "夜遅くまで起きています。", "pVi": "Tôi thức đến tận khuya.", "casual": "夜遅くまで起きてる。", "cVi": "Thức khuya lắm.", "gIds": ["te_iru"] } },
            { "STT": 72, "Kanji": "規則", "Nghĩa": "Quy tắc", "Furigana": "きそく", "type": "noun", "conv": { "polite": "規則を守らなければなりません。", "pVi": "Phải tuân thủ quy tắc.", "casual": "規則守らなきゃ。", "cVi": "Phải tuân thủ quy tắc.", "gIds": ["nakucha"] } },
            { "STT": 73, "Kanji": "", "Nghĩa": "Bài thi", "Furigana": "テスト", "type": "noun", "conv": { "polite": "明日はテストがあります。", "pVi": "Ngày mai có bài thi.", "casual": "明日テストある。", "cVi": "Mai có bài thi.", "gIds": ["ga_aru"] } },
            { "STT": 74, "Kanji": "意味", "Nghĩa": "Ý nghĩa", "Furigana": "いみ", "type": "noun", "conv": { "polite": "意味がわかりません。", "pVi": "Tôi không hiểu nghĩa.", "casual": "意味わかんない。", "cVi": "Chả hiểu nghĩa là gì.", "gIds": [] } },
            { "STT": 75, "Kanji": "制服", "Nghĩa": "Đồng phục", "Furigana": "せいふく", "type": "noun", "conv": { "polite": "学校で制服を着ます。", "pVi": "Tôi mặc đồng phục ở trường.", "casual": "学校で制服着る。", "cVi": "Mặc đồng phục ở trường.", "gIds": [] } },
            { "STT": 76, "Kanji": "授業", "Nghĩa": "Giờ học", "Furigana": "じゅぎょう", "type": "noun", "conv": { "polite": "授業を始めます。", "pVi": "Bắt đầu giờ học.", "casual": "授業始めるよ。", "cVi": "Vào học thôi.", "gIds": [] } },
            { "STT": 77, "Kanji": "大学", "Nghĩa": "Đại học", "Furigana": "だいがく", "type": "place", "conv": { "polite": "大学で勉強したいです。", "pVi": "Tôi muốn học đại học.", "casual": "大学で勉強したい。", "cVi": "Muốn học đại học.", "gIds": ["tai"] } },
            { "STT": 78, "Kanji": "目的地", "Nghĩa": "Đích đến", "Furigana": "もくてきち", "type": "place", "conv": { "polite": "目的地に着きました。", "pVi": "Đã đến đích.", "casual": "目的地に着いた。", "cVi": "Đến nơi rồi.", "gIds": ["ta_form"] } },
            { "STT": 79, "Kanji": "喫茶店", "Nghĩa": "Quán nước", "Furigana": "きっさてん", "type": "place", "conv": { "polite": "喫茶店でコーヒーを飲みます。", "pVi": "Tôi uống cà phê ở quán nước.", "casual": "喫茶店でコーヒー飲む。", "cVi": "Uống cà phê ở quán.", "gIds": ["de_place"] } },
            { "STT": 80, "Kanji": "問題", "Nghĩa": "Vấn đề", "Furigana": "もんだい", "type": "noun", "conv": { "polite": "問題が難しいです。", "pVi": "Vấn đề (câu hỏi) khó.", "casual": "問題難しい。", "cVi": "Câu hỏi khó thế.", "gIds": ["wa_desu"] } },
            { "STT": 81, "Kanji": "傷", "Nghĩa": "Vết thương", "Furigana": "きず", "type": "noun", "conv": { "polite": "傷が痛いです。", "pVi": "Vết thương đau.", "casual": "傷が痛い。", "cVi": "Đau vết thương quá.", "gIds": ["wa_desu"] } },
            { "STT": 82, "Kanji": "熱", "Nghĩa": "Sốt", "Furigana": "ねつ", "type": "noun", "conv": { "polite": "熱があります。", "pVi": "Tôi bị sốt.", "casual": "熱がある。", "cVi": "Bị sốt rồi.", "gIds": ["ga_aru"] } },
            { "STT": 83, "Kanji": "", "Nghĩa": "Cúm", "Furigana": "インフルエンザ", "type": "noun", "conv": { "polite": "インフルエンザにかかりました。", "pVi": "Tôi bị cúm.", "casual": "インフルにかかった。", "cVi": "Dính cúm rồi.", "gIds": ["ta_form"] } },
            { "STT": 84, "Kanji": "薬", "Nghĩa": "Thuốc", "Furigana": "くすり", "type": "noun", "conv": { "polite": "薬を飲んでください。", "pVi": "Hãy uống thuốc đi.", "casual": "薬飲んで。", "cVi": "Uống thuốc đi.", "gIds": ["te_kudasai"] } },
            { "STT": 85, "Kanji": "外食", "Nghĩa": "Ăn ngoài", "Furigana": "がいしょく", "type": "noun", "conv": { "polite": "週末は外食します。", "pVi": "Cuối tuần tôi đi ăn ngoài.", "casual": "週末は外食する。", "cVi": "Cuối tuần đi ăn tiệm.", "gIds": [] } },
            { "STT": 86, "Kanji": "お釣り", "Nghĩa": "Tiền thừa", "Furigana": "おつり", "type": "noun", "conv": { "polite": "お釣りをもらいましたか。", "pVi": "Bạn đã nhận tiền thừa chưa?", "casual": "お釣りもらった？", "cVi": "Lấy tiền thừa chưa?", "gIds": ["ta_form"] } },
            { "STT": 87, "Kanji": "現金", "Nghĩa": "Tiền mặt", "Furigana": "げんきん", "type": "noun", "conv": { "polite": "現金で払わなければなりません。", "pVi": "Phải trả bằng tiền mặt.", "casual": "現金で払わなきゃ。", "cVi": "Phải trả tiền mặt.", "gIds": ["nakucha"] } },
            { "STT": 88, "Kanji": "趣味", "Nghĩa": "Sở thích", "Furigana": "しゅみ", "type": "noun", "conv": { "polite": "趣味は何ですか。", "pVi": "Sở thích của bạn là gì?", "casual": "趣味は何？", "cVi": "Sở thích là gì?", "gIds": ["wa_desu"] } },
            { "STT": 89, "Kanji": "読書", "Nghĩa": "Đọc sách", "Furigana": "どくしょ", "type": "noun", "conv": { "polite": "趣味は読書です。", "pVi": "Sở thích của tôi là đọc sách.", "casual": "趣味は読書。", "cVi": "Thích đọc sách.", "gIds": ["wa_desu"] } }
        ];

        // --- 3. KANJI DETAILS (Tips & Mnemonics) ---
        const kanjiDetails = {
            "準": { hanviet: "CHUẨN", mean: "Chuẩn bị", on: "ジュン", kun: "", radicals: "Thủy (氵) + Chuy (隹) + Thập (十)", tipImg: "Nước (氵) chim (隹) mười (十) lần là chuẩn.", tipSoundOn: "**Jun**bi chuẩn bị.", tipSoundKun: "", words: [{w:"準備 (じゅんび)", m:"Chuẩn bị"}, {w:"水準 (すいじゅん)", m:"Tiêu chuẩn"}] },
            "備": { hanviet: "BỊ", mean: "Trang bị", on: "ビ", kun: "そな.える", radicals: "Nhân (亻) + Dụng (用)", tipImg: "Người (亻) dùng cỏ (艹) trên sườn núi (厂) để trang bị.", tipSoundOn: "Jun**bi** trang bị.", tipSoundKun: "**Sona**eru chuẩn bị.", words: [{w:"準備 (じゅんび)", m:"Chuẩn bị"}, {w:"設備 (せつび)", m:"Thiết bị"}] },
            "決": { hanviet: "QUYẾT", mean: "Quyết định", on: "ケツ", kun: "き.める", radicals: "Thủy (氵) + Quái (夬)", tipImg: "Nước (氵) chảy xiết quyết định (夬).", tipSoundOn: "**Ketsu**dan quyết đoán.", tipSoundKun: "**Ki**meru quyết định.", words: [{w:"決めます (きめます)", m:"Quyết định"}, {w:"解決 (かいけつ)", m:"Giải quyết"}] },
            "納": { hanviet: "NẠP", mean: "Thu nạp", on: "ノウ", kun: "おさ.める", radicals: "Mịch (糸) + Nội (内)", tipImg: "Sợi chỉ (糸) trong nhà (内) được thu nạp.", tipSoundOn: "**Nat**tou đậu nạp.", tipSoundKun: "**Osa**meru thu nạp.", words: [{w:"納豆 (なっとう)", m:"Đậu nạp"}, {w:"納税 (のうぜい)", m:"Nộp thuế"}] },
            "豆": { hanviet: "ĐẬU", mean: "Hạt đậu", on: "トウ", kun: "まめ", radicals: "Đậu (豆)", tipImg: "Hạt đậu trong bát.", tipSoundOn: "Nat**tou** đậu.", tipSoundKun: "**Mame** đậu.", words: [{w:"納豆 (なっとう)", m:"Đậu nạp"}, {w:"豆 (まめ)", m:"Đậu"}] },
            "着": { hanviet: "TRƯỚC", mean: "Mặc/Đến", on: "チャク", kun: "き.る", radicals: "Dương (⺶) + Mục (目)", tipImg: "Con dê (⺶) nhìn (目) đích đến.", tipSoundOn: "**Chaku** trắc.", tipSoundKun: "**Ki**mono áo.", words: [{w:"着物 (きもの)", m:"Kimono"}, {w:"着ます (きます)", m:"Mặc"}] },
            "物": { hanviet: "VẬT", mean: "Đồ vật", on: "ブツ", kun: "もの", radicals: "Ngưu (牛) + Vật (勿)", tipImg: "Con bò (牛) chê không (勿) phải vật.", tipSoundOn: "**Butsu** vật.", tipSoundKun: "Ki**mono** đồ.", words: [{w:"着物 (きもの)", m:"Kimono"}, {w:"食べ物 (たべもの)", m:"Đồ ăn"}] },
            "浴": { hanviet: "DỤC", mean: "Tắm", on: "ヨク", kun: "あ.びる", radicals: "Thủy (氵) + Cốc (谷)", tipImg: "Nước (氵) chảy trong thung lũng (谷) để tắm.", tipSoundOn: "**Yoku** dục.", tipSoundKun: "**Yu**kata áo tắm.", words: [{w:"浴衣 (ゆかた)", m:"Yukata"}, {w:"浴びます (あびます)", m:"Tắm"}] },
            "衣": { hanviet: "Y", mean: "Y phục", on: "イ", kun: "ころも", radicals: "Y (衣)", tipImg: "Cổ áo và vạt áo.", tipSoundOn: "**I** y phục.", tipSoundKun: "Yu**kata** y phục.", words: [{w:"浴衣 (ゆかた)", m:"Yukata"}, {w:"衣類 (いるい)", m:"Y phục"}] },
            "化": { hanviet: "HÓA", mean: "Biến hóa", on: "カ", kun: "ば.ける", radicals: "Nhân (亻) + Chủy (匕)", tipImg: "Người (亻) biến thành cái thìa (匕).", tipSoundOn: "**Ka** hóa.", tipSoundKun: "O**ba**ke ma.", words: [{w:"お化け (おばけ)", m:"Ma quỷ"}, {w:"文化 (ぶんか)", m:"Văn hóa"}] },
            "旅": { hanviet: "LỮ", mean: "Lữ hành", on: "リョ", kun: "たび", radicals: "Phương (方)", tipImg: "Phương (方) xa có người nằm (亻) dưới áo (衣) lữ hành.", tipSoundOn: "**Ryo**kan lữ quán.", tipSoundKun: "**Tabi** đi lại.", words: [{w:"旅館 (りょかん)", m:"Lữ quán"}, {w:"旅行 (りょこう)", m:"Du lịch"}] },
            "館": { hanviet: "QUÁN", mean: "Tòa nhà", on: "カン", kun: "やかた", radicals: "Thực (食) + Quan (官)", tipImg: "Nơi ăn (食) của quan (官) lại.", tipSoundOn: "Ryo**kan** quán.", tipSoundKun: "**Yakata** nhà.", words: [{w:"旅館 (りょかん)", m:"Lữ quán"}, {w:"図書館 (としょかん)", m:"Thư viện"}] },
            "相": { hanviet: "TƯƠNG", mean: "Tương hỗ", on: "ソウ", kun: "あい", radicals: "Mộc (木) + Mục (目)", tipImg: "Cây (木) che mắt (目) tương trợ.", tipSoundOn: "**Sou**dan thảo luận.", tipSoundKun: "**Su**mou tương phác.", words: [{w:"相撲 (すもう)", m:"Sumo"}, {w:"首相 (しゅしょう)", m:"Thủ tướng"}] },
            "撲": { hanviet: "PHÁC", mean: "Đánh", on: "ボク", kun: "", radicals: "Thủ (扌) + Nghiệp (業)", tipImg: "Tay (扌) đánh người nghiệp (業) chướng.", tipSoundOn: "Su**mou** đấu vật.", tipSoundKun: "", words: [{w:"相撲 (すもう)", m:"Sumo"}] },
            "歌": { hanviet: "CA", mean: "Hát", on: "カ", kun: "うた", radicals: "Khả (可) + Khiếm (欠)", tipImg: "Hai người ca (哥) hát thiếu (欠) hơi.", tipSoundOn: "**Ka**buki ca vũ.", tipSoundKun: "**Uta** bài hát.", words: [{w:"歌舞伎 (かぶき)", m:"Kịch Kabuki"}, {w:"歌手 (かしゅ)", m:"Ca sĩ"}] },
            "舞": { hanviet: "VŨ", mean: "Múa", on: "ブ", kun: "ま.う", radicals: "Vô (无)", tipImg: "Người múa chiều (夕) trên thuyền (舛).", tipSoundOn: "Ka**bu**ki vũ.", tipSoundKun: "**Ma**u múa.", words: [{w:"歌舞伎 (かぶき)", m:"Kịch Kabuki"}, {w:"お見舞い (おみまい)", m:"Thăm bệnh"}] },
            "伎": { hanviet: "KỸ", mean: "Kỹ nghệ", on: "キ", kun: "", radicals: "Nhân (亻) + Chi (支)", tipImg: "Người (亻) có chi (支)êu thức kỹ nghệ.", tipSoundOn: "Kabu**ki** kỹ.", tipSoundKun: "", words: [{w:"歌舞伎 (かぶき)", m:"Kịch Kabuki"}] },
            "泊": { hanviet: "BẠC", mean: "Trọ lại", on: "ハク", kun: "と.まる", radicals: "Thủy (氵) + Bạch (白)", tipImg: "Nước (氵) trắng (白) ở bến bạc.", tipSoundOn: "**Haku** bạc.", tipSoundKun: "**To**maru trọ.", words: [{w:"泊まります (とまります)", m:"Trọ lại"}, {w:"宿泊 (しゅくはく)", m:"Trọ"}] },
            "乗": { hanviet: "THỪA", mean: "Lên xe", on: "ジョウ", kun: "の.る", radicals: "Thiên (千) + Mộc (木)", tipImg: "Cây lúa (禾) trên xe.", tipSoundOn: "**Jou** thừa.", tipSoundKun: "**No**ru lên.", words: [{w:"乗ります (のります)", m:"Lên xe"}, {w:"乗車 (じょうしゃ)", m:"Lên tàu"}] },
            "登": { hanviet: "ĐĂNG", mean: "Leo", on: "トウ", kun: "のぼ.る", radicals: "Bát (癶) + Đậu (豆)", tipImg: "Hai chân đạp lên hạt đậu (豆) leo lên.", tipSoundOn: "**Tou** đăng.", tipSoundKun: "**No**boru leo.", words: [{w:"登ります (のぼります)", m:"Leo núi"}, {w:"登山 (とざん)", m:"Leo núi"}] },
            "釣": { hanviet: "ĐIẾU", mean: "Câu cá", on: "チョウ", kun: "つ.る", radicals: "Kim (金) + Chước (勺)", tipImg: "Kim loại (金) làm cái muôi (勺) câu cá.", tipSoundOn: "**Chou** điếu.", tipSoundKun: "**Tsu**ru câu.", words: [{w:"釣ります (つります)", m:"Câu cá"}] },
            "会": { hanviet: "HỘI", mean: "Gặp", on: "カイ", kun: "あ.う", radicals: "Nhân (人)", tipImg: "Hai người gặp nhau dưới mái nhà.", tipSoundOn: "**Kai** hội.", tipSoundKun: "**A**u gặp.", words: [{w:"会ります (あいます)", m:"Gặp"}, {w:"会話 (かいわ)", m:"Hội thoại"}] },
            "度": { hanviet: "ĐỘ", mean: "Lần/Độ", on: "ド", kun: "たび", radicals: "Nghiễm (广)", tipImg: "Trong nhà (广) hai mươi (廿) tay (又) đo độ.", tipSoundOn: "**Do** độ.", tipSoundKun: "**Tabi** lần.", words: [{w:"一度 (いちど)", m:"Một lần"}, {w:"温度 (おんど)", m:"Nhiệt độ"}] },
            "赤": { hanviet: "XÍCH", mean: "Đỏ", on: "セキ", kun: "あか", radicals: "Xích (赤)", tipImg: "Đất (土) lửa (火) màu đỏ.", tipSoundOn: "**Seki** xích.", tipSoundKun: "**Aka**chan em bé.", words: [{w:"赤ちゃん (あかちゃん)", m:"Em bé"}, {w:"赤い (あかい)", m:"Đỏ"}] },
            "服": { hanviet: "PHỤC", mean: "Quần áo", on: "フク", kun: "", radicals: "Nguyệt (月)", tipImg: "Trăng (月) phục (𠬝) vụ quần áo.", tipSoundOn: "**Fuku** phục.", tipSoundKun: "", words: [{w:"服 (ふく)", m:"Quần áo"}, {w:"洋服 (ようふく)", m:"Âu phục"}] },
            "瓶": { hanviet: "BÌNH", mean: "Bình/Lọ", on: "ビン", kun: "かめ", radicals: "Ngõa (瓦)", tipImg: "Ngói (瓦) ghép lại (并) thành bình.", tipSoundOn: "Ka**bin** bình hoa.", tipSoundKun: "**Kame** bình.", words: [{w:"花瓶 (かびん)", m:"Bình hoa"}, {w:"瓶 (びん)", m:"Chai/Lọ"}] },
            "拭": { hanviet: "THỨC", mean: "Lau", on: "ショク", kun: "ふ.く", radicals: "Thủ (扌) + Thức (式)", tipImg: "Tay (扌) thức (式) tỉnh để lau.", tipSoundOn: "**Shoku** thức.", tipSoundKun: "**Fu**ku lau.", words: [{w:"拭きます (ふきます)", m:"Lau"}, {w:"払拭 (ふっしょく)", m:"Lau sạch/Gạt bỏ"}] },
            "干": { hanviet: "CAN", mean: "Phơi/Khô", on: "カン", kun: "ほ.す", radicals: "Can (干)", tipImg: "Hình cái giá phơi.", tipSoundOn: "**Kan** can.", tipSoundKun: "**Ho**su phơi.", words: [{w:"干します (ほします)", m:"Phơi"}, {w:"干物 (ひもの)", m:"Đồ khô"}] },
            "泳": { hanviet: "VỊNH", mean: "Bơi", on: "エイ", kun: "およ.ぐ", radicals: "Thủy (氵) + Vĩnh (永)", tipImg: "Nước (氵) chảy vĩnh (永) cửu.", tipSoundOn: "**Ei** vịnh.", tipSoundKun: "**Oyo**gu bơi.", words: [{w:"泳ぎます (およぎます)", m:"Bơi"}, {w:"水泳 (すいえい)", m:"Bơi lội"}] },
            "洗": { hanviet: "TẨY", mean: "Rửa", on: "セン", kun: "あら.う", radicals: "Thủy (氵) + Tiên (先)", tipImg: "Nước (氵) tẩy sạch trước (先).", tipSoundOn: "**Sen**taku giặt.", tipSoundKun: "**Ara**u rửa.", words: [{w:"洗濯 (せんたく)", m:"Giặt giũ"}, {w:"洗います (あらいます)", m:"Rửa"}] },
            "濯": { hanviet: "TRẠC", mean: "Giặt", on: "タク", kun: "", radicals: "Thủy (氵)", tipImg: "Nước (氵) giặt lông chim (翟).", tipSoundOn: "Sen**taku** giặt.", tipSoundKun: "", words: [{w:"洗濯 (せんたく)", m:"Giặt giũ"}] },
            "連": { hanviet: "LIÊN", mean: "Liên tục/Dẫn", on: "レン", kun: "つ.れる", radicals: "Xước (⻌) + Xa (車)", tipImg: "Xe (車) đi (⻌) liên tục.", tipSoundOn: "**Ren**kyuu liên hưu.", tipSoundKun: "**Tsu**reru dẫn.", words: [{w:"連休 (れんきゅう)", m:"Kỳ nghỉ dài"}, {w:"連れていきます (つれていきます)", m:"Dẫn đi"}] },
            "休": { hanviet: "HƯU", mean: "Nghỉ", on: "キュウ", kun: "やす.む", radicals: "Nhân (亻) + Mộc (木)", tipImg: "Người (亻) dựa cây (木) nghỉ.", tipSoundOn: "Ren**kyuu** nghỉ.", tipSoundKun: "**Yasu**mu nghỉ.", words: [{w:"連休 (れんきゅう)", m:"Kỳ nghỉ dài"}, {w:"休みます (やすみます)", m:"Nghỉ"}] },
            "音": { hanviet: "ÂM", mean: "Âm thanh", on: "オン", kun: "おと", radicals: "Âm (音)", tipImg: "Đứng (立) nói ngày (日) tạo âm thanh.", tipSoundOn: "**On**gaku âm nhạc.", tipSoundKun: "**Oto** âm thanh.", words: [{w:"音楽 (おんがく)", m:"Âm nhạc"}, {w:"音 (おと)", m:"Âm thanh"}] },
            "楽": { hanviet: "LẠC/NHẠC", mean: "Vui/Nhạc", on: "ガク, ラク", kun: "たの.しい", radicals: "Mộc (木)", tipImg: "Trắng (白) gỗ (木) vui vẻ.", tipSoundOn: "On**gaku** nhạc.", tipSoundKun: "**Tano**shii vui.", words: [{w:"音楽 (おんがく)", m:"Âm nhạc"}, {w:"楽しい (たのしい)", m:"Vui vẻ"}] },
            "外": { hanviet: "NGOẠI", mean: "Ngoài", on: "ガイ", kun: "そと", radicals: "Tịch (夕) + Bốc (卜)", tipImg: "Tối (夕) bói (卜) ngoài đường.", tipSoundOn: "**Gai**kokugo ngoại ngữ.", tipSoundKun: "**Soto** ngoài.", words: [{w:"外国語 (がいこくご)", m:"Ngoại ngữ"}, {w:"外 (そと)", m:"Bên ngoài"}] },
            "国": { hanviet: "QUỐC", mean: "Nước", on: "コク", kun: "くに", radicals: "Vi (囗) + Ngọc (玉)", tipImg: "Vùng đất (口) có vua (玉).", tipSoundOn: "Gai**koku**go nước.", tipSoundKun: "**Kuni** đất nước.", words: [{w:"外国語 (がいこくご)", m:"Ngoại ngữ"}, {w:"国 (くに)", m:"Đất nước"}] },
            "語": { hanviet: "NGỮ", mean: "Ngôn ngữ", on: "ゴ", kun: "かた.る", radicals: "Ngôn (言) + Ngũ (五)", tipImg: "Lời nói (言) của tôi (吾).", tipSoundOn: "Gaikoku**go** ngữ.", tipSoundKun: "**Kata**ru kể.", words: [{w:"外国語 (がいこくご)", m:"Ngoại ngữ"}, {w:"日本語 (にほんご)", m:"Tiếng Nhật"}] },
            "答": { hanviet: "ĐÁP", mean: "Trả lời", on: "トウ", kun: "こた.え", radicals: "Trúc (竹) + Hợp (合)", tipImg: "Trúc (竹) hợp (合) lại trả lời.", tipSoundOn: "**Tou** đáp.", tipSoundKun: "**Kota**e câu trả lời.", words: [{w:"答え (こたえ)", m:"Câu trả lời"}, {w:"答えます (こたえます)", m:"Trả lời"}] },
            "財": { hanviet: "TÀI", mean: "Tiền tài", on: "ザイ", kun: "", radicals: "Bối (貝) + Tài (才)", tipImg: "Tiền (貝) là tài (才) sản.", tipSoundOn: "**Sai**fu ví.", tipSoundKun: "", words: [{w:"財布 (さいふ)", m:"Ví"}] },
            "布": { hanviet: "BỐ", mean: "Vải", on: "フ", kun: "ぬの", radicals: "Cân (巾)", tipImg: "Tay (ナ) cầm khăn (巾) vải.", tipSoundOn: "Sai**fu** ví.", tipSoundKun: "**Nuno** vải.", words: [{w:"財布 (さいふ)", m:"Ví"}, {w:"布 (ぬの)", m:"Vải"}] },
            "壁": { hanviet: "BÍCH", mean: "Tường", on: "ヘキ", kun: "かべ", radicals: "Thổ (土)", tipImg: "Tích (辟) đất (土) làm tường.", tipSoundOn: "**Heki** bích.", tipSoundKun: "**Kabe** tường.", words: [{w:"壁 (かべ)", m:"Tường"}] },
            "遠": { hanviet: "VIỄN", mean: "Xa", on: "エン", kun: "とお.い", radicals: "Xước (⻌) + Viên (袁)", tipImg: "Đi (⻌) bộ mặc áo dài (袁) đi xa.", tipSoundOn: "**En**ryo ngại.", tipSoundKun: "**Too**i xa.", words: [{w:"遠慮 (えんりょ)", m:"Ngại ngần"}, {w:"遠い (とおい)", m:"Xa"}] },
            "慮": { hanviet: "LỰ", mean: "Lưỡng lự", on: "リョ", kun: "", radicals: "Tâm (心)", tipImg: "Hổ (虍) nghĩ (思) lưỡng lự.", tipSoundOn: "En**ryo** ngại.", tipSoundKun: "", words: [{w:"遠慮 (えんりょ)", m:"Ngại ngần"}, {w:"考慮 (こうりょ)", m:"Cân nhắc"}] },
            "無": { hanviet: "VÔ", mean: "Không", on: "ム", kun: "な.い", radicals: "Hỏa (灬)", tipImg: "Không có lửa (灬).", tipSoundOn: "**Mu**ri vô lý.", tipSoundKun: "**Na**kushimasu mất.", words: [{w:"無くします (なくします)", m:"Làm mất"}, {w:"無理 (むり)", m:"Vô lý/Quá sức"}] },
            "心": { hanviet: "TÂM", mean: "Tim", on: "シン", kun: "こころ", radicals: "Tâm (心)", tipImg: "Hình trái tim.", tipSoundOn: "**Shin**pai lo lắng.", tipSoundKun: "**Kokoro** tim.", words: [{w:"心配 (しんぱい)", m:"Lo lắng"}, {w:"心 (こころ)", m:"Trái tim"}] },
            "配": { hanviet: "PHỐI", mean: "Phân phối", on: "ハイ", kun: "くば.る", radicals: "Dậu (酉) + Kỷ (己)", tipImg: "Rượu (酉) của bản thân (己) đem phân phối.", tipSoundOn: "Shin**pai** lo.", tipSoundKun: "**Kuba**ru phân phát.", words: [{w:"心配 (しんぱい)", m:"Lo lắng"}, {w:"配達 (はいたつ)", m:"Chuyển phát"}] },
            "触": { hanviet: "XÚC", mean: "Chạm", on: "ショク", kun: "さわ.る", radicals: "Giác (角)", tipImg: "Góc (角) sâu (虫) chạm vào.", tipSoundOn: "**Shoku** xúc.", tipSoundKun: "**Sawa**ru chạm.", words: [{w:"触ります (さわります)", m:"Chạm/Sờ"}, {w:"感触 (かんしょく)", m:"Cảm giác"}] },
            "動": { hanviet: "ĐỘNG", mean: "Chuyển động", on: "ドウ", kun: "うご.く", radicals: "Lực (力) + Trọng (重)", tipImg: "Dùng sức (力) chuyển trọng (重) lượng.", tipSoundOn: "**Dou** động.", tipSoundKun: "**Ugo**ku động.", words: [{w:"動きます (うごきます)", m:"Cử động"}, {w:"運動 (うんどう)", m:"Vận động"}] },
            "夜": { hanviet: "DẠ", mean: "Đêm", on: "ヤ", kun: "よる", radicals: "Tịch (夕)", tipImg: "Người đứng dưới mái nhà buổi đêm.", tipSoundOn: "**Ya** dạ.", tipSoundKun: "**Yoru** đêm.", words: [{w:"夜 (よる)", m:"Buổi tối"}, {w:"夜中 (よなか)", m:"Nửa đêm"}] },
            "遅": { hanviet: "TRÌ", mean: "Muộn", on: "チ", kun: "おそ.い", radicals: "Xước (⻌)", tipImg: "Con cừu (羊) đi (⻌) muộn.", tipSoundOn: "**Chi** trì.", tipSoundKun: "**Oso**ku muộn.", words: [{w:"夜遅く (よるおそく)", m:"Đêm khuya"}, {w:"遅い (おそい)", m:"Chậm/Trễ"}] },
            "理": { hanviet: "LÝ", mean: "Lý do", on: "リ", kun: "", radicals: "Ngọc (王) + Lý (里)", tipImg: "Vua (王) ở làng (里) có lý.", tipSoundOn: "Mu**ri** vô lý.", tipSoundKun: "", words: [{w:"無理 (むり)", m:"Quá sức"}, {w:"理由 (りゆう)", m:"Lý do"}] },
            "規": { hanviet: "QUY", mean: "Quy tắc", on: "キ", kun: "", radicals: "Kiến (見)", tipImg: "Chồng (夫) nhìn (見) quy tắc.", tipSoundOn: "**Ki**soku quy tắc.", tipSoundKun: "", words: [{w:"規則 (きそく)", m:"Quy tắc"}, {w:"定規 (じょうぎ)", m:"Thước kẻ"}] },
            "則": { hanviet: "TẮC", mean: "Quy tắc", on: "ソク", kun: "", radicals: "Đao (刂)", tipImg: "Tiền (貝) và dao (刂) là quy tắc.", tipSoundOn: "Ki**soku** tắc.", tipSoundKun: "", words: [{w:"規則 (きそく)", m:"Quy tắc"}, {w:"法則 (ほうそく)", m:"Định luật"}] },
            "意": { hanviet: "Ý", mean: "Ý nghĩa", on: "イ", kun: "", radicals: "Tâm (心) + Âm (音)", tipImg: "Tiếng (音) lòng (心) là ý.", tipSoundOn: "**I**mi ý nghĩa.", tipSoundKun: "", words: [{w:"意味 (いみ)", m:"Ý nghĩa"}, {w:"意見 (いけん)", m:"Ý kiến"}] },
            "味": { hanviet: "VỊ", mean: "Vị", on: "ミ", kun: "あじ", radicals: "Khẩu (口) + Vị (未)", tipImg: "Miệng (口) nếm cây chưa chín (未).", tipSoundOn: "I**mi** vị.", tipSoundKun: "**Aji** vị.", words: [{w:"意味 (いみ)", m:"Ý nghĩa"}, {w:"味 (あじ)", m:"Hương vị"}] },
            "受": { hanviet: "THỤ", mean: "Nhận/Dự thi", on: "ジュ", kun: "う.ける", radicals: "Hựu (又)", tipImg: "Móng vuốt (爫) nhận (又) lấy.", tipSoundOn: "**Ju** thụ.", tipSoundKun: "**U**keru nhận.", words: [{w:"受けます (うけます)", m:"Dự thi"}, {w:"受付 (うけつけ)", m:"Lễ tân"}] },
            "水": { hanviet: "THỦY", mean: "Nước", on: "スイ", kun: "みず", radicals: "Thủy (水)", tipImg: "Dòng nước chảy.", tipSoundOn: "**Sui** thủy.", tipSoundKun: "**Mizu** nước.", words: [{w:"水 (みず)", m:"Nước"}, {w:"水道 (すいどう)", m:"Nước máy"}] },
            "制": { hanviet: "CHẾ", mean: "Chế độ", on: "セイ", kun: "", radicals: "Đao (刂)", tipImg: "Con bò (牛) bị dao (刂) khống chế.", tipSoundOn: "**Sei**fuku đồng phục.", tipSoundKun: "", words: [{w:"制服 (せいふく)", m:"Đồng phục"}, {w:"制度 (せいど)", m:"Chế độ"}] },
            "授": { hanviet: "THỤ", mean: "Trao/Dạy", on: "ジュ", kun: "", radicals: "Thủ (扌) + Thụ (受)", tipImg: "Tay (扌) nhận (受) sự truyền thụ.", tipSoundOn: "**Ju**gyou giờ học.", tipSoundKun: "", words: [{w:"授業 (じゅぎょう)", m:"Giờ học"}, {w:"教授 (きょうじゅ)", m:"Giáo sư"}] },
            "業": { hanviet: "NGHIỆP", mean: "Nghề nghiệp", on: "ギョウ", kun: "", radicals: "Mộc (木)", tipImg: "Cây cỏ mọc trên cừu.", tipSoundOn: "Ju**gyou** nghiệp.", tipSoundKun: "", words: [{w:"授業 (じゅぎょう)", m:"Giờ học"}, {w:"残業 (ざんぎょう)", m:"Tăng ca"}] },
            "大": { hanviet: "ĐẠI", mean: "Lớn", on: "ダイ", kun: "おお.きい", radicals: "Đại (大)", tipImg: "Người dang tay chân.", tipSoundOn: "**Dai**gaku đại học.", tipSoundKun: "**Oo**kii to.", words: [{w:"大学 (だいがく)", m:"Đại học"}, {w:"大きい (おおきい)", m:"To lớn"}] },
            "学": { hanviet: "HỌC", mean: "Học", on: "ガク", kun: "まな.ぶ", radicals: "Tử (子)", tipImg: "Đứa trẻ đội mũ đi học.", tipSoundOn: "Dai**gaku** học.", tipSoundKun: "**Mana**bu học.", words: [{w:"大学 (だいがく)", m:"Đại học"}, {w:"学生 (がくせい)", m:"Học sinh"}] },
            "目": { hanviet: "MỤC", mean: "Mắt", on: "モク", kun: "め", radicals: "Mục (目)", tipImg: "Hình con mắt.", tipSoundOn: "**Moku**teki mục đích.", tipSoundKun: "**Me** mắt.", words: [{w:"目的地 (もくてきち)", m:"Điểm đến"}, {w:"目 (め)", m:"Mắt"}] },
            "的": { hanviet: "ĐÍCH", mean: "Đích", on: "テキ", kun: "まと", radicals: "Bạch (白) + Bao (勹)", tipImg: "Màu trắng (白) cái bao (勹) chấm nhỏ (丶).", tipSoundOn: "Moku**teki** đích.", tipSoundKun: "**Mato** đích.", words: [{w:"目的地 (もくてきち)", m:"Điểm đến"}, {w:"目的 (もくてき)", m:"Mục đích"}] },
            "地": { hanviet: "ĐỊA", mean: "Đất", on: "チ", kun: "", radicals: "Thổ (土)", tipImg: "Đất (土) có bọ cạp (也).", tipSoundOn: "Mokuteki**chi** địa.", tipSoundKun: "", words: [{w:"目的地 (もくてきち)", m:"Điểm đến"}, {w:"地下鉄 (ちかてつ)", m:"Tàu điện ngầm"}] },
            "喫": { hanviet: "KHIẾT", mean: "Uống/Ăn", on: "キツ", kun: "", radicals: "Khẩu (口) + Khế (契)", tipImg: "Miệng (口) ký kết (契).", tipSoundOn: "**Kis**saten quán nước.", tipSoundKun: "", words: [{w:"喫茶店 (きっさてん)", m:"Quán giải khát"}, {w:"喫煙 (きつえん)", m:"Hút thuốc"}] },
            "茶": { hanviet: "TRÀ", mean: "Trà", on: "チャ", kun: "", radicals: "Thảo (艹)", tipImg: "Cỏ (艹) người (人) cây (木) là trà.", tipSoundOn: "Kis**sa**ten trà.", tipSoundKun: "", words: [{w:"喫茶店 (きっさてん)", m:"Quán giải khát"}, {w:"お茶 (おちゃ)", m:"Trà"}] },
            "店": { hanviet: "ĐIẾM", mean: "Cửa hàng", on: "テン", kun: "みせ", radicals: "Nghiễm (广) + Chiếm (占)", tipImg: "Trong nhà (广) xem bói (占) để mở quán.", tipSoundOn: "Kissa**ten** tiệm.", tipSoundKun: "**Mise** tiệm.", words: [{w:"喫茶店 (きっさてん)", m:"Quán giải khát"}, {w:"店 (みせ)", m:"Cửa hàng"}] },
            "問": { hanviet: "VẤN", mean: "Hỏi", on: "モン", kun: "と.い", radicals: "Môn (門) + Khẩu (口)", tipImg: "Miệng (口) ở cổng (門) hỏi.", tipSoundOn: "Shitsu**mon** câu hỏi.", tipSoundKun: "**To**i câu hỏi.", words: [{w:"質問 (しつもん)", m:"Câu hỏi"}, {w:"問題 (もんだい)", m:"Vấn đề"}] },
            "題": { hanviet: "ĐỀ", mean: "Vấn đề", on: "ダイ", kun: "", radicals: "Hiệt (頁) + Thị (是)", tipImg: "Đúng (是) là cái đầu (頁) có vấn đề.", tipSoundOn: "Mon**dai** đề.", tipSoundKun: "", words: [{w:"問題 (もんだい)", m:"Vấn đề"}, {w:"宿題 (しゅくだい)", m:"Bài tập"}] },
            "咳": { hanviet: "KHÁI", mean: "Ho", on: "ガイ", kun: "せき", radicals: "Khẩu (口) + Hợi (亥)", tipImg: "Miệng (口) hợi (亥) ho.", tipSoundOn: "**Gai** khái.", tipSoundKun: "**Seki** ho.", words: [{w:"咳 (せき)", m:"Ho"}] },
            "傷": { hanviet: "THƯƠNG", mean: "Vết thương", on: "ショウ", kun: "きず", radicals: "Nhân (亻) + Dương (昜)", tipImg: "Người (亻) dương (昜) bị thương.", tipSoundOn: "**Shou** thương.", tipSoundKun: "**Kizu** thương.", words: [{w:"傷 (きず)", m:"Vết thương"}, {w:"負傷 (ふしょう)", m:"Bị thương"}] },
            "熱": { hanviet: "NHIỆT", mean: "Nóng/Sốt", on: "ネツ", kun: "あつ.い", radicals: "Hỏa (灬)", tipImg: "Thế lực (丸) đốt lửa (灬) nóng.", tipSoundOn: "**Netsu** sốt.", tipSoundKun: "**Atsu**i nóng.", words: [{w:"熱 (ねつ)", m:"Sốt"}, {w:"熱い (あつい)", m:"Nóng"}] },
            "薬": { hanviet: "DƯỢC", mean: "Thuốc", on: "ヤク", kun: "くすり", radicals: "Thảo (艹) + Nhạc (楽)", tipImg: "Cỏ (艹) vui (楽) là thuốc.", tipSoundOn: "**Yaku** dược.", tipSoundKun: "**Kusuri** thuốc.", words: [{w:"薬 (くすり)", m:"Thuốc"}, {w:"薬局 (やっきょく)", m:"Hiệu thuốc"}] },
            "食": { hanviet: "THỰC", mean: "Ăn", on: "ショク", kun: "た.べる", radicals: "Thực (食)", tipImg: "Người tốt (艮) có lương thực.", tipSoundOn: "Gai**shoku** thực.", tipSoundKun: "**Ta**beru ăn.", words: [{w:"外食 (がいしょく)", m:"Ăn ngoài"}, {w:"食べる (たべる)", m:"Ăn"}] },
            "治": { hanviet: "TRỊ", mean: "Chữa trị", on: "ジ", kun: "なお.る", radicals: "Thủy (氵) + Đài (台)", tipImg: "Nước (氵) cái đài (台) chữa trị.", tipSoundOn: "**Ji** trị.", tipSoundKun: "**Nao**ru trị.", words: [{w:"治ります (なきます)", m:"Khỏi bệnh"}, {w:"治療 (ちりょう)", m:"Điều trị"}] },
            "太": { hanviet: "THÁI", mean: "Béo", on: "タイ", kun: "ふと.る", radicals: "Đại (大) + Chấm (丶)", tipImg: "Người to lớn (大) có điểm (丶).", tipSoundOn: "**Tai** thái.", tipSoundKun: "**Futo**ru béo.", words: [{w:"太ります (ふとります)", m:"Béo lên"}, {w:"太い (ふとい)", m:"Béo/Dày"}] },
            "着": { hanviet: "TRƯỚC", mean: "Đến", on: "チャク", kun: "つ.く", radicals: "Dương (⺶) + Mục (目)", tipImg: "Dê (⺶) nhìn (目) đích đến.", tipSoundOn: "**Chaku** trước.", tipSoundKun: "**Tsu**ku đến.", words: [{w:"着きます (つきます)", m:"Đến nơi"}, {w:"到着 (とうちゃく)", m:"Đến"}] },
            "釣": { hanviet: "ĐIẾU", mean: "Câu cá", on: "チョウ", kun: "つ.る", radicals: "Kim (金) + Chước (勺)", tipImg: "Kim loại (金) cái muôi (勺) câu cá.", tipSoundOn: "**Chou** điếu.", tipSoundKun: "**Tsu**ru câu.", words: [{w:"お釣り (おつり)", m:"Tiền thừa"}, {w:"釣ります (つります)", m:"Câu cá"}] },
            "質": { hanviet: "CHẤT", mean: "Chất lượng/Hỏi", on: "シツ", kun: "", radicals: "Bối (貝) + Cân (斤)", tipImg: "Hai cái rìu (斤) trên tiền (貝).", tipSoundOn: "**Shitsu**mon chất vấn.", tipSoundKun: "", words: [{w:"質問 (しつもん)", m:"Câu hỏi"}, {w:"品質 (ひんしつ)", m:"Chất lượng"}] },
            "集": { hanviet: "TẬP", mean: "Tập hợp", on: "シュウ", kun: "あつ.める", radicals: "Mộc (木) + Chuy (隹)", tipImg: "Chim (隹) trên cây (木) tập hợp.", tipSoundOn: "**Shuu** tập.", tipSoundKun: "**Atsu**meru tập.", words: [{w:"集めます (あつめます)", m:"Tập hợp/Sưu tầm"}, {w:"集中 (しゅうちゅう)", m:"Tập trung"}] },
            "困": { hanviet: "KHỐN", mean: "Khó khăn", on: "コン", kun: "こま.る", radicals: "Vi (囗) + Mộc (木)", tipImg: "Cây (木) trong khung (囗) khốn khổ.", tipSoundOn: "**Kon** khốn.", tipSoundKun: "**Koma**ru khốn.", words: [{w:"困ります (こまります)", m:"Gặp khó khăn"}, {w:"困難 (こんなん)", m:"Khó khăn"}] },
            "渡": { hanviet: "ĐỘ", mean: "Trao/Qua", on: "ト", kun: "わた.す", radicals: "Thủy (氵) + Độ (度)", tipImg: "Nước (氵) độ (度) qua sông.", tipSoundOn: "**To** độ.", tipSoundKun: "**Wata**su độ.", words: [{w:"渡します (わたします)", m:"Trao/Đưa"}, {w:"渡ります (わたります)", m:"Băng qua"}] },
            "貼": { hanviet: "THIẾP", mean: "Dán", on: "テン", kun: "は.る", radicals: "Bối (貝) + Chiếm (占)", tipImg: "Tiền (貝) chiếm (占) chỗ dán.", tipSoundOn: "**Ten** thiếp.", tipSoundKun: "**Ha**ru dán.", words: [{w:"貼ります (はります)", m:"Dán"}] },
            "疲": { hanviet: "BÌ", mean: "Mệt", on: "ヒ", kun: "つか.れる", radicals: "Nạch (疒) + Bì (皮)", tipImg: "Bệnh (疒) da (皮) mệt mỏi.", tipSoundOn: "**Hi** bì.", tipSoundKun: "**Tsuka**reru mệt.", words: [{w:"疲れます (つかれます)", m:"Mệt mỏi"}] },
            "並": { hanviet: "TỊNH", mean: "Xếp hàng", on: "ヘイ", kun: "なら.べる", radicals: "Lập (立)", tipImg: "Hai người đứng (立) ngang nhau.", tipSoundOn: "**Hei** tịnh.", tipSoundKun: "**Nara**beru tịnh.", words: [{w:"並べます (ならべます)", m:"Sắp xếp"}, {w:"並びます (ならびます)", m:"Xếp hàng"}] },
            "生": { hanviet: "SINH", mean: "Sinh ra", on: "セイ", kun: "う.まれる", radicals: "Sinh (生)", tipImg: "Cây cỏ mọc trên đất.", tipSoundOn: "**Sei** sinh.", tipSoundKun: "**U**mareru sinh.", words: [{w:"生まれます (うまれます)", m:"Sinh ra"}, {w:"誕生日 (たんじょうび)", m:"Sinh nhật"}] },
            "差": { hanviet: "SAI", mean: "Giương/Sai khác", on: "サ", kun: "さ.す", radicals: "Dương (⺶) + Công (工)", tipImg: "Dê (⺶) làm công (工) bị sai.", tipSoundOn: "**Sa** sai.", tipSoundKun: "**Sa**su giương.", words: [{w:"差します (さします)", m:"Giương (ô)"}, {w:"交差点 (こうさてん)", m:"Ngã tư"}] },
            "頼": { hanviet: "LẠI", mean: "Nhờ cậy", on: "ライ", kun: "たの.む", radicals: "Hiệt (頁) + Thúc (束)", tipImg: "Cố gắng (束) kiếm tiền (頁) để nhờ cậy.", tipSoundOn: "**Rai** lại.", tipSoundKun: "**Tano**mu lại.", words: [{w:"頼みます (たのみます)", m:"Nhờ cậy"}, {w:"信頼 (しんらい)", m:"Tin cậy"}] },
            "守": { hanviet: "THỦ", mean: "Bảo vệ/Tuân thủ", on: "シュ", kun: "まも.る", radicals: "Miên (宀) + Thốn (寸)", tipImg: "Trong nhà (宀) có tấc (寸) lòng thủ giữ.", tipSoundOn: "**Shu** thủ.", tipSoundKun: "**Mamo**ru thủ.", words: [{w:"守ります (まもります)", m:"Tuân thủ/Bảo vệ"}, {w:"留守 (るす)", m:"Vắng nhà"}] },
            "現": { hanviet: "HIỆN", mean: "Hiện tại", on: "ゲン", kun: "", radicals: "Vương (王) + Kiến (見)", tipImg: "Vua (王) nhìn (見) hiện tại.", tipSoundOn: "**Gen**kin hiện kim.", tipSoundKun: "", words: [{w:"現金 (げんきん)", m:"Tiền mặt"}, {w:"現在 (げんざい)", m:"Hiện tại"}] },
            "金": { hanviet: "KIM", mean: "Tiền/Vàng", on: "キン", kun: "かね", radicals: "Kim (金)", tipImg: "Vàng chôn dưới đất.", tipSoundOn: "Gen**kin** kim.", tipSoundKun: "**Kane** tiền.", words: [{w:"現金 (げんきん)", m:"Tiền mặt"}, {w:"お金 (おかね)", m:"Tiền"}] },
            "趣": { hanviet: "THÚ", mean: "Hứng thú", on: "シュ", kun: "", radicals: "Tẩu (走) + Thủ (取)", tipImg: "Chạy (走) đi lấy (取) hứng thú.", tipSoundOn: "**Shu**mi thú.", tipSoundKun: "", words: [{w:"趣味 (しゅみ)", m:"Sở thích/Gu"}] },
            "読": { hanviet: "ĐỘC", mean: "Đọc", on: "ドク", kun: "よ.む", radicals: "Ngôn (言) + Mại (売)", tipImg: "Nói (言) bán (売) sách cho độc giả.", tipSoundOn: "**Doku**sho độc thư.", tipSoundKun: "**Yo**mu đọc.", words: [{w:"読書 (どくしょ)", m:"Đọc sách"}, {w:"読みます (よみます)", m:"Đọc"}] },
            "書": { hanviet: "THƯ", mean: "Viết", on: "ショ", kun: "か.く", radicals: "Duật (聿) + Nhật (日)", tipImg: "Tay cầm bút viết.", tipSoundOn: "Doku**sho** thư.", tipSoundKun: "**Ka**ku viết.", words: [{w:"読書 (どくしょ)", m:"Đọc sách"}, {w:"辞書 (じしょ)", m:"Từ điển"}] }
        };

        // --- 4. APP LOGIC (Standard Day 1 Logic) ---
        let currentIndex = 0; 
        let currentQuizItem = null; 
        let score = 0; 
        let currentStrokeSvg = null;

        function init() {
            renderList();
            renderGrammarMenu();
            loadWord(0);
            
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', e => { 
                    const t = e.target.value.toLowerCase(); 
                    document.querySelectorAll('.vocab-item').forEach(el => el.style.display = el.innerText.toLowerCase().includes(t) ? 'block' : 'none'); 
                });
            }

            const mobileSearchInput = document.getElementById('mobileSearchInput');
            if (mobileSearchInput) {
                mobileSearchInput.addEventListener('input', e => { 
                    const t = e.target.value.toLowerCase(); 
                    document.querySelectorAll('.vocab-item').forEach(el => el.style.display = el.innerText.toLowerCase().includes(t) ? 'block' : 'none'); 
                });
            }

            const quizInput = document.getElementById('quiz-input');
            if (quizInput) {
                quizInput.addEventListener('keypress', e => { if(e.key === 'Enter') checkAnswer(); });
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            document.getElementById('learn-section').classList.toggle('hidden', tab !== 'learn');
            document.getElementById('quiz-section').classList.toggle('hidden', tab !== 'quiz');
            if(tab === 'quiz') nextQuestion();
        }

        function renderList() {
            const listD = document.getElementById('vocabList'); 
            const listM = document.getElementById('mobileVocabList');
            const html = vocabData.map((item, i) => `
                <div class="vocab-item p-3 border-b hover:bg-gray-50 cursor-pointer rounded-lg mx-1 my-1" data-index="${i}" onclick="loadWord(${i}); if(window.innerWidth < 768) toggleDrawer();">
                    <div class="flex justify-between font-bold items-center">
                        <span class="text-gray-800 ja-text">${item.Kanji || item.Furigana}</span>
                        <span class="text-gray-300 text-xs font-mono">#${item.STT}</span>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 truncate">${item.Nghĩa}</div>
                </div>`).join('');
            if (listD) listD.innerHTML = html;
            if (listM) listM.innerHTML = html;
        }

        function loadWord(idx) {
            currentIndex = idx; 
            const word = vocabData[idx];
            document.querySelectorAll('.vocab-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll(`.vocab-item[data-index="${idx}"]`).forEach(el => el.classList.add('active'));
            
            const activeItem = document.querySelector(`.vocab-item[data-index="${idx}"]`);
            if (activeItem) activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            document.getElementById('headerProgress').innerText = `${idx+1}/${vocabData.length}`;
            document.getElementById('wordIndex').innerText = `#${word.STT}`;
            document.getElementById('cardKanji').innerText = word.Kanji || word.Furigana;
            document.getElementById('cardFurigana').innerText = word.Furigana;
            document.getElementById('cardMeaning').innerText = word.Nghĩa;
            document.getElementById('wordType').innerText = word.type.toUpperCase();
            
            const hasKanji = word.Kanji && word.Kanji !== word.Furigana;
            document.getElementById('strokeBtn').classList.toggle('hidden', !hasKanji);
            
            renderShadowing(word);
        }

        function renderShadowing(word) {
            const cont = document.getElementById('sentenceList'); 
            cont.innerHTML = '';
            
            if(!word.conv) { 
                document.getElementById('emptyState').classList.remove('hidden'); 
                return; 
            }
            document.getElementById('emptyState').classList.add('hidden');
            
            const types = [
                { k:'polite', l:'Lịch sự', m:word.conv.pVi, i:'user-tie', c:'indigo' }, 
                { k:'casual', l:'Thân mật', m:word.conv.cVi, i:'comments', c:'pink' }
            ];
            
            types.forEach(t => {
                const grammarBtn = word.conv.gIds && word.conv.gIds.length > 0 
                    ? `<button onclick="openExplan('${word.conv.gIds.join(',')}')" class="text-xs text-indigo-500 hover:text-indigo-700 font-bold px-2 py-1 rounded hover:bg-indigo-50 transition"><i class="fas fa-info-circle"></i> Ngữ pháp</button>`
                    : '';

                cont.innerHTML += `
                    <div class="shadow-card bg-white rounded-2xl p-4 border border-gray-100">
                        <div class="flex justify-between border-b border-gray-100 pb-2 mb-3">
                            <div class="flex gap-2 items-center">
                                <div class="bg-${t.c}-50 p-1.5 rounded text-${t.c}-600"><i class="fas fa-${t.i}"></i></div>
                                <span class="text-xs font-bold text-gray-400 uppercase tracking-wide">${t.l}</span>
                            </div>
                            ${grammarBtn}
                        </div>
                        <div class="flex justify-between items-start gap-3">
                            <div>
                                <div class="text-lg md:text-xl ja-text font-medium text-gray-800 mb-1 cursor-pointer hover:text-indigo-600 transition-colors" onclick="speakText('${word.conv[t.k]}')">${word.conv[t.k]}</div>
                                <div class="text-sm text-gray-500 italic">${t.m}</div>
                            </div>
                            <button onclick="speakText('${word.conv[t.k]}')" class="audio-btn text-${t.c}-400 hover:text-${t.c}-600 p-2 rounded-full hover:bg-${t.c}-50 transition-colors flex-shrink-0">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                        </div>
                    </div>`;
            });
        }

        function openExplan(idsStr) {
            const ids = idsStr.split(','); 
            const f = document.getElementById('dgFormula'); 
            const e = document.getElementById('dgExplanation');
            
            f.innerText = ids.map(id => grammarRepo[id] ? grammarRepo[id].formula : "N/A").join("  /  ");
            e.innerHTML = ids.map(id => {
                if (!grammarRepo[id]) return `<div class="text-red-500">Missing grammar: ${id}</div>`;
                return `
                <div class="pb-2 border-b border-gray-100 last:border-0">
                    <strong class="text-indigo-700 block mb-1">${grammarRepo[id].title} <span class="text-xs font-normal text-gray-400">(${grammarRepo[id].desc.split(':')[0]})</span></strong>
                    <p>${grammarRepo[id].desc.split(':').slice(1).join(':') || grammarRepo[id].desc}</p>
                    <p class="text-xs text-gray-400 mt-1 italic">Vd: ${grammarRepo[id].ex}</p>
                </div>`;
            }).join("");
            
            showModal('detailGrammarModal');
        }

        function renderGrammarMenu() {
            const grid = document.getElementById('grammarGrid'); 
            grid.innerHTML = '';
            Object.keys(grammarRepo).forEach(key => {
                const r = grammarRepo[key];
                grid.innerHTML += `
                    <div class="bg-white p-4 rounded-xl border border-gray-100 flex flex-col justify-between hover:shadow-md transition cursor-pointer" onclick="speakText('${r.ex}')">
                        <div>
                            <div class="font-bold text-sm text-indigo-600 mb-1 flex items-center gap-2"><i class="fas fa-tag text-xs"></i> ${r.title}</div>
                            <code class="text-xs block bg-gray-50 p-1.5 rounded mb-2 border border-gray-200 font-mono text-gray-700">${r.formula}</code>
                            <p class="text-xs text-gray-500 mb-2 line-clamp-2">${r.desc}</p>
                        </div>
                        <div class="bg-indigo-50 p-2 rounded flex justify-between items-center gap-2 mt-2">
                            <span class="text-[11px] font-medium text-indigo-800 ja-text truncate">${r.ex}</span>
                            <i class="fas fa-volume-up text-indigo-400 text-xs"></i>
                        </div>
                    </div>`;
            });
        }

        function showModal(id) { 
            const modal = document.getElementById(id);
            modal.classList.remove('hidden'); 
            setTimeout(() => { 
                document.getElementById(id.replace('Modal','Backdrop')).classList.remove('opacity-0'); 
                document.getElementById(id.replace('Modal','Panel')).classList.remove('opacity-0', 'scale-95'); 
            }, 10); 
        }
        function closeModal(id) { 
            const b = document.getElementById(id.replace('Modal','Backdrop')); 
            const p = document.getElementById(id.replace('Modal','Panel'));
            if(b) b.classList.add('opacity-0'); 
            if(p) p.classList.add('opacity-0', 'scale-95');
            setTimeout(() => document.getElementById(id).classList.add('hidden'), 200); 
        }
        function openGrammarList() { showModal('grammarListModal'); }

        async function openStrokeModal(char) {
            const word = vocabData[currentIndex]; 
            const kanjis = word.Kanji.match(/[\u4e00-\u9faf]/g) || [];
            if(kanjis.length === 0) return;
            const target = char || kanjis[0];
            const tabs = document.getElementById('strokeTabs'); 
            tabs.innerHTML = '';
            if(kanjis.length > 1) {
                kanjis.forEach(k => {
                    const b = document.createElement('button'); 
                    b.innerText = k;
                    b.className = `w-12 h-12 text-xl rounded-xl font-bold border transition ja-text ${k===target ? 'bg-pink-600 text-white border-pink-600 shadow-lg' : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'}`;
                    b.onclick = () => showKanjiStroke(k); 
                    tabs.appendChild(b);
                });
            }
            showModal('strokeModal'); 
            await showKanjiStroke(target);
        }

        async function showKanjiStroke(k) {
            const d = kanjiDetails[k]; 
            const c = document.getElementById('kanjiDetailContent'); 
            const e = document.getElementById('kanjiDetailEmpty');
            if(d) {
                c.classList.remove('hidden'); e.classList.add('hidden');
                document.getElementById('detailKanji').innerText = k; 
                document.getElementById('detailHanViet').innerText = d.hanviet || '?';
                document.getElementById('detailMeaning').innerText = d.mean || ''; 
                document.getElementById('detailOn').innerText = d.on || '-'; 
                document.getElementById('detailKun').innerText = d.kun || '-';
                document.getElementById('detailRadicals').innerText = d.radicals || '...';
                
                const fmt = s => s.replace(/\*\*(.*?)\*\*/g, '<span class="font-bold text-gray-900">$1</span>');
                document.getElementById('detailTipImg').innerHTML = fmt(d.tipImg || ''); 
                document.getElementById('detailTipSoundOn').innerHTML = fmt(d.tipSoundOn || ''); 
                document.getElementById('detailTipSoundKun').innerHTML = fmt(d.tipSoundKun || '');
                
                document.getElementById('btnPlayOn').onclick = () => speakText(d.on);
                document.getElementById('btnPlayKun').onclick = () => speakText(d.kun);

                const wc = document.getElementById('detailWords'); 
                wc.innerHTML = '';
                if(d.words) {
                    d.words.forEach(w => wc.innerHTML += `<div class="flex justify-between items-center bg-gray-50 p-2 rounded hover:bg-gray-100 cursor-pointer border border-transparent hover:border-gray-200 transition" onclick="speakText('${w.w}')"><span class="text-lg font-bold text-indigo-700 ja-text">${w.w}</span><span class="text-xs text-gray-500 font-medium">${w.m}</span></div>`);
                }
            } else { 
                c.classList.add('hidden'); e.classList.remove('hidden'); 
            }
            const anim = document.getElementById('strokeAnimContainer'); 
            const grid = document.getElementById('strokeGridContainer');
            anim.innerHTML = '<i class="fas fa-spinner fa-spin text-gray-300 text-2xl"></i>'; 
            grid.innerHTML = '';
            try {
                const r = await fetch(`https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg/kanji/${getKanjiHex(k)}.svg`);
                if(!r.ok) throw new Error();
                const svgText = await r.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(svgText, "image/svg+xml");
                doc.querySelectorAll('path').forEach(p => p.setAttribute('style', 'opacity:0; stroke:#333; stroke-width:3; fill:none; stroke-linecap:round; stroke-linejoin:round;')); 
                anim.innerHTML = new XMLSerializer().serializeToString(doc.documentElement);
                const mainSvg = anim.querySelector('svg');
                mainSvg.setAttribute('width','100%'); mainSvg.setAttribute('height','100%');
                currentStrokeSvg = mainSvg;
                replayStrokeAnimation();
                const cleanDoc = parser.parseFromString(svgText, "image/svg+xml"); 
                cleanDoc.querySelectorAll('path').forEach((p, i) => {
                    const b = document.createElement('div'); 
                    b.className = "w-16 h-16 stroke-grid-box flex items-center justify-center rounded bg-white shadow-sm";
                    const clone = cleanDoc.documentElement.cloneNode(true);
                    clone.setAttribute('width','100%'); clone.setAttribute('height','100%');
                    clone.querySelectorAll('path').forEach((pp, idx) => {
                        pp.style.fill="none"; pp.style.strokeLinecap="round"; pp.style.strokeLinejoin="round";
                        if(idx<i) { pp.style.stroke="#e5e7eb"; pp.style.strokeWidth="3"; }
                        else if(idx===i) { pp.style.stroke="#db2777"; pp.style.strokeWidth="4"; } 
                        else pp.style.display="none";
                    });
                    b.appendChild(clone); grid.appendChild(b);
                });
            } catch(e) { anim.innerHTML = "<span class='text-xs text-red-400'>Lỗi tải nét viết</span>"; }
        }

        function replayStrokeAnimation() {
            if(!currentStrokeSvg) return;
            const paths = currentStrokeSvg.querySelectorAll('path');
            paths.forEach(p => { p.style.transition='none'; p.style.opacity='0'; });
            void currentStrokeSvg.offsetWidth;
            let delay = 0;
            paths.forEach(p => {
                const len = p.getTotalLength();
                p.style.strokeDasharray = len; p.style.strokeDashoffset = len; p.style.opacity = '1';
                setTimeout(() => { p.style.transition = `stroke-dashoffset 0.6s ease-in-out`; p.style.strokeDashoffset = '0'; }, delay * 1000);
                delay += 0.6;
            });
        }

        function getKanjiHex(k) { return k.charCodeAt(0).toString(16).padStart(5, '0'); }
        function speakText(t) { if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(t); u.lang = 'ja-JP'; u.rate = 0.9; speechSynthesis.speak(u); } }
        function speakCurrent() { speakText(vocabData[currentIndex].Furigana); }
        function toggleDrawer() { const d = document.getElementById('mobileDrawer'); const c = document.getElementById('drawerContent'); const b = document.getElementById('drawerBackdrop'); if(d.classList.contains('pointer-events-none')) { d.classList.remove('pointer-events-none'); c.classList.remove('-translate-x-full'); b.classList.remove('opacity-0'); } else { c.classList.add('-translate-x-full'); b.classList.add('opacity-0'); setTimeout(() => d.classList.add('pointer-events-none'), 300); } }

        function nextQuestion() {
            document.getElementById('feedback-area').classList.add('hidden'); document.getElementById('btn-check').classList.remove('hidden'); document.getElementById('btn-next').classList.add('hidden');
            document.getElementById('quiz-kanji').className = "text-6xl ja-text font-bold text-gray-800 mb-4 transition-all inline-block";
            const inp = document.getElementById('quiz-input'); inp.value = ''; inp.disabled = false; inp.focus();
            const valid = vocabData.filter(v => v.Furigana !== "...");
            currentQuizItem = valid[Math.floor(Math.random() * valid.length)];
            document.getElementById('quiz-kanji').innerText = currentQuizItem.Kanji || currentQuizItem.Furigana;
            document.getElementById('quiz-meaning').innerText = currentQuizItem.Nghĩa;
        }
        function checkAnswer() {
            const inp = document.getElementById('quiz-input'); if(!inp.value.trim()) return;
            inp.disabled = true; 
            const correct = inp.value.trim() === currentQuizItem.Furigana;
            const k = document.getElementById('quiz-kanji'); const fbTitle = document.getElementById('feedback-title'); const fbArea = document.getElementById('feedback-area');
            if(correct) { 
                score += 10; k.classList.add("text-green-600", "correct-anim"); 
                fbTitle.innerHTML = '<span class="text-green-600"><i class="fas fa-check-circle mr-2"></i> Chính xác!</span>';
                fbArea.className = fbArea.className.replace("bg-red-50 border-red-200", "") + " bg-green-50 border-green-200";
                speakText(currentQuizItem.Furigana); 
            } else { 
                score = Math.max(0, score - 5); k.classList.add("text-red-500", "wrong-anim"); 
                fbTitle.innerHTML = '<span class="text-red-600"><i class="fas fa-times-circle mr-2"></i> Sai rồi!</span>';
                fbArea.className = fbArea.className.replace("bg-green-50 border-green-200", "") + " bg-red-50 border-red-200";
            }
            document.getElementById('score-display').innerText = score; document.getElementById('correct-answer').innerText = currentQuizItem.Furigana;
            document.getElementById('feedback-area').classList.remove('hidden'); document.getElementById('btn-check').classList.add('hidden'); document.getElementById('btn-next').classList.remove('hidden');
        }
        function playQuizAudio() { if(currentQuizItem) speakText(currentQuizItem.Furigana); }
        function prevWord() { if(currentIndex > 0) loadWord(currentIndex - 1); }
        function nextWord() { if(currentIndex < vocabData.length - 1) loadWord(currentIndex + 1); }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
