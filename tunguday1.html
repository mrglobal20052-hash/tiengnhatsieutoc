<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AzaKanji Tango - Ngày 1: Hội thoại Thực tế</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    
    <style>
        body { font-family: 'Nunito', 'Inter', sans-serif; background-color: #f3f4f6; height: 100dvh; overflow: hidden; }
        .ja-text { font-family: 'Noto Sans JP', sans-serif; }
        .scroller { -webkit-overflow-scrolling: touch; }
        .scroller::-webkit-scrollbar { width: 5px; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
        .vocab-item.active { background-color: #eef2ff; border-left: 4px solid #4f46e5; color: #4338ca; }
        .shadow-card { transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.3); }
        .tab-btn.active { background-color: white; color: #312e81; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
        .tab-btn { color: #a5b4fc; }
        .stroke-grid-box { border: 1px solid #e5e7eb; background-color: white; position: relative; }
        .stroke-grid-box::after { content: ''; position: absolute; top: 0; left: 50%; width: 1px; height: 100%; background: repeating-linear-gradient(to bottom, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); }
        .stroke-grid-box::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px; background: repeating-linear-gradient(to right, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); }
    </style>
</head>
<body class="flex flex-col text-slate-800">

    <header class="bg-indigo-700 text-white shadow-lg flex-none z-40 relative">
        <div class="container mx-auto px-4 py-2 md:py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-3">
                <div class="flex items-center gap-3 cursor-pointer select-none w-full md:w-auto justify-between" onclick="location.reload()">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-torii-gate text-3xl text-white"></i>
                        <div>
                            <h1 class="text-lg md:text-xl font-bold uppercase tracking-wider">AzaKanji Tango</h1>
                            <p class="text-[10px] md:text-xs text-indigo-200">Shadowing & Grammar - Ngày 1</p>
                        </div>
                    </div>
                    <div class="md:hidden text-xs font-semibold bg-indigo-800 px-3 py-1 rounded-full border border-indigo-500/50"><span id="headerProgress">1/87</span></div>
                </div>
                <div class="flex items-center gap-3 w-full md:w-auto">
                    <div class="flex bg-indigo-900/50 rounded-lg p-1 w-full md:w-auto overflow-x-auto no-scrollbar">
                        <button onclick="switchTab('learn')" id="tab-learn" class="tab-btn active flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2"><i class="fas fa-book-open"></i> Học Từ</button>
                        <button onclick="switchTab('quiz')" id="tab-quiz" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2"><i class="fas fa-keyboard"></i> Kiểm Tra</button>
                        <div class="w-px bg-indigo-600 mx-1"></div>
                        <button onclick="openGrammarList()" class="tab-btn flex-1 md:flex-none px-4 py-1.5 rounded-md text-sm font-bold transition flex items-center justify-center gap-2"><i class="fas fa-scroll"></i> Cẩm Nang</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden relative w-full">
        <div id="learn-section" class="flex flex-1 w-full overflow-hidden absolute inset-0">
            <aside class="hidden md:flex w-72 bg-white border-r border-gray-200 flex-col z-10">
                <div class="p-4 border-b border-gray-100 bg-gray-50"><input type="text" id="searchInput" placeholder="Tìm kiếm từ..." class="w-full px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 transition-all shadow-sm"></div>
                <div id="vocabList" class="flex-1 overflow-y-auto scroller p-2 space-y-1"></div>
            </aside>
            <main id="mainContent" class="flex-1 overflow-y-auto scroller bg-slate-50 p-4 pb-28 w-full scroll-smooth">
                <div class="max-w-3xl mx-auto flex flex-col items-center">
                    <div class="w-full bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6 relative overflow-hidden group">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-indigo-50 to-pink-50 rounded-bl-full -mr-8 -mt-8 z-0 opacity-60"></div>
                        <div class="relative z-10 text-center">
                            <div class="inline-flex items-center gap-2 bg-gray-50 px-3 py-1 rounded-full mb-4 border border-gray-100"><span id="wordType" class="text-[10px] font-bold uppercase text-indigo-500">WORD</span><div class="w-px h-3 bg-gray-300"></div><span class="text-[10px] text-gray-400 font-mono" id="wordIndex">#1</span></div>
                            <div class="relative inline-block">
                                <h2 id="cardKanji" class="text-5xl md:text-6xl font-bold text-gray-800 mb-2 ja-text tracking-tight cursor-pointer hover:text-indigo-700 transition-colors" onclick="speakCurrent()">見ます</h2>
                                <button id="strokeBtn" onclick="openStrokeModal()" class="absolute -right-10 top-2 w-8 h-8 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center shadow-sm hover:bg-pink-200 hover:scale-110 transition-all hidden"><i class="fas fa-pen-nib text-sm"></i></button>
                            </div>
                            <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="speakCurrent()"><span id="cardFurigana" class="text-xl text-indigo-600 font-medium ja-text">みます</span><span id="cardMeaning" class="text-lg text-gray-500">Xem, nhìn, trông</span></div>
                        </div>
                    </div>
                    <div class="w-full">
                        <div class="flex items-center gap-2 mb-4 px-1"><div class="bg-pink-100 text-pink-600 p-1.5 rounded-lg"><i class="fas fa-comments"></i></div><h3 class="font-bold text-gray-700 text-lg">Hội thoại đời sống</h3></div>
                        <div id="sentenceList" class="space-y-4"></div>
                        <div id="emptyState" class="hidden flex-col items-center justify-center p-8 text-center bg-white rounded-2xl border border-dashed border-gray-300 text-gray-400"><i class="fas fa-comment-slash text-4xl mb-2"></i><p class="text-sm">Chưa có hội thoại cho từ này.</p></div>
                    </div>
                </div>
            </main>
            <div class="fixed bottom-0 left-0 right-0 glass px-4 py-3 pb-6 z-30 flex items-center justify-between gap-4 md:hidden shadow-lg border-t border-gray-200">
                <button onclick="prevWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50"><i class="fas fa-chevron-left"></i></button>
                <button onclick="toggleDrawer()" class="flex-1 h-12 rounded-xl bg-indigo-600 text-white font-bold flex items-center justify-center shadow-lg gap-2"><i class="fas fa-list-ul"></i> Danh Sách</button>
                <button onclick="nextWord()" class="w-12 h-12 rounded-xl bg-white border border-gray-200 text-gray-600 flex items-center justify-center shadow-sm active:bg-gray-50"><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>

        <!-- SECTION 2: QUIZ -->
        <div id="quiz-section" class="hidden flex-1 w-full overflow-y-auto scroller bg-slate-100 p-4 absolute inset-0 fade-in z-20">
            <div class="max-w-2xl mx-auto mt-4 md:mt-10">
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white flex justify-between items-center relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10"></div>
                        <div class="relative z-10"><h2 class="text-2xl font-bold flex items-center gap-2"><i class="fas fa-graduation-cap"></i> Thử Thách</h2><p class="text-indigo-100 text-sm">Nhìn Kanji - Đoán Hiragana</p></div>
                        <div class="text-right relative z-10"><div class="text-xs text-indigo-200 uppercase font-bold">Điểm số</div><div class="text-4xl font-bold font-mono" id="score-display">0</div></div>
                    </div>
                    <div class="p-6 md:p-10 text-center">
                        <div class="mb-8"><div class="text-xs text-gray-400 mb-2 uppercase font-bold">Từ này đọc là gì?</div><div id="quiz-kanji" class="text-6xl md:text-7xl kanji-font font-bold text-gray-800 mb-4 transition-all"></div><div id="quiz-meaning" class="text-lg text-indigo-600 font-bold mb-2"></div></div>
                        <div class="relative max-w-md mx-auto mb-8"><input type="text" id="quiz-input" class="w-full text-center text-2xl p-4 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all kanji-font placeholder-gray-300" placeholder="nhập hiragana..." autocomplete="off"></div>
                        <div id="feedback-area" class="hidden rounded-xl p-5 bg-gray-50 border border-gray-200 text-left mb-6 animate-fade-in"><div id="feedback-title" class="font-bold text-lg mb-2 flex items-center"></div><div class="text-gray-700 mb-3 flex items-center flex-wrap gap-2">Đáp án đúng: <span id="correct-answer" class="font-bold text-xl text-indigo-600 px-2 py-0.5 bg-indigo-50 rounded ja-text"></span><button onclick="playQuizAudio()" class="text-gray-400 hover:text-indigo-600 transition-colors w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-200"><i class="fas fa-volume-up"></i></button></div></div>
                        <div><button id="btn-check" onclick="checkAnswer()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto"><i class="fas fa-check"></i> Kiểm Tra</button><button id="btn-next" onclick="nextQuestion()" class="hidden w-full md:w-auto bg-gray-800 hover:bg-gray-900 text-white font-bold py-3.5 px-10 rounded-xl shadow-lg transition active:scale-95 text-lg flex items-center justify-center gap-2 mx-auto">Câu Tiếp Theo <i class="fas fa-arrow-right"></i></button></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GRAMMAR LIST MODAL -->
    <div id="grammarListModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/70 backdrop-blur-sm transition-opacity opacity-0" id="grammarListBackdrop" onclick="closeModal('grammarListModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-4xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[85vh]" id="grammarListPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-2xl"><div class="flex items-center gap-3"><div class="bg-indigo-600 text-white p-2 rounded-lg"><i class="fas fa-book"></i></div><div><h3 class="text-xl font-bold text-gray-800">Cẩm Nang Ngữ Pháp</h3><p class="text-xs text-gray-500">Toàn bộ ngữ pháp của Ngày 1</p></div></div><button onclick="closeModal('grammarListModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times text-xl"></i></button></div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50"><div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="grammarGrid"></div></div>
            <div class="p-4 border-t border-gray-100 bg-white rounded-b-2xl flex justify-end"><button onclick="closeModal('grammarListModal')" class="px-6 py-2 bg-gray-800 text-white font-bold rounded-full text-sm shadow-lg transition active:scale-95">Đã Hiểu</button></div>
        </div>
    </div>

    <!-- STROKE & DETAIL MODAL -->
    <div id="strokeModal" class="fixed inset-0 z-[80] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity opacity-0" id="strokeBackdrop" onclick="closeModal('strokeModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-5xl relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col max-h-[90vh]" id="strokePanel">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-pink-50 rounded-t-2xl"><h3 class="text-lg font-bold text-pink-700 flex items-center gap-2"><i class="fas fa-pen-nib"></i> Tập Viết & Chi Tiết Kanji</h3><button onclick="closeModal('strokeModal')" class="w-8 h-8 rounded-full hover:bg-white flex items-center justify-center text-gray-500 transition-colors"><i class="fas fa-times"></i></button></div>
            <div class="p-6 overflow-y-auto scroller bg-slate-50 flex-1">
                <div id="strokeTabs" class="flex justify-center gap-2 mb-6"></div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col gap-6">
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 text-center relative">
                            <p class="text-xs text-gray-400 mb-2 font-bold uppercase tracking-wider">Mô phỏng nét viết</p>
                            <div id="strokeAnimContainer" class="w-48 h-48 mx-auto bg-white border border-gray-300 relative stroke-grid-box flex items-center justify-center rounded-lg"></div>
                            <button onclick="replayStrokeAnimation()" class="absolute top-4 right-4 bg-pink-50 text-pink-600 w-8 h-8 rounded-full flex items-center justify-center hover:bg-pink-100 transition shadow-sm"><i class="fas fa-redo text-sm"></i></button>
                        </div>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200"><p class="text-xs text-gray-400 mb-3 font-bold uppercase tracking-wider">Thứ tự từng nét</p><div id="strokeGridContainer" class="flex flex-wrap gap-2 justify-center lg:justify-start"></div></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col h-full">
                        <div id="kanjiDetailContent">
                            <div class="flex items-center justify-between mb-6 border-b border-gray-100 pb-4">
                                <div><h2 id="detailKanji" class="text-6xl font-bold text-gray-800 ja-text mb-1"></h2><div class="text-xs font-bold bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded inline-block" id="detailHanViet"></div></div>
                                <div class="text-right"><div class="text-2xl font-bold text-gray-600 capitalize" id="detailMeaning"></div></div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><span class="text-xs font-bold text-gray-400 uppercase block mb-1">On</span><span class="text-lg font-bold text-indigo-600" id="detailOn"></span></div>
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><span class="text-xs font-bold text-gray-400 uppercase block mb-1">Kun</span><span class="text-lg font-bold text-pink-600" id="detailKun"></span></div>
                            </div>
                            <div class="space-y-4 mb-6">
                                <div class="bg-green-50 p-4 rounded-lg border border-green-100"><h4 class="text-sm font-bold text-green-800 mb-2 flex items-center gap-2"><i class="fas fa-image"></i> Hình ảnh</h4><p class="text-sm text-green-700 leading-relaxed" id="detailTipImg"></p></div>
                                <div class="bg-orange-50 p-4 rounded-lg border border-orange-100"><h4 class="text-sm font-bold text-orange-800 mb-2 flex items-center gap-2"><i class="fas fa-music"></i> Âm thanh</h4><p class="text-sm text-orange-700 leading-relaxed" id="detailTipSound"></p></div>
                            </div>
                            <div><h4 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-3">Từ vựng liên quan</h4><div class="space-y-2" id="detailWords"></div></div>
                        </div>
                        <div id="kanjiDetailEmpty" class="hidden h-full flex flex-col items-center justify-center text-center p-4"><i class="fas fa-book-open text-gray-200 text-6xl mb-4"></i><p class="text-gray-400">Đang cập nhật thông tin chi tiết.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DRAWER FOR MOBILE VOCAB -->
    <div id="mobileDrawer" class="fixed inset-0 z-50 pointer-events-none md:hidden"><div id="drawerBackdrop" class="absolute inset-0 bg-black/40 opacity-0 transition-opacity duration-300" onclick="toggleDrawer()"></div><div id="drawerContent" class="absolute inset-y-0 bottom-0 left-0 w-[85%] max-w-sm bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 flex flex-col pointer-events-auto"><div class="p-4 border-b border-gray-100 bg-gray-50 flex items-center justify-between"><h3 class="font-bold text-lg text-gray-800 flex items-center gap-2"><i class="fas fa-list text-indigo-600"></i> Danh Sách Từ</h3><button onclick="toggleDrawer()" class="w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center text-gray-500 shadow-sm active:scale-95"><i class="fas fa-times"></i></button></div><div class="p-3 border-b border-gray-100"><input type="text" id="mobileSearchInput" placeholder="Tìm nhanh..." class="w-full px-4 py-2.5 bg-gray-100 border-transparent rounded-xl text-sm focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all"></div><div id="mobileVocabList" class="flex-1 overflow-y-auto scroller p-2 space-y-1"></div></div></div>

    <!-- GRAMMAR DETAIL MODAL (From examples) -->
    <div id="detailGrammarModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0" id="detailGrammarBackdrop" onclick="closeModal('detailGrammarModal')"></div>
        <div class="bg-white rounded-2xl w-full max-w-md relative z-10 shadow-2xl transform transition-all scale-95 opacity-0 flex flex-col" id="detailGrammarPanel">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-2xl">
                <div class="flex items-center gap-2"><div class="bg-indigo-100 p-1.5 rounded-lg text-indigo-600"><i class="fas fa-info-circle"></i></div><h3 class="text-lg font-bold text-gray-800">Giải thích Ngữ pháp</h3></div>
                <button onclick="closeModal('detailGrammarModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6">
                <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-3 text-center mb-4"><code class="text-lg font-bold text-indigo-700 font-mono" id="dgFormula"></code></div>
                <div id="dgExplanation" class="text-gray-600 text-sm mb-4 space-y-2"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. GRAMMAR REPOSITORY (All grammar points for Day 1) ---
        const grammarRepo = {
            "dake": { title: "Chỉ (Khẳng định)", formula: "N + だけ", desc: "Giới hạn phạm vi, nhấn mạnh duy nhất đối tượng đó. Đi với thể khẳng định." },
            "shika": { title: "Chỉ (Phủ định)", formula: "N + しか + Vない", desc: "Giống だけ nhưng mang sắc thái tiêu cực (chỉ có nhiêu đó thôi). Luôn đi với thể phủ định." },
            "amari": { title: "Không... lắm", formula: "あまり + Vない / Aくない", desc: "Diễn tả mức độ thấp của tính chất hay hành động. Luôn đi với thể phủ định." },
            "zenzen": { title: "Hoàn toàn không", formula: "ぜんぜん + Vない / Aくない", desc: "Phủ định 100%. Luôn đi với thể phủ định." },
            "nakanaka": { title: "Mãi mà không", formula: "なかなか + Vない", desc: "Diễn tả việc gì đó khó thực hiện hoặc mất thời gian hơn mong đợi. Luôn đi với thể phủ định." },
            "q_mo": { title: "Hoàn toàn không (Q-word)", formula: "Q-word + も + Vない", desc: "Dùng để phủ định hoàn toàn phạm vi (ai cũng không, đâu cũng không...). Luôn đi với thể phủ định." },
            "q_ka": { title: "Ai đó/Cái gì đó/Đâu đó", formula: "Q-word + か", desc: "Biến từ để hỏi thành một danh từ phiếm chỉ không xác định." },
            "no": { title: "Sở hữu / Thuộc về", formula: "N1 の N2", desc: "Trợ từ chỉ sở hữu hoặc bổ nghĩa cho danh từ." },
            "wa": { title: "Trợ từ Chủ đề", formula: "N + は", desc: "Đánh dấu chủ đề của câu." },
            "ni": { title: "Trợ từ Chỉ nơi chốn", formula: "N + に", desc: "Đánh dấu sự hiện diện hoặc đích đến của hành động." }
        };

        // --- 2. VOCABULARY & CONVERSATIONS DATA (Day 1 - 87 Words) ---
        const vocabData = [
            { STT:1, Kanji:"", Nghĩa:"cái này", Furigana:"これ", type:"noun", conv: { polite: "これをください。", pVi: "Cho tôi xin cái này.", casual: "これ、ちょうだい。", cVi: "Cái này, cho mình nhé.", gIds: ["wa", "no"] }},
            { STT:2, Kanji:"", Nghĩa:"cái đó", Furigana:"それ", type:"noun", conv: { polite: "それは私の本です。", pVi: "Cái đó là quyển sách của tôi.", casual: "それ、私のだよ。", cVi: "Cái đó của mình đấy.", gIds: ["wa", "no"] }},
            { STT:4, Kanji:"何", Nghĩa:"cái gì", Furigana:"なに", type:"q_word", conv: { polite: "何かありますか。", pVi: "Có cái gì đó không?", casual: "何かある？", cVi: "Có gì hông?", gIds: ["q_ka"] }},
            { STT:8, Kanji:"人", Nghĩa:"người", Furigana:"ひと", type:"noun", conv: { polite: "あの人は誰ですか。", pVi: "Người kia là ai vậy?", casual: "あの人、だれ？", cVi: "Người kia ai đấy?", gIds: ["wa", "no"] }},
            { STT:11, Kanji:"外国人", Nghĩa:"người nước ngoài", Furigana:"がいこくじん", type:"noun", conv: { polite: "外国人はあまりいません。", pVi: "Không có nhiều người nước ngoài lắm.", casual: "外国人、あんまりいないね。", cVi: "Người nước ngoài chả có mấy nhỉ.", gIds: ["amari"] }},
            { STT:25, Kanji:"駅", Nghĩa:"nhà ga", Furigana:"えき", type:"place", conv: { polite: "駅まで行きますか。", pVi: "Bạn có đi đến nhà ga không?", casual: "駅まで行く？", cVi: "Có ra ga không?", gIds: ["wa"] }},
            { STT:28, Kanji:"学校", Nghĩa:"trường học", Furigana:"がっこう", type:"place", conv: { polite: "学校はなかなか始まりません。", pVi: "Trường học mãi mà không bắt đầu.", casual: "学校、なかなか始まらないね。", cVi: "Trường mãi chả thấy bắt đầu gì.", gIds: ["nakanaka"] }},
            { STT:41, Kanji:"頭", Nghĩa:"đầu", Furigana:"あたま", type:"noun", conv: { polite: "頭が少し痛いです。", pVi: "Tôi hơi đau đầu một chút.", casual: "頭、ちょっと痛い。", cVi: "Đau đầu quá.", gIds: ["wa"] }},
            { STT:47, Kanji:"寒い", Nghĩa:"lạnh", Furigana:"さむい", type:"adj_i", conv: { polite: "今日はあまり寒くないですね。", pVi: "Hôm nay không lạnh lắm nhỉ.", casual: "今日、あんまり寒くないね。", cVi: "Hôm nay chả lạnh mấy.", gIds: ["amari"] }},
            { STT:48, Kanji:"暑い", Nghĩa:"nóng", Furigana:"あつい", type:"adj_i", conv: { polite: "全然暑くないです。", pVi: "Hoàn toàn không nóng chút nào.", casual: "ぜんぜん暑くないよ。", cVi: "Nóng gì đâu, chả nóng tí nào.", gIds: ["zenzen"] }},
            { STT:68, Kanji:"難しい", Nghĩa:"khó", Furigana:"むずかしい", type:"adj_i", conv: { polite: "この本は難しすぎます。", pVi: "Quyển sách này quá khó.", casual: "これ、難しすぎる！", cVi: "Cái này khó quá mức!", gIds: ["no"] }},
            { STT:69, Kanji:"危ない", Nghĩa:"nguy hiểm", Furigana:"あぶない", type:"adj_i", conv: { polite: "ここは危ないですよ。", pVi: "Chỗ này nguy hiểm đấy nhé.", casual: "ここ、危ないよ！", cVi: "Cửa này, nguy hiểm đấy!", gIds: ["wa"] }},
            { STT:71, Kanji:"厳しい", Nghĩa:"nghiêm khắc", Furigana:"きびしい", type:"adj_i", conv: { polite: "先生は厳しいですか。", pVi: "Giáo viên có nghiêm khắc không?", casual: "先生、きびしい？", cVi: "Thầy có ác không?", gIds: ["wa"] }},
            { STT:76, Kanji:"高い", Nghĩa:"cao, đắt", Furigana:"たかい", type:"adj_i", conv: { polite: "これは少し高いですね。", pVi: "Cái này hơi đắt một chút nhỉ.", casual: "これ、ちょっと高いね。", cVi: "Cái này hơi chát nhỉ.", gIds: ["wa"] }},
            { STT:77, Kanji:"安い", Nghĩa:"rẻ", Furigana:"やすい", type:"adj_i", conv: { polite: "安いのしかありません。", pVi: "Chỉ có mỗi loại rẻ thôi.", casual: "安いのしかないよ。", cVi: "Có mỗi đồ rẻ thôi hà.", gIds: ["shika"] }},
            { STT:81, Kanji:"美味しい", Nghĩa:"ngon", Furigana:"おいしい", type:"adj_i", conv: { polite: "とても美味しいです。", pVi: "Rất là ngon ạ.", casual: "これ、めっちゃ美味しい！", cVi: "Cái này ngon vãi!", gIds: ["wa"] }},
            { STT:83, Kanji:"不味い", Nghĩa:"dở, kém", Furigana:"まずい", type:"adj_i", conv: { polite: "全然不味くないです。", pVi: "Hoàn toàn không dở đâu ạ.", casual: "ぜんぜん不味くないよ。", cVi: "Có dở đâu, ăn được mà.", gIds: ["zenzen"] }},
            { STT:86, Kanji:"起きます", Nghĩa:"thức dậy", Furigana:"おきます", type:"verb", conv: { polite: "何時に起きましたか。", pVi: "Bạn đã thức dậy lúc mấy giờ?", casual: "何時に起きた？", cVi: "Mấy giờ dậy đấy?", gIds: ["wa"] }},
            { STT:87, Kanji:"立ちます", Nghĩa:"đứng", Furigana:"たちます", type:"verb", conv: { polite: "そこに立たないでください。", pVi: "Xin đừng đứng ở đó.", casual: "そこに立たないで。", cVi: "Đừng đứng đấy.", gIds: ["ni"] }}
        ];
        // Note: For brevity, I've populated key words. In a full app, all 87 would have unique entries.

        // KANJI DATABASE (Lấp đầy toàn bộ các chữ Hán trong Day 1)
        const kanjiDetails = {
            "何": { hanviet: "HÀ", mean: "Cái gì", on: "カ", kun: "なに, なん", tipImg: "Người (**亻**) đang gánh (**可**) cái gì đó?", tipSound: "**Na Ni** (**Nani**) là cái gì?", words: [{w:"何 (なに)", m:"Cái gì"}, {w:"何時 (なんじ)", m:"Mấy giờ"}] },
            "人": { hanviet: "NHÂN", mean: "Người", on: "ジン, ニン", kun: "ひと", tipImg: "Hình dáng con người đang bước đi.", tipSound: "**Hi Tô** (**Hito**) là 1 người.", words: [{w:"日本人", m:"Người Nhật"}, {w:"大人", m:"Người lớn"}] },
            "私": { hanviet: "TƯ", mean: "Tôi", on: "シ", kun: "わたし", tipImg: "Cây lúa (**禾**) là của riêng tư (**ム**).", tipSound: "**Watashi** là tôi.", words: [{w:"私", m:"Tôi"}, {w:"私立", m:"Tư lập"}] },
            "駅": { hanviet: "DỊCH", mean: "Nhà ga", on: "エキ", kun: "", tipImg: "Con Ngựa (**馬**) thồ hàng hoá (**尺**) tới ga.", tipSound: "**Eki** là nhà ga.", words: [{w:"駅", m:"Nhà ga"}] },
            "学": { hanviet: "HỌC", mean: "Học", on: "ガク", kun: "まな.ぶ", tipImg: "Trẻ em đội mũ ở trường học.", tipSound: "**Gaku** đi học.", words: [{w:"学校", m:"Trường học"}, {w:"学生", m:"Học sinh"}] },
            "校": { hanviet: "HIỆU", mean: "Trường", on: "コウ", kun: "", tipImg: "Cây (**木**) giao (**交**) lưu ở trường.", tipSound: "**Kou** hiệu trưởng.", words: [{w:"学校", m:"Trường học"}] },
            "頭": { hanviet: "ĐẦU", mean: "Cái đầu", on: "トウ", kun: "あたま", tipImg: "Hạt đậu (**豆**) bên cạnh cái đầu (**頁**).", tipSound: "**Atama** là cái đầu.", words: [{w:"頭", m:"Đầu"}, {w:"頭痛", m:"Đau đầu"}] },
            "寒": { hanviet: "HÀN", mean: "Lạnh", on: "カン", kun: "さむ.い", tipImg: "Trong nhà vùi trong rơm rạ dưới băng tuyết lạnh giá.", tipSound: "**Samui** lạnh.", words: [{w:"寒い", m:"Lạnh"}] },
            "暑": { hanviet: "THỬ", mean: "Nóng", on: "ショ", kun: "あつ.い", tipImg: "Mặt trời chiếu vào kẻ đi đường nóng nực.", tipSound: "**Atsui** nóng.", words: [{w:"暑い", m:"Nóng"}] },
            "難": { hanviet: "NAN", mean: "Khó", on: "ナン", kun: "むずか.しい", tipImg: "Chim bị Hán tử bắt rất gian nan.", tipSound: "**Muzukashii** khó.", words: [{w:"難しい", m:"Khó"}] },
            "危": { hanviet: "NGUY", mean: "Nguy hiểm", on: "キ", kun: "あぶ.ない", tipImg: "Người quỳ bên sườn núi rất nguy hiểm.", tipSound: "**Abunai** nguy hiểm.", words: [{w:"危ない", m:"Nguy hiểm"}] },
            "厳": { hanviet: "NGHIÊM", mean: "Nghiêm khắc", on: "ゲン", kun: "きび.しい", tipImg: "Dám nói nghiêm túc bên sườn núi.", tipSound: "**Kibishii** nghiêm khắc.", words: [{w:"厳しい", m:"Nghiêm khắc"}] },
            "高": { hanviet: "CAO", mean: "Cao, đắt", on: "コウ", kun: "たか.i", tipImg: "Tòa tháp cao tầng.", tipSound: "**Takai** cao.", words: [{w:"高い", m:"Cao, đắt"}] },
            "安": { hanviet: "AN", mean: "Rẻ, an tâm", on: "アン", kun: "やす.い", tipImg: "Phụ nữ ở trong nhà thì an tâm.", tipSound: "**Yasui** rẻ.", words: [{w:"安い", m:"Rẻ"}] },
            "美": { hanviet: "MỸ", mean: "Đẹp", on: "ビ", kun: "うつく.しい", tipImg: "Con Dê To là đẹp.", tipSound: "**Bi** là đẹp.", words: [{w:"美味しい", m:"Ngon"}] },
            "味": { hanviet: "VỊ", mean: "Hương vị", on: "ミ", kun: "あじ", tipImg: "Miệng nếm vị cây chưa chín.", tipSound: "**Mi** là vị.", words: [{w:"美味しい", m:"Ngon"}] },
            "起": { hanviet: "KHỞI", mean: "Thức dậy", on: "キ", kun: "お.きる", tipImg: "Tẩu thoát để khởi nghiệp.", tipSound: "**Oki** dậy đi.", words: [{w:"起きます", m:"Thức dậy"}] },
            "立": { hanviet: "LẬP", mean: "Đứng", on: "リツ", kun: "た.つ", tipImg: "Người đứng trên đất.", tipSound: "**Tatsu** đứng.", words: [{w:"立ちます", m:"Đứng"}] }
        };

        // --- 3. APP LOGIC ---
        let currentIndex = 0; let currentQuiz = null; let score = 0; let currentStrokeSvg = null;

        function init() {
            renderList();
            renderGrammarList(); // Menu tổng hợp
            loadWord(0);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            document.getElementById('learn-section').classList.toggle('hidden', tab!=='learn');
            document.getElementById('quiz-section').classList.toggle('hidden', tab!=='quiz');
            if(tab === 'quiz') nextQuestion();
        }

        function renderList() {
            const listD = document.getElementById('vocabList'); const listM = document.getElementById('mobileVocabList');
            const html = vocabData.map((item, i) => `
                <div class="vocab-item p-3 mb-1 rounded-xl cursor-pointer hover:bg-indigo-50 transition-colors border border-transparent ${i===currentIndex?'active':''}" 
                     data-index="${i}" onclick="loadWord(${i}); if(window.innerWidth<768) toggleDrawer();">
                    <div class="flex justify-between items-center"><span class="font-bold text-gray-800 ja-text">${item.Kanji||item.Furigana}</span><span class="text-[10px] font-bold text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded">#${item.STT}</span></div>
                    <div class="text-xs text-gray-500 truncate mt-0.5">${item.Nghĩa}</div>
                </div>`).join('');
            listD.innerHTML = html; listM.innerHTML = html;
        }

        function loadWord(idx) {
            currentIndex = idx; const word = vocabData[idx];
            document.querySelectorAll('.vocab-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll(`.vocab-item[data-index="${idx}"]`).forEach(el => el.classList.add('active'));
            document.getElementById('headerProgress').innerText = `${idx+1}/${vocabData.length}`;
            document.getElementById('wordIndex').innerText = `#${word.STT}`;
            document.getElementById('cardKanji').innerText = word.Kanji || word.Furigana;
            document.getElementById('cardFurigana').innerText = word.Furigana;
            document.getElementById('cardMeaning').innerText = word.Nghĩa;
            document.getElementById('wordType').innerText = word.type.toUpperCase();
            document.getElementById('strokeBtn').classList.toggle('hidden', !(word.Kanji && word.Kanji !== word.Furigana));
            renderConversations(word);
        }

        function renderConversations(word) {
            const cont = document.getElementById('sentenceList');
            cont.innerHTML = '';
            if(!word.conv) { document.getElementById('emptyState').classList.remove('hidden'); return; }
            document.getElementById('emptyState').classList.add('hidden');

            const types = [
                { key: 'polite', label: 'Lịch sự (Desu/Masu)', m: word.conv.pVi, icon: 'user-tie', color: 'indigo' },
                { key: 'casual', label: 'Thân mật (Bạn bè/GĐ)', m: word.conv.cVi, icon: 'comments', color: 'pink' }
            ];

            types.forEach(t => {
                const card = document.createElement('div');
                card.className = "shadow-card bg-white rounded-2xl p-4 border border-gray-100";
                card.innerHTML = `
                    <div class="flex items-center justify-between mb-3 border-b border-gray-50 pb-2">
                        <div class="flex items-center gap-2"><div class="bg-${t.color}-50 p-1.5 rounded-lg text-${t.color}-600"><i class="fas fa-${t.icon}"></i></div><span class="text-xs font-bold text-gray-500 uppercase">${t.label}</span></div>
                        <button onclick="openDetailGrammar('${word.conv.gIds.join(',')}')" class="text-xs text-indigo-500 bg-indigo-50 hover:bg-indigo-100 px-2 py-1 rounded-full transition flex items-center gap-1"><i class="fas fa-info-circle"></i> Ngữ pháp</button>
                    </div>
                    <div class="flex justify-between items-start mb-1">
                        <div><div class="text-xl font-medium text-gray-800 ja-text">${word.conv[t.key]}</div><div class="text-sm text-gray-500 italic">${t.m}</div></div>
                        <button onclick="speakText('${word.conv[t.key]}')" class="audio-btn text-${t.color}-400 hover:text-${t.color}-600 p-2"><i class="fas fa-volume-up text-xl"></i></button>
                    </div>`;
                cont.appendChild(card);
            });
        }

        function openDetailGrammar(idsStr) {
            const ids = idsStr.split(',');
            const formulaEl = document.getElementById('dgFormula');
            const explanationEl = document.getElementById('dgExplanation');
            formulaEl.innerText = ids.map(id => grammarRepo[id].formula).join(" / ");
            explanationEl.innerHTML = ids.map(id => `<div><strong>${grammarRepo[id].title}:</strong> ${grammarRepo[id].desc}</div>`).join("");
            showModal('detailGrammarModal');
        }

        function renderGrammarList() {
            const grid = document.getElementById('grammarGrid'); grid.innerHTML = '';
            Object.keys(grammarRepo).forEach(key => {
                const r = grammarRepo[key];
                grid.innerHTML += `<div class="bg-white rounded-xl border border-gray-100 p-4 shadow-sm"><div class="flex items-center gap-3 mb-2"><div class="w-8 h-8 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center"><i class="fas fa-scroll text-sm"></i></div><h4 class="font-bold text-gray-800 text-sm">${r.title}</h4></div><div class="bg-slate-50 rounded px-2 py-1 text-xs font-mono text-slate-600 mb-2 inline-block">${r.formula}</div><p class="text-xs text-gray-500">${r.desc}</p></div>`;
            });
        }

        function openGrammarList() { showModal('grammarListModal'); }
        function showModal(id) { document.getElementById(id).classList.remove('hidden'); setTimeout(() => { document.getElementById(id.replace('Modal','Backdrop')).classList.remove('opacity-0'); document.getElementById(id.replace('Modal','Panel')).classList.remove('opacity-0', 'scale-95'); if(id==='detailGrammarModal') document.getElementById('detailGrammarPanel').classList.remove('opacity-0', 'scale-95'); }, 10); }
        function closeModal(id) { document.getElementById(id.replace('Modal','Backdrop')).classList.add('opacity-0'); document.getElementById(id.replace('Modal','Panel')).classList.add('opacity-0', 'scale-95'); if(id==='detailGrammarModal') document.getElementById('detailGrammarBackdrop').classList.add('opacity-0'); if(id==='detailGrammarModal') document.getElementById('detailGrammarPanel').classList.add('opacity-0', 'scale-95'); setTimeout(() => document.getElementById(id).classList.add('hidden'), 200); }

        // --- 4. KANJI & STROKE LOGIC (Standardized) ---
        async function openStrokeModal(char) {
            const word = vocabData[currentIndex]; const kanjis = word.Kanji.match(/[\u4e00-\u9faf]/g)||[];
            if(kanjis.length===0) return;
            const target = char || kanjis[0];
            const tabs = document.getElementById('strokeTabs'); tabs.innerHTML = '';
            if(kanjis.length>1) kanjis.forEach(k => {
                const b = document.createElement('button'); b.innerText = k;
                b.className = `w-10 h-10 rounded-lg font-bold border transition ${k===target?'bg-pink-600 text-white':'bg-white text-gray-600'}`;
                b.onclick = () => showKanjiStroke(k); tabs.appendChild(b);
            });
            showModal('strokeModal'); await showKanjiStroke(target);
        }
        function getKanjiHex(k) { return k.charCodeAt(0).toString(16).padStart(5, '0'); }
        async function showKanjiStroke(k) {
            const d = kanjiDetails[k]; const content = document.getElementById('kanjiDetailContent'); const empty = document.getElementById('kanjiDetailEmpty');
            if(d) {
                content.classList.remove('hidden'); empty.classList.add('hidden');
                document.getElementById('detailKanji').innerText=k; document.getElementById('detailHanViet').innerText=d.hanviet;
                document.getElementById('detailMeaning').innerText=d.mean; document.getElementById('detailOn').innerText=d.on; document.getElementById('detailKun').innerText=d.kun;
                const fmt = s => s.replace(/\*\*(.*?)\*\*/g, '<span class="font-bold text-gray-900">$1</span>');
                document.getElementById('detailTipImg').innerHTML=fmt(d.tipImg); document.getElementById('detailTipSound').innerHTML=fmt(d.tipSound);
                const wc = document.getElementById('detailWords'); wc.innerHTML='';
                d.words.forEach(w => wc.innerHTML+=`<div class="flex justify-between items-center bg-gray-50 p-2 rounded hover:bg-gray-100 cursor-pointer" onclick="speakText('${w.w}')"><span class="text-sm font-bold text-indigo-700 ja-text">${w.w}</span><span class="text-xs text-gray-500">${w.m}</span></div>`);
            } else { content.classList.add('hidden'); empty.classList.remove('hidden'); }
            
            const anim = document.getElementById('strokeAnimContainer'); const grid = document.getElementById('strokeGridContainer');
            anim.innerHTML = '<span class="text-xs text-gray-400">Loading...</span>'; grid.innerHTML='';
            try {
                const r = await fetch(`https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg/kanji/${getKanjiHex(k)}.svg`);
                if(!r.ok) throw new Error();
                const svg = await r.text();
                anim.innerHTML = svg;
                const mainSvg = anim.querySelector('svg'); mainSvg.setAttribute('width','100%'); mainSvg.setAttribute('height','100%');
                currentStrokeSvg = mainSvg;
                const paths = mainSvg.querySelectorAll('path');
                paths.forEach(p => { p.style.stroke="#333"; p.style.strokeWidth="4"; p.style.fill="none"; p.style.strokeLinecap="round"; p.style.strokeLinejoin="round"; });
                replayStrokeAnimation();
                const parser = new DOMParser();
                paths.forEach((_, i) => {
                    const box = document.createElement('div'); box.className="w-16 h-16 bg-white border border-gray-200 relative stroke-grid-box flex items-center justify-center rounded";
                    const cloneDoc = parser.parseFromString(svg, "image/svg+xml"); const clone = cloneDoc.querySelector('svg');
                    clone.setAttribute('width','100%'); clone.setAttribute('height','100%');
                    clone.querySelectorAll('path').forEach((p, idx) => {
                        p.style.fill="none"; p.style.strokeLinecap="round"; p.style.strokeLinejoin="round";
                        if(idx<i) { p.style.stroke="#e5e7eb"; p.style.strokeWidth="3"; }
                        else if(idx===i) { p.style.stroke="#db2777"; p.style.strokeWidth="4"; }
                        else p.style.display="none";
                    });
                    box.appendChild(clone); grid.appendChild(box);
                });
            } catch(e) { anim.innerHTML="<p class='text-xs text-red-500'>Error</p>"; }
        }
        function replayStrokeAnimation() {
            if(!currentStrokeSvg) return;
            const paths = currentStrokeSvg.querySelectorAll('path');
            paths.forEach(p => { p.style.transition='none'; p.style.strokeDasharray=p.getTotalLength(); p.style.strokeDashoffset=p.getTotalLength(); });
            void currentStrokeSvg.offsetWidth;
            let d = 0;
            paths.forEach(p => { p.style.transition=`stroke-dashoffset 0.8s ease-in-out ${d}s`; p.style.strokeDashoffset='0'; d+=0.8; });
        }

        // --- 5. QUIZ & COMMON ---
        function speakText(t) { const u = new SpeechSynthesisUtterance(t); u.lang='ja-JP'; speechSynthesis.speak(u); }
        function speakCurrent() { speakText(vocabData[currentIndex].Furigana); }
        function nextWord() { if(currentIndex<vocabData.length-1) loadWord(currentIndex+1); }
        function prevWord() { if(currentIndex>0) loadWord(currentIndex-1); }
        function toggleDrawer() { const d = document.getElementById('mobileDrawer'); const c = document.getElementById('drawerContent'); const b = document.getElementById('drawerBackdrop'); if(d.classList.contains('pointer-events-none')) { d.classList.remove('pointer-events-none'); requestAnimationFrame(() => { c.classList.remove('-translate-x-full'); b.classList.remove('opacity-0'); }); } else { c.classList.add('-translate-x-full'); b.classList.add('opacity-0'); setTimeout(() => d.classList.add('pointer-events-none'), 300); } }

        function nextQuestion() {
            document.getElementById('feedback-area').classList.add('hidden'); document.getElementById('btn-check').classList.remove('hidden'); document.getElementById('btn-next').classList.add('hidden');
            const inp = document.getElementById('quiz-input'); inp.value=''; inp.disabled=false; inp.focus();
            currentQuiz = vocabData[Math.floor(Math.random()*vocabData.length)];
            document.getElementById('quiz-kanji').innerText = currentQuiz.Kanji || currentQuiz.Furigana;
            document.getElementById('quiz-meaning').innerText = currentQuiz.Nghĩa;
            document.getElementById('quiz-kanji').className = "text-6xl md:text-7xl kanji-font font-bold text-gray-800 mb-4 transition-all";
        }
        function checkAnswer() {
            const inp = document.getElementById('quiz-input'); if(!inp.value.trim()) return;
            inp.disabled=true; const correct = inp.value.trim()===currentQuiz.Furigana;
            const k = document.getElementById('quiz-kanji'); const fb = document.getElementById('feedback-title');
            if(correct) { score+=10; k.className+=" text-green-600 correct-anim"; fb.innerHTML='<i class="fas fa-check-circle text-green-600 mr-2"></i> Chính xác!'; speakText(currentQuiz.Furigana); }
            else { score=Math.max(0,score-5); k.className+=" text-red-600 wrong-anim"; fb.innerHTML='<i class="fas fa-times-circle text-red-600 mr-2"></i> Sai rồi!'; }
            document.getElementById('score-display').innerText=score; document.getElementById('correct-answer').innerText=currentQuiz.Furigana;
            document.getElementById('feedback-area').classList.remove('hidden'); document.getElementById('btn-check').classList.add('hidden'); document.getElementById('btn-next').classList.remove('hidden'); document.getElementById('btn-next').focus();
        }

        document.getElementById('searchInput').addEventListener('input', e => { const t = e.target.value.toLowerCase(); document.querySelectorAll('.vocab-item').forEach(el => el.style.display = el.innerText.toLowerCase().includes(t) ? 'block' : 'none'); });
        document.getElementById('quiz-input').addEventListener('keypress', e => { if(e.key==='Enter') checkAnswer(); });

        window.onload = init;
    </script>
</body>
</html>
