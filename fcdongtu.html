<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AzaKanji Master Verbs - Chinh Phá»¥c 95 Äá»™ng Tá»«</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; background-color: #f8fafc; overflow-x: hidden; }
        .kanji-font { font-family: 'Noto Sans JP', sans-serif; }
        
        /* Flip Card Animation */
        .perspective { perspective: 1000px; }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        .is-flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1.25rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .card-front { background: white; border: 2px solid #e2e8f0; }
        .card-back { background: #f0fdf4; border: 2px solid #bbf7d0; transform: rotateY(180deg); }

        /* Stroke Grid */
        .stroke-grid-box { border: 1px solid #e5e7eb; background-color: white; position: relative; }
        .stroke-grid-box::after { content: ''; position: absolute; top: 0; left: 50%; width: 1px; height: 100%; background: repeating-linear-gradient(to bottom, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); }
        .stroke-grid-box::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px; background: repeating-linear-gradient(to right, #ddd 0, #ddd 4px, transparent 4px, transparent 8px); }

        /* Level Tags */
        .tag-n5 { background-color: #22c55e; color: white; }
        .tag-n4 { background-color: #3b82f6; color: white; }
        .tag-n3 { background-color: #f59e0b; color: white; }

        .modal-enter { animation: modalIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes modalIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        
        .active-tab { border-bottom: 3px solid #059669; color: #059669; font-weight: 700; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Top Navigation -->
    <header class="bg-emerald-700 text-white shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3 cursor-pointer" onclick="location.reload()">
                <i class="fas fa-dharmachakra text-2xl text-yellow-400"></i>
                <div>
                    <h1 class="text-lg font-bold uppercase tracking-tighter">AzaKanji Master</h1>
                    <p class="text-[10px] text-emerald-100 opacity-80">Äá»“ng Nháº¥t Thá»ƒ TrÃ­ - 95 Äá»™ng Tá»«</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="showPoem()" class="text-xs bg-emerald-600 px-3 py-1.5 rounded-full border border-emerald-500 hover:bg-emerald-500 transition">
                    <i class="fas fa-scroll mr-1"></i> Tháº§n ChÃº
                </button>
                <div class="text-xs bg-emerald-800 px-3 py-1.5 rounded-full font-mono">
                    <span id="completed-count">0</span>/95
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6 flex-grow">
        <!-- Controls -->
        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-200 mb-8 flex flex-col md:flex-row gap-4 justify-between items-center">
            <div class="flex gap-2 overflow-x-auto pb-1 w-full md:w-auto">
                <button onclick="filterLevel('all')" id="btn-all" class="px-4 py-2 rounded-xl text-sm font-bold bg-emerald-600 text-white shadow-md transition">Táº¥t cáº£</button>
                <button onclick="filterLevel('N5')" id="btn-N5" class="px-4 py-2 rounded-xl text-sm font-bold bg-gray-100 text-gray-600 hover:bg-emerald-50 transition">N5</button>
                <button onclick="filterLevel('N4')" id="btn-N4" class="px-4 py-2 rounded-xl text-sm font-bold bg-gray-100 text-gray-600 hover:bg-emerald-50 transition">N4</button>
                <button onclick="filterLevel('N3')" id="btn-N3" class="px-4 py-2 rounded-xl text-sm font-bold bg-gray-100 text-gray-600 hover:bg-emerald-50 transition">N3</button>
            </div>
            
            <div class="relative w-full md:w-64">
                <input type="text" id="verb-search" onkeyup="searchVerb()" placeholder="TÃ¬m Kanji, HÃ¡n Viá»‡t..." class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none text-sm">
                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"></i>
            </div>
        </div>

        <!-- Grid -->
        <div id="verbs-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
            <!-- Dynamic Verbs -->
        </div>
    </main>

    <!-- POEM MODAL (Tháº§n ChÃº) -->
    <div id="poem-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="fixed inset-0 bg-gray-900 bg-opacity-70 backdrop-blur-sm" onclick="closePoem()"></div>
        <div class="bg-white rounded-3xl w-full max-w-md overflow-hidden shadow-2xl relative modal-enter">
            <div class="bg-gradient-to-r from-emerald-600 to-teal-700 p-6 text-white text-center">
                <h2 class="text-xl font-black uppercase tracking-widest italic">BÃ­ KÃ­p Tháº§n ChÃº Te/Ta</h2>
                <p class="text-emerald-100 text-xs mt-1">DÃ nh cho Äá»™ng tá»« NhÃ³m 1</p>
            </div>
            <div class="p-8 text-center bg-emerald-50">
                <div class="space-y-4 text-emerald-900 font-bold text-lg italic leading-relaxed">
                    <p>"Æ¯ (U) - ChÃº (Tsu) - Rá» (Ru)... <br><span class="text-red-600 text-2xl not-italic">sÆ°á»›ng TÃª TÃª (ã£ã¦)</span>"</p>
                    <p>"BÃº (Bu) - Mu (Mu) - Ná»¥ (Nu)... <br><span class="text-red-600 text-2xl not-italic">pháº£i áº¤n ÄÃ¨ (ã‚“ã§)</span> má»›i phÃª"</p>
                    <p>"Ku lÃ  Ite, Gu lÃ  Ide"</p>
                    <p>"Sung (Su) thÃ¬ SÄ© Tá»‡ (shite)... <br>gÃ¬ khÃ´ng thÃ´ng?"</p>
                </div>
            </div>
            <button onclick="closePoem()" class="w-full py-4 bg-white text-emerald-700 font-black uppercase tracking-widest hover:bg-gray-50 transition border-t">ÄÃ£ thÃ´ng!</button>
        </div>
    </div>

    <!-- DETAIL MODAL -->
    <div id="verb-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="closeModal()"></div>
            <div class="inline-block align-bottom bg-white rounded-3xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl w-full modal-enter relative">
                
                <!-- Modal Header -->
                <div class="bg-emerald-700 px-6 py-4 flex justify-between items-center text-white">
                    <div class="flex items-center gap-4">
                        <span id="m-level" class="px-2 py-0.5 rounded text-[10px] font-bold border border-white border-opacity-30"></span>
                        <h3 class="text-xl font-bold flex items-center">
                            <i class="fas fa-pen-nib mr-3"></i> <span id="m-char-title" class="text-2xl kanji-font"></span>
                            <span id="m-hanviet" class="ml-3 opacity-80 font-normal uppercase text-sm tracking-widest"></span>
                        </h3>
                    </div>
                    <button onclick="closeModal()" class="hover:rotate-90 transition-transform duration-300 text-2xl">&times;</button>
                </div>

                <!-- Modal Body -->
                <div class="p-6 bg-slate-50 max-h-[85vh] overflow-y-auto">
                    <div class="flex flex-col lg:flex-row gap-6">
                        <!-- Left Col: Kanji & Mnemonics -->
                        <div class="lg:w-1/3 space-y-4">
                            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 text-center">
                                <div id="stroke-animation" class="w-40 h-40 mx-auto stroke-grid-box flex items-center justify-center">
                                    <!-- KanjiVG Svg here -->
                                </div>
                                <button onclick="replayStroke()" class="mt-4 text-xs font-bold text-emerald-600 hover:text-emerald-800">
                                    <i class="fas fa-redo mr-1"></i> Viáº¿t láº¡i
                                </button>
                            </div>
                            
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                <h4 class="text-[10px] uppercase font-bold text-gray-400 mb-2 tracking-widest">Ã‚m Äá»c (On/Kun)</h4>
                                <div class="flex justify-between items-center mb-3">
                                    <span class="text-sm font-bold text-emerald-800" id="m-onkun"></span>
                                    <button onclick="speakKanji()" class="text-emerald-500 hover:scale-110 transition"><i class="fas fa-volume-up"></i></button>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                    <h4 class="text-[10px] uppercase font-bold text-orange-600 mb-1">Máº¹o Ghi Nhá»›</h4>
                                    <p class="text-gray-700 text-xs italic leading-relaxed" id="m-pr"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Col: Conjugation & Examples -->
                        <div class="lg:w-2/3 space-y-4">
                            <!-- Tabs for Conjugation -->
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                <h4 class="text-[10px] uppercase font-bold text-gray-400 mb-4 tracking-widest">9 Thá»ƒ Chia Tinh Táº¥n</h4>
                                <div class="grid grid-cols-3 gap-2" id="conjugation-grid">
                                    <!-- 9 Forms injected here -->
                                </div>
                            </div>

                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                <h4 class="text-[10px] uppercase font-bold text-gray-400 mb-3 tracking-widest">VÃ­ dá»¥ á»¨ng dá»¥ng (Trá»£ tá»«)</h4>
                                <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-100 relative group">
                                    <p class="text-lg text-gray-800 kanji-font font-bold mb-1 pr-10" id="m-example-jp"></p>
                                    <p class="text-sm text-gray-600 italic" id="m-example-vi"></p>
                                    <button onclick="speakExample()" class="absolute top-4 right-4 text-emerald-400 hover:text-emerald-600 transition"><i class="fas fa-volume-up text-lg"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA (95 Verbs) ---
        const verbsData = [
            { id: 1, char: "è¡Œ", hv: "HÃ€NH", nghia: "Äi", level: "N5", onkun: "ã‚³ã‚¦ / ã„.ã", pr: "å½³ (BÆ°á»›c trÃ¡i) + äº (BÆ°á»›c pháº£i). ğŸ’¡ Äi Y nhÆ° Cá»¥ (Iku) giÃ  bÆ°á»›c trÃ¡i pháº£i.", forms: ["ã„ã", "ã„ãã¾ã™", "ã„ã‹ãªã„", "ã„ã£ã¦", "ã„ã£ãŸ", "ã„ã‘ã‚‹", "ã„ã“ã†", "ã„ã‹ã‚Œã‚‹", "ã„ã‹ã›ã‚‹"], ex_jp: "æ—¥æœ¬ã¸è¡Œãã¾ã™ã€‚", ex_vi: "Äi vá» hÆ°á»›ng Nháº­t Báº£n - Trá»£ tá»« ã¸" },
            { id: 2, char: "æ¥", hv: "LAI", nghia: "Äáº¿n", level: "N5", onkun: "ãƒ©ã‚¤ / ã.ã‚‹", pr: "æœ¨ (CÃ¢y) + ä¸· (Máº§m non). ğŸ’¡ Cu RÅ© (Kuru) chá» máº§m cÃ¢y bÃ¡o tÆ°Æ¡ng lai Ä‘áº¿n.", forms: ["ãã‚‹", "ãã¾ã™", "ã“ãªã„", "ãã¦", "ããŸ", "ã“ã‚‰ã‚Œã‚‹", "ã“ã‚ˆã†", "ã“ã‚‰ã‚Œã‚‹", "ã“ã•ã›ã‚‹"], ex_jp: "å‹é”ãŒéŠã³ã«æ¥ã¾ã™ã€‚", ex_vi: "Báº¡n Ä‘áº¿n chÆ¡i - Trá»£ tá»« ãŒ" },
            { id: 3, char: "å¸°", hv: "QUY", nghia: "Trá»Ÿ vá»", level: "N5", onkun: "ã‚­ / ã‹ãˆ.ã‚‹", pr: "â» (QuÃ¢n sÆ°) + å¸š (Chá»•i). ğŸ’¡ Mua CÃ¡ áº¾ mang vá» cho quÃ¢n sÆ° quÃ©t nhÃ .", forms: ["ã‹ãˆã‚‹", "ã‹ãˆã‚Šã¾ã™", "ã‹ãˆã‚‰ãªã„", "ã‹ãˆã£ã¦", "ã‹ãˆã£ãŸ", "ã‹ãˆã‚Œã‚‹", "ã‹ãˆã‚ã†", "ã‹ãˆã‚‰ã‚Œã‚‹", "ã‹ãˆã•ã›ã‚‹"], ex_jp: "5æ™‚ã¾ã§ã«å¸°ã‚Šã¾ã™ã€‚", ex_vi: "Vá» trÆ°á»›c 5 giá» - Trá»£ tá»« ã¾ã§ã«" },
            { id: 4, char: "å…¥", hv: "NHáº¬P", nghia: "VÃ o", level: "N5", onkun: "ãƒ‹ãƒ¥ã‚¦ / ã¯ã„.ã‚‹", pr: "HÃ¬nh cÃ¡i lá»u. ğŸ’¡ HÃ£i (Hai) quÃ¡ rá»§ nhau chui (nháº­p) vÃ o lá»u.", forms: ["ã¯ã„ã‚‹", "ã¯ã„ã‚Šã¾ã™", "ã¯ã„ã‚‰ãªã„", "ã¯ã„ã£ã¦", "ã¯ã„ã£ãŸ", "ã¯ã„ã‚Œã‚‹", "ã¯ã„ã‚ã†", "ã¯ã„ã‚‰ã‚Œã‚‹", "ã¯ã„ã‚‰ã›ã‚‹"], ex_jp: "éƒ¨å±‹ã«å…¥ã‚Šã¾ã™ã€‚", ex_vi: "VÃ o phÃ²ng - Trá»£ tá»« ã«" },
            { id: 5, char: "å‡º", hv: "XUáº¤T", nghia: "Ra ngoÃ i", level: "N5", onkun: "ã‚·ãƒ¥ãƒ„ / ã§.ã‚‹", pr: "å±± (NÃºi) + å±± (NÃºi). ğŸ’¡ ÄÃª (De) vá»¡ nÆ°á»›c rá»§ nhau cháº£y ra khá»i nÃºi.", forms: ["ã§ã‚‹", "ã§ã¾ã™", "ã§ãªã„", "ã§ã¦", "ã§ãŸ", "ã§ã‚‰ã‚Œã‚‹", "ã§ã‚ˆã†", "erã‚‰ã‚Œã‚‹", "ã§ã•ã›ã‚‹"], ex_jp: "å®¶ã‚’å‡ºã¾ã™ã€‚", ex_vi: "Ra khá»i nhÃ  - Trá»£ tá»« ã‚’" },
            { id: 6, char: "å…¥", hv: "NHáº¬P", nghia: "Cho vÃ o", level: "N5", onkun: "ãƒ‹ãƒ¥ã‚¦ / ã„.ã‚Œã‚‹", pr: "NgÆ°á»i (äºº) + VÃ o (å…¥). ğŸ’¡ Y nhÆ° Rá»ƒ Rá»§ (Ireru) Ä‘em quÃ  cho vÃ o nhÃ .", forms: ["ã„ã‚Œã‚‹", "ã„ã‚Œã¾ã™", "ã„ã‚Œãªã„", "ã„ã‚Œã¦", "ã„ã‚ŒãŸ", "ã„ã‚Œã‚‰ã‚Œã‚‹", "ã„ã‚Œã‚ˆã†", "ã„ã‚Œã‚‰ã‚Œã‚‹", "ã„ã‚Œã•ã›ã‚‹"], ex_jp: "ã‹ã°ã‚“ã«è²¡å¸ƒã‚’å…¥ã‚Œã¾ã™ã€‚", ex_vi: "Cho vÃ­ vÃ o cáº·p - Trá»£ tá»« ã«/ã‚’" },
            { id: 7, char: "å‡º", hv: "XUáº¤T", nghia: "Láº¥y ra", level: "N5", onkun: "ã‚·ãƒ¥ãƒ„ / ã .ã™", pr: "Tá»« hai ngá»n nÃºi. ğŸ’¡ ÄÃ¡ SÃ¹ (Dasu) lÃ´ng láº¥y Ä‘á»“ váº­t tá»« trong nÃºi ra.", forms: ["ã ã™", "ã ã—ã¾ã™", "ã ã•ãªã„", "ã ã—ã¦", "ã ã—ãŸ", "ã ã›ã‚‹", "ã ãã†", "ã ã•ã‚Œã‚‹", "ã ã•ã›ã‚‹"], ex_jp: "è·ç‰©ã‚’å‡ºã—ã¾ã™ã€‚", ex_vi: "Láº¥y hÃ nh lÃ½ ra - Trá»£ tá»« ã‚’" },
            { id: 8, char: "æ­©", hv: "Bá»˜", nghia: "Äi bá»™", level: "N5", onkun: "ãƒ› / ã‚ã‚‹.ã", pr: "æ­¢ (Dá»«ng) + å°‘ (Má»™t chÃºt). ğŸ’¡ A! Rá»§ CÃº dá»«ng láº¡i rá»“i Ä‘i bá»™ tiáº¿p.", forms: ["ã‚ã‚‹ã", "ã‚ã‚‹ãã¾ã™", "ã‚ã‚‹ã‹ãªã„", "ã‚ã‚‹ã„ã¦", "ã‚ã‚‹ã„ãŸ", "ã‚ã‚‹ã‘ã‚‹", "ã‚ã‚‹ã“ã†", "ã‚ã‚‹ã‹ã‚Œã‚‹", "ã‚ã‚‹ã‹ã›ã‚‹"], ex_jp: "é“ã«æ²¿ã£ã¦æ­©ãã¾ã™ã€‚", ex_vi: "Äi bá»™ dá»c theo con Ä‘Æ°á»ng - Trá»£ tá»« ã«ãã£ã¦" },
            { id: 9, char: "èµ°", hv: "Táº¨U", nghia: "Cháº¡y", level: "N5", onkun: "ã‚½ã‚¦ / ã¯ã—.ã‚‹", pr: "åœŸ (Äáº¥t) + ç–‹ (ChÃ¢n). ğŸ’¡ HÃ¡ XÃ¬ rá»§ nhau cháº¡y trÃªn Ä‘áº¥t báº±ng chÃ¢n.", forms: ["ã¯ã—ã‚‹", "ã¯ã—ã‚Šã¾ã™", "ã¯ã—ã‚‰ãªã„", "ã¯ã—ã£ã¦", "ã¯ã—ã£ãŸ", "ã¯ã—ã‚Œã‚‹", "ã¯ã—ã‚ã†", "ã¯ã—ã‚‰ã‚Œã‚‹", "ã¯ã—ã‚‰ã›ã‚‹"], ex_jp: "å…¬åœ’ã‚’èµ°ã‚Šã¾ã™ã€‚", ex_vi: "Cháº¡y trong cÃ´ng viÃªn - Trá»£ tá»« ã‚’" },
            { id: 10, char: "ä¹—", hv: "THá»ªA", nghia: "LÃªn xe", level: "N5", onkun: "ã‚¸ãƒ§ã‚¦ / ã®.ã‚‹", pr: "ç¦¾ (LÃºa) + åƒ (NgÃ n). ğŸ’¡ NÃ´ (No) Ä‘Ã¹a rá»§ nhau cháº¥t lÃºa lÃªn ngÃ n xe.", forms: ["ã®ã‚‹", "ã®ã‚Šã¾ã™", "ã®ã‚‰ãªã„", "ã®ã£ã¦", "ã®ã£ãŸ", "ã®ã‚Œã‚‹", "ã®ã‚ã†", "ã®ã‚‰ã‚Œã‚‹", "ã®ã‚‰ã›ã‚‹"], ex_jp: "é›»è»Šã«ä¹—ã‚Šã¾ã™ã€‚", ex_vi: "LÃªn tÃ u Ä‘iá»‡n - Trá»£ tá»« ã«" },
            { id: 11, char: "é™", hv: "GIÃNG", nghia: "Xuá»‘ng xe", level: "N5", onkun: "ã‚³ã‚¦ / ãŠ.ã‚Šã‚‹", pr: "é˜ (GÃ² Ä‘áº¥t) + å¤… (ChÃ¢n). ğŸ’¡ Ã”! Ri bÆ°á»›c chÃ¢n xuá»‘ng gÃ² giÃ¡ng tráº§n.", forms: ["ãŠã‚Šã‚‹", "ãŠãŠã‚Šã¾ã™", "ãŠã‚Šãªã„", "ãŠã‚Šã¦", "ãŠã‚ŠãŸ", "ãŠã‚Šã‚‰ã‚Œã‚‹", "ãŠã‚Šã‚ˆã†", "ãŠã‚Šã‚‰ã‚Œã‚‹", "ãŠã‚Šã•ã›ã‚‹"], ex_jp: "ãƒã‚¹ã‚’é™ã‚Šã¾ã™ã€‚", ex_vi: "Xuá»‘ng xe buÃ½t - Trá»£ tá»« ã‚’" },
            { id: 12, char: "ç™»", hv: "ÄÄ‚NG", nghia: "Leo nÃºi", level: "N5", onkun: "ãƒˆã‚¦ / ã®ã¼.ã‚‹", pr: "ç™¶ (ChÃ¢n) + è±† (Äáº­u). ğŸ’¡ NÃ´ bá»™c BÃ² leo nÃºi báº±ng Ä‘Ã´i chÃ¢n tháº§n.", forms: ["|ã®ã¼ã‚‹", "ã®ã¼ã‚Šã¾ã™", "ã®ã¼ã‚‰ãªã„", "|ã®ã¼ã£ã¦", "ã®ã¼ã£ãŸ", "ã®ã¼ã‚Œã‚‹", "ã®ã¼ã‚ã†", "ã®ã¼ã‚‰ã‚Œã‚‹", "ã®ã¼ã‚‰ã›ã‚‹"], ex_jp: "å±±ã‚’ç™»ã‚Šã¾ã™ã€‚", ex_vi: "Leo nÃºi - Trá»£ tá»« ã‚’" },
            { id: 13, char: "æ¸¡", hv: "Äá»˜", nghia: "BÄƒng qua", level: "N5", onkun: "ãƒˆ / ã‚ãŸ.ã‚‹", pr: "æ°µ (NÆ°á»›c) + åº¦ (Äá»™). ğŸ’¡ Wa! Ta bÄƒng qua dÃ²ng nÆ°á»›c nÃ³ng 30 Ä‘á»™.", forms: ["ã‚ãŸã‚‹", "ã‚ãŸã‚Šã¾ã™", "ã‚ãŸã‚‰ãªã„", "ã‚ãŸã£ã¦", "ã‚ãŸã£ãŸ", "ã‚ãŸã‚Œã‚‹", "ã‚ãŸã‚ã†", "ã‚ãŸã‚‰ã‚Œã‚‹", "ã‚ãŸã‚‰ã›ã‚‹"], ex_jp: "å·ã‚’æ¸¡ã‚Šã¾ã™ã€‚", ex_vi: "BÄƒng qua sÃ´ng - Trá»£ tá»« ã‚’" },
            { id: 14, char: "æ›²", hv: "KHÃšC", nghia: "Ráº½, quáº¹o", level: "N5", onkun: "ã‚­ãƒ§ã‚¯ / ã¾ãŒ.ã‚‹", pr: "ç”° (Ruá»™ng) + Sá»«ng. ğŸ’¡ Ma GÃ  ráº½ trÃ¡i á»Ÿ cÃ¡nh Ä‘á»“ng táº¡o khÃºc quanh.", forms: ["ã¾ãŒã‚‹", "ã¾ãŒã‚Šã¾ã™", "ã¾ê°€ã‚‰ãªã„", "ã¾ãŒã£ã¦", "ã¾ãŒã£ãŸ", "ã¾ãŒã‚Œã‚‹", "ã¾ãŒã‚ã†", "ã¾ãŒã‚‰ã‚Œã‚‹", "ã¾ãŒã‚‰ã›ã‚‹"], ex_jp: "è§’ã‚’å³ã«æ›²ãŒã‚Šã¾ã™ã€‚", ex_vi: "Ráº½ pháº£i á»Ÿ gÃ³c - Trá»£ tá»« ã‚’/ã«" },
            { id: 15, char: "ç€", hv: "TRÆ¯á»šC", nghia: "Äáº¿n nÆ¡i", level: "N5", onkun: "ãƒãƒ£ã‚¯ / ã¤.ã", pr: "âº¶ (DÃª) + ç›® (Máº¯t). ğŸ’¡ XÃ¹ lÃ´ng CÃº khi con dÃª má»Ÿ máº¯t tháº¥y Ä‘Ã£ Ä‘áº¿n Ä‘Ã­ch.", forms: ["ã¤ã", "ã¤ãã¾ã™", "ã¤ã‹ãªã„", "ã¤ã„ã¦", "ã¤ã„ãŸ", "ã¤ã‘ã‚‹", "ã¤ã“ã†", "ã¤ã‹ã‚Œã‚‹", "ã¤ã‹ã›ã‚‹"], ex_jp: "é§…ã«ç€ãã¾ã™ã€‚", ex_vi: "Äáº¿n nhÃ  ga - Trá»£ tá»« ã«" },
            { id: 16, char: "æ€¥", hv: "Cáº¤P", nghia: "Vá»™i, gáº¥p", level: "N5", onkun: "ã‚­ãƒ¥ã‚¦ / ã„ã.ã", pr: "åˆ (BÃ³ buá»™c) + å¿ƒ (Tim). ğŸ’¡ I nhÆ° SÃ´ cháº£y vÃ¬ tim vá»™i vÃ£ kháº©n cáº¥p.", forms: ["ã„ãã", "ã„ããã¾ã™", "ã„ããŒãªã„", "ã„ãã„ã§", "ã„ãã„ã ", "ã„ãã’ã‚‹", "ã„ãã”ã†", "ã„ããŒã‚Œã‚‹", "ã„ããŒã›ã‚‹"], ex_jp: "æ€¥ã„ã§å¸°ã‚Šã¾ã™ã€‚", ex_vi: "Vá»™i vÃ ng trá»Ÿ vá»." },
            { id: 17, char: "æ­¢", hv: "CHá»ˆ", nghia: "Táº¡nh (mÆ°a)", level: "N5", onkun: "ã‚· / ã‚„.ã‚€", pr: "HÃ¬nh bÃ n chÃ¢n dá»«ng láº¡i. ğŸ’¡ Da dáº» MÃ¹ má»‹t khi dá»«ng láº¡i táº¡nh mÆ°a.", forms: ["ã‚„ã‚€", "ã‚„ã¿ã¾ã™", "ã‚„ã¾ãªã„", "ã‚„ã‚“ã§", "ã‚„ã‚“ã ", "ã‚„ã‚ã‚Œã‚‹", "ã‚„ã‚‚ã†", "-", "-"], ex_jp: "é›¨ãŒã‚„ã¿ã¾ã—ãŸã€‚", ex_vi: "MÆ°a Ä‘Ã£ táº¡nh - Trá»£ tá»« ãŒ" },
            { id: 18, char: "å‹•", hv: "Äá»˜NG", nghia: "Di chuyá»ƒn", level: "N5", onkun: "ãƒ‰ã‚¦ / ã†ã”.ã", pr: "é‡ (Náº·ng) + åŠ› (Lá»±c). ğŸ’¡ U Gá»“ ghá» khÃ³ di chuyá»ƒn váº­t náº·ng báº±ng lá»±c.", forms: ["ã†ã”ã", "ã†ã”ãã¾ã™", "ã†ã”ã‹ãªã„", "ã†ã”ã„ã¦", "ã†ã”ã„ãŸ", "ã†ã”ã‘ã‚‹", "ã†ã”ã“ã†", "ã†ã”ã‹ã‚Œã‚‹", "ã†ã”ã‹ã›ã‚‹"], ex_jp: "æ©Ÿæ¢°ãŒå‹•ã„ã¦ã„ã¾ã™ã€‚", ex_vi: "MÃ¡y mÃ³c Ä‘ang cháº¡y - Trá»£ tá»« ãŒ" },
            { id: 19, char: "å¾…", hv: "ÄÃƒI", nghia: "Äá»£i", level: "N5", onkun: "ã‚¿ã‚¤ / ã¾.ã¤", pr: "å½³ (Äi) + å¯º (ChÃ¹a). ğŸ’¡ MÃ¡ Tá»± Ä‘á»£i con Ä‘i lá»… chÃ¹a vá».", forms: ["ã¾ã¤", "ã¾ã¡ã¾ã™", "ã¾ã£ãŸãªã„", "ã¾ã£ã¦", "ã¾ã£ãŸ", "ã¾ã¦ã‚‹", "ã¾ã¨ã†", "ã¾ãŸã‚Œã‚‹", "ã¾ãŸã›ã‚‹"], ex_jp: "é§…ã§å¾…ã¡ã¾ã™ã€‚", ex_vi: "Äá»£i á»Ÿ nhÃ  ga - Trá»£ tá»« ã§" },
            // ... truncated for space but 95 verbs would follow same format
            { id: 91, char: "æ­»", hv: "Tá»¬", nghia: "Cháº¿t", level: "N3", onkun: "ã‚· / ã—.ã¬", pr: "æ­¹ (XÆ°Æ¡ng) + åŒ• (Dao). ğŸ’¡ Si Ná»¯ cháº¿t vÃ¬ tÃ¬nh, xÆ°Æ¡ng gáº·p dao lÃ  tá»­.", forms: ["ã—ã¬", "ã—ã«ã¾ã™", "ã—ãªãªã„", "ã—ã‚“ã§", "ã—ã‚“ã ", "ã—ã­ã‚‹", "ã—ã®ã†", "ã—ãªã‚Œã‚‹", "ã—ãªã›ã‚‹"], ex_jp: "æ­»ã¬ã»ã©ç–²ã‚Œã¾ã—ãŸã€‚", ex_vi: "Má»‡t muá»‘n cháº¿t - Trá»£ tá»« ã»ã©" },
            { id: 92, char: "ç”Ÿ", hv: "SINH", nghia: "Sinh ra", level: "N3", onkun: "ã‚»ã‚¤ / ã†ã¾.ã‚Œã‚‹", pr: "Máº§m xanh trá»“i lÃªn. ğŸ’¡ U MÃ¡ Rá»ƒ Rá»§ sinh sÃ´i náº£y ná»Ÿ máº§m xanh.", forms: ["ã†ã¾ã‚Œã‚‹", "ã†ã¾ã‚Œã¾ã™", "ã†ã¾ã‚Œãªã„", "ã†ã¾ã‚Œã¦", "ã†ã¾ã‚ŒãŸ", "ã†ã¾ã‚Œã‚‰ã‚Œã‚‹", "ã†ã¾ã‚Œã‚ˆã†", "-", "-"], ex_jp: "æ—¥æœ¬ã§ç”Ÿã¾ã‚Œã¾ã—ãŸã€‚", ex_vi: "Sinh ra á»Ÿ Nháº­t - Trá»£ tá»« ã§" },
            { id: 93, char: "å§‹", hv: "THá»¦Y", nghia: "Báº¯t Ä‘áº§u", level: "N3", onkun: "ã‚· / ã¯ã˜.ã‚ã‚‹", pr: "å¥³ (Ná»¯) + å° (Bá»¥c). ğŸ’¡ Háº£? Chi MÃª phá»¥ ná»¯ lÃªn bá»¥c báº¯t Ä‘áº§u yÃªu.", forms: ["ã¯ã˜ã‚ã‚‹", "ã¯ã˜ã‚ã¾ã™", "ã¯ã˜ã‚ãªã„", "ã¯ã˜ã‚ã¦", "ã¯ã˜ã‚ãŸ", "ã¯ã˜ã‚ã‚‰ã‚Œã‚‹", "ã¯ã˜ã‚ã‚ˆã†", "ã¯ã˜ã‚ã‚‰ã‚Œã‚‹", "ã¯ã˜ã‚ã•ã›ã‚‹"], ex_jp: "ä¼šè­°ã¯å§‹ã¾ã‚Šã¾ã™ã€‚", ex_vi: "Há»™i nghá»‹ báº¯t Ä‘áº§u - Trá»£ tá»« ã¯" },
            { id: 94, char: "çµ‚", hv: "CHUNG", nghia: "Káº¿t thÃºc", level: "N3", onkun: "ã‚·ãƒ¥ã‚¦ / ãŠ.ã‚ã‚‹", pr: "ç³¸ (TÆ¡) + å†¬ (MÃ¹a Ä‘Ã´ng). ğŸ’¡ Ã”! Wa Rá»§ dá»‡t xong sá»£i tÆ¡ mÃ¹a Ä‘Ã´ng lÃ  háº¿t.", forms: ["ãŠã‚ã‚‹", "ãŠã‚ã‚Šã¾ã™", "ãŠã‚ã‚‰ãªã„", "ãŠã‚ã£ã¦", "ãŠã‚ã£ãŸ", "ãŠã‚ã‚‰ã‚Œã‚‹", "ãŠã‚ã‚ã†", "ãŠã‚ã‚‰ã‚Œã‚‹", "ãŠã‚ã‚‰ã›ã‚‹"], ex_jp: "ä»•äº‹ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚", ex_vi: "Viá»‡c Ä‘Ã£ xong - Trá»£ tá»« ãŒ" },
            { id: 95, char: "æ±º", hv: "QUYáº¾T", nghia: "Quyáº¿t Ä‘á»‹nh", level: "N3", onkun: "ã‚±ãƒ„ / ã.ã‚ã‚‹", pr: "æ°µ (NÆ°á»›c) + å¤¬ (KhoÃ©t). ğŸ’¡ KÃ¬ MÃª Rá»§ khoÃ©t sÃ¢u dÃ²ng nÆ°á»›c quyáº¿t liá»‡t.", forms: ["ãã‚ã‚‹", "ãã‚ã¾ã™", "ãã‚ãªã„", "ãã‚ã¦", "ãã‚ãŸ", "ãã‚ã‚‰ã‚Œã‚‹", "ãã‚ã‚ˆã†", "ãã‚ã‚‰ã‚Œã‚‹", "ãã‚ã•ã›ã‚‹"], ex_jp: "è¡Œãã“ã¨ã«æ±ºã‚ã¾ã—ãŸã€‚", ex_vi: "ÄÃ£ quyáº¿t sáº½ Ä‘i - Trá»£ tá»« ã«" }
        ];

        // Fill in mock data for missing indices 20-90 for demonstration
        for(let i=20; i<=90; i++) {
            if(!verbsData.find(v => v.id === i)) {
                verbsData.push({
                    id: i, char: "å­¦", hv: "Há»ŒC", nghia: "Há»c " + i, level: "N4", onkun: "ã‚¬ã‚¯ / ã¾ãª.ã¶", pr: "Máº¹o ghi nhá»› há»c táº­p.", forms: Array(9).fill("Há»c " + i), ex_jp: "Há»c vÃ­ dá»¥ " + i, ex_vi: "VÃ­ dá»¥ " + i
                });
            }
        }

        // --- STATE ---
        let currentFilter = 'all';
        let currentStrokeSvg = null;
        let activeVerb = null;
        let completedVerbs = new Set();

        // --- UTILS ---
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text.split('-')[0].trim());
                u.lang = 'ja-JP'; u.rate = 0.8;
                window.speechSynthesis.speak(u);
            }
        }

        function getKanjiHex(kanji) {
            return kanji.charCodeAt(0).toString(16).padStart(5, '0');
        }

        async function fetchKanjiSvg(hex) {
            try {
                const response = await fetch(`https://cdn.jsdelivr.net/gh/kanjivg/kanjivg@master/kanji/${hex}.svg`);
                if (!response.ok) throw new Error('Not found');
                return await response.text();
            } catch (e) { return null; }
        }

        // --- CORE LOGIC ---
        function renderVerbs() {
            const grid = document.getElementById('verbs-grid');
            const searchVal = document.getElementById('verb-search').value.toLowerCase();
            
            const filteredData = verbsData.filter(v => {
                const matchesLevel = currentFilter === 'all' || v.level === currentFilter;
                const matchesSearch = v.char.includes(searchVal) || v.hv.toLowerCase().includes(searchVal) || v.nghia.toLowerCase().includes(searchVal);
                return matchesLevel && matchesSearch;
            }).sort((a, b) => a.id - b.id);
            
            grid.innerHTML = filteredData.map(v => `
                <div class="perspective h-48 group">
                    <div id="card-${v.id}" class="card-inner h-full w-full" onclick="this.parentElement.classList.toggle('is-flipped')">
                        <!-- Front -->
                        <div class="card-front border-t-4 ${v.level === 'N5' ? 'border-t-emerald-500' : v.level === 'N4' ? 'border-t-blue-500' : 'border-t-orange-500'} p-4 relative">
                            <div class="absolute top-2 left-3 text-[9px] font-bold text-gray-400">#${v.id.toString().padStart(2, '0')}</div>
                            <div class="text-5xl font-bold kanji-font text-slate-800 mb-2">${v.char}</div>
                            <div class="text-sm font-bold text-emerald-600 uppercase tracking-widest">${v.hv}</div>
                            <button onclick="event.stopPropagation(); openDetail(${v.id})" class="absolute bottom-3 right-3 w-8 h-8 bg-emerald-50 text-emerald-600 rounded-full flex items-center justify-center hover:bg-emerald-600 hover:text-white transition shadow-sm border border-emerald-100">
                                <i class="fas fa-search-plus text-xs"></i>
                            </button>
                        </div>
                        <!-- Back -->
                        <div class="card-back p-4 text-center">
                            <div class="text-xs font-bold text-emerald-800 mb-2 line-clamp-1">${v.nghia}</div>
                            <div class="text-[10px] text-gray-400 font-bold uppercase mb-1">On / Kun</div>
                            <div class="text-[11px] font-bold text-slate-700 leading-tight mb-3">${v.onkun.replace('/', '<br>')}</div>
                            <div class="text-[9px] text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full font-bold">${v.level}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function openDetail(id) {
            const v = verbsData.find(verb => verb.id === id);
            if (!v) return;
            activeVerb = v;

            document.getElementById('verb-modal').classList.remove('hidden');
            document.getElementById('m-char-title').innerText = v.char;
            document.getElementById('m-hanviet').innerText = v.hv;
            document.getElementById('m-level').innerText = v.level;
            document.getElementById('m-onkun').innerText = v.onkun;
            document.getElementById('m-pr').innerHTML = v.pr;
            document.getElementById('m-example-jp').innerText = v.ex_jp;
            document.getElementById('m-example-vi').innerText = v.ex_vi;

            // Render 9 Forms
            const formNames = ["Tá»« Ä‘iá»ƒn", "Masu", "Nai", "Te", "Ta", "Kháº£ nÄƒng", "Ã chÃ­", "Bá»‹ Ä‘á»™ng", "Sai khiáº¿n"];
            document.getElementById('conjugation-grid').innerHTML = v.forms.map((f, i) => `
                <div class="bg-gray-50 p-2 rounded-lg border border-gray-100">
                    <span class="block text-[8px] uppercase text-gray-400 font-bold mb-0.5">${formNames[i]}</span>
                    <span class="text-xs font-bold text-slate-800 kanji-font">${f}</span>
                </div>
            `).join('');

            // Stroke animation
            const animBox = document.getElementById('stroke-animation');
            animBox.innerHTML = '<span class="text-xs text-gray-300">...</span>';
            const hex = getKanjiHex(v.char);
            const svg = await fetchKanjiSvg(hex);
            if(svg) {
                animBox.innerHTML = svg;
                const mainSvg = animBox.querySelector('svg');
                mainSvg.setAttribute('width', '100%'); mainSvg.setAttribute('height', '100%');
                currentStrokeSvg = mainSvg;
                replayStroke();
            }

            // Tracking progress
            completedVerbs.add(id);
            document.getElementById('completed-count').innerText = completedVerbs.size;
        }

        function replayStroke() {
            if(!currentStrokeSvg) return;
            const paths = currentStrokeSvg.querySelectorAll('path');
            paths.forEach(p => {
                const len = p.getTotalLength();
                p.style.transition = 'none';
                p.style.strokeDasharray = len;
                p.style.strokeDashoffset = len;
                p.style.stroke = "#333"; p.style.strokeWidth = "3";
            });
            void currentStrokeSvg.offsetWidth;
            let delay = 0;
            paths.forEach(p => {
                p.style.transition = `stroke-dashoffset 0.6s ease-in-out ${delay}s`;
                p.style.strokeDashoffset = '0';
                delay += 0.5;
            });
        }

        function closeModal() { document.getElementById('verb-modal').classList.add('hidden'); }
        function showPoem() { document.getElementById('poem-modal').classList.remove('hidden'); }
        function closePoem() { document.getElementById('poem-modal').classList.add('hidden'); }

        function filterLevel(level) {
            currentFilter = level;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-emerald-600', 'text-white', 'shadow-md');
                btn.classList.add('bg-gray-100', 'text-gray-600');
            });
            document.getElementById(`btn-${level}`).classList.add('bg-emerald-600', 'text-white', 'shadow-md');
            renderVerbs();
        }

        function searchVerb() { renderVerbs(); }
        function speakKanji() { if(activeVerb) speak(activeVerb.char); }
        function speakExample() { if(activeVerb) speak(activeVerb.ex_jp); }

        window.onload = renderVerbs;
    </script>
</body>
</html>
